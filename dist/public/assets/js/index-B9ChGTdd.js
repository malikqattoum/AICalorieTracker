import{r as x,j as e,C as va,P as Ir,h as as,V as ba,i as wa,k as ka,l as Sa,X as Qt,T as Ca,D as Ea,m as Fr,n as Ss,o as W,p as J,S as Ta,q as Vs,B as tt,U as Ns,t as It,v as Dr,L as ns,w as Aa,I as Mr,x as $s,y as be,H as Ft,z as Lr,E as Ct,F as Ra,G as pt,W as Or,J as Ue,K as lt,M as Os,N as Pa,O as Ur,Q as ct,Y as $r,Z as Ps,_ as Dt,$ as zr,a0 as Ht,a1 as rs,a2 as De,a3 as Ia,a4 as Fa,a5 as _r,a6 as qr,a7 as Br,a8 as Da,a9 as Hs,aa as vs,ab as Xt,ac as Zt,ad as at,ae as ea,af as ze,ag as js,ah as zs,ai as Ze,aj as Ks,ak as fe,al as Ee,am as Vr,an as Hr,ao as Kr,ap as Wr,aq as Ma,ar as La,as as Oa,at as Gr,au as sa,av as ta,aw as Yr,ax as ye,ay as Jr,az as Kt,aA as Et,aB as Qr,aC as Xr,aD as Zr,aE as ei,aF as si,aG as ti,aH as ai,aI as ri,aJ as ii,aK as ni,aL as li,aM as ci,aN as oi,aO as di,aP as mi,aQ as xi,aR as hi,aS as ui,aT as ji,aU as Ua,aV as Ws,aW as pi,aX as fi,aY as Me,aZ as gi,a_ as yi,a$ as Mt,b0 as Tt,b1 as Ni,b2 as ot,b3 as vi,b4 as $a,b5 as es,b6 as bi,b7 as wi,b8 as ki,b9 as bs,ba as Ve,bb as za,bc as Si,bd as _a,be as Ci,bf as qa,bg as Ba,bh as Ei,bi as ls,bj as Va,bk as Ye,bl as Ha,bm as Ti,bn as Ai,bo as Ka,bp as Ri,bq as Pi,br as Ii,bs as vt,bt as _e,bu as ms,bv as dt,bw as Fi,bx as qs,by as mt,bz as ws,bA as xt,bB as Di,bC as Mi,bD as ht,bE as Ut,bF as Li,bG as Wa,bH as Oi,bI as la,bJ as ca,bK as Zs,bL as Ui,bM as Is,bN as Wt,bO as oa,bP as $i,bQ as da,bR as zi,bS as Ga,bT as Ya,bU as Ja,bV as ma,bW as _i,bX as qi,bY as Bi}from"./chunk-BQg0Mp-t.js";import{aQ as ft,aR as Cs,aS as ae,aT as gt,aU as V,aV as aa,aW as Gs,aX as bt,aY as We,aZ as Vi,a_ as Hi}from"./chunk-glju_jBW.js";import{G as Ki,H as Wi,I as Gi,p as rt}from"./chunk-bA9yirCo.js";import{b as Yi}from"./chunk-DXC63HgE.js";import{R as Ce,L as is,X as Pe,Y as Ie,T as Re,a as Fs,b as je,B as wt,A as xa,C as os,c as $t,d as Es,P as Ji,e as Qi,f as Xi,g as Zi,h as en,i as sn,j as tn,k as an}from"./chunk-DxpfKjBe.js";import{A as rn,m as nn}from"./chunk-BLw9EYhw.js";import{i as ln,B as cn}from"./chunk-Bfk0gVnT.js";import"./chunk-Bq1tP_D2.js";import"./chunk-BQCqNqg0.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const n of l.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function a(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(i){if(i.ep)return;i.ep=!0;const l=a(i);fetch(i.href,l)}})();function L(...s){return Ki(Wi(s))}const on=Ir,dn=x.forwardRef(({className:s,sideOffset:t=4,...a},r)=>e.jsx(va,{ref:r,sideOffset:t,className:L("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",s),...a}));dn.displayName=va.displayName;const g=x.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:L("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t}));g.displayName="Card";const b=x.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:L("flex flex-col space-y-1.5 p-6",s),...t}));b.displayName="CardHeader";const w=x.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:L("text-2xl font-semibold leading-none tracking-tight",s),...t}));w.displayName="CardTitle";const ds=x.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:L("text-sm text-muted-foreground",s),...t}));ds.displayName="CardDescription";const y=x.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:L("p-6 pt-0",s),...t}));y.displayName="CardContent";const Ts=x.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:L("flex items-center p-6 pt-0",s),...t}));Ts.displayName="CardFooter";function mn(){return e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:e.jsx(g,{className:"w-full max-w-md mx-4",children:e.jsxs(y,{className:"pt-6",children:[e.jsxs("div",{className:"flex mb-4 gap-2",children:[e.jsx(as,{className:"h-8 w-8 text-red-500"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),e.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}const xn={development:"http://localhost:3000",production:"https://aical.scanitix.com",staging:"https://staging-api.aicalorietracker.com"},hn=()=>typeof window<"u"&&window.location.hostname==="localhost"?"development":typeof window<"u"&&window.location.hostname.includes("staging")?"staging":"production",et=hn(),_s=xn[et],un={enhancedFoodRecognition:!0,multiItemRecognition:!0,portionSizeEstimation:!0,restaurantMenuRecognition:!0,nutritionalDatabase:!0,healthScoring:!0,confidenceThreshold:.7,maxImageSize:10*1024*1024,supportedImageFormats:["image/jpeg","image/png","image/webp"],referenceObjects:["hand","credit_card","smartphone","coin"],enable3DEstimation:!1,enableOfflineMode:!1,enableBarcodeScanning:!0,enableNutritionAnalysis:!0,enableHealthScoring:!0,enablePortionEstimation:!0,enableConfidenceDisplay:!0,enableProcessingTimeDisplay:!0,enableModelVersionDisplay:!0,enableErrorHandling:!0,enableFallbackMode:!0,enableRetryMechanism:!0,maxRetryAttempts:3,retryDelay:1e3,timeout:3e4,cacheResults:!0,cacheExpiration:300*1e3,enableAnalytics:!0,enableLogging:!0,enableDebugMode:!1},jn={videoConstraints:{width:{ideal:1280},height:{ideal:720},facingMode:"environment",frameRate:{ideal:30}},imageConstraints:{width:1280,height:720,quality:.8,format:"image/jpeg"},maxImageSize:10*1024*1024,supportedFormats:["image/jpeg","image/png","image/webp"],maxFileSize:10*1024*1024,maxFileSizeDisplay:"10MB"},pn={endpoints:{single:()=>`${_s}/api/user/enhanced-food-recognition/analyze-single`,multi:()=>`${_s}/api/user/enhanced-food-recognition/analyze-multi`,barcode:()=>`${_s}/api/user/enhanced-food-recognition/barcode-scan`,restaurant:()=>`${_s}/api/user/enhanced-food-recognition/restaurant-menu`},defaultOptions:{enablePortionEstimation:!0,enable3DEstimation:!1,confidenceThreshold:.7,referenceObjects:["hand","credit_card","smartphone"],restaurantMode:!1,enableHealthScoring:!0,enableNutritionAnalysis:!0,enableConfidenceDisplay:!0,enableProcessingTimeDisplay:!0,enableModelVersionDisplay:!0,enableErrorHandling:!0,enableFallbackMode:!0,enableRetryMechanism:!0,maxRetryAttempts:3,retryDelay:1e3,timeout:3e4,cacheResults:!0,cacheExpiration:300*1e3},supportedLanguages:["en","es","fr","de","it","pt","ru","ja","ko","zh"],supportedCuisines:["american","italian","mexican","chinese","japanese","korean","thai","indian","mediterranean","french","german","spanish"],confidenceLevels:{high:.8,medium:.6,low:.4},portionSizeConfig:{referenceObjects:{hand:{avgWidth:8.5,avgHeight:18,avgDepth:2.5},credit_card:{width:8.56,height:5.4,depth:.76},smartphone:{width:6.5,height:13,depth:.8},coin:{diameter:2.4,thickness:.2}},maxPortionSize:2e3,minPortionSize:10,defaultPortionSize:100,enable3DEstimation:!1,enableWeightEstimation:!0,enableVolumeEstimation:!0},healthScoringConfig:{enableScoring:!0,maxScore:100,minScore:0,factors:{nutritionBalance:.4,calorieDensity:.3,processingLevel:.2,additives:.1},thresholds:{excellent:90,good:75,fair:60,poor:45,veryPoor:0}},nutritionAnalysisConfig:{enableAnalysis:!0,macronutrients:["calories","protein","carbs","fat","fiber","sugar","sodium"],micronutrients:["vitamins","minerals"],allergens:["gluten","dairy","nuts","soy","eggs","fish","shellfish","sesame"],enableAllergenDetection:!0,enableMicronutrientAnalysis:!0,enableDailyValueCalculation:!0,dailyValues:{calories:2e3,protein:50,carbs:300,fat:65,fiber:25,sugar:50,sodium:2300}},errorHandlingConfig:{enableErrorHandling:!0,enableFallbackMode:!0,enableRetryMechanism:!0,maxRetryAttempts:3,retryDelay:1e3,timeout:3e4,enableLogging:!0,enableAnalytics:!0,enableDebugMode:!1,errorMessages:{networkError:"Network error. Please check your connection and try again.",timeoutError:"Request timed out. Please try again.",processingError:"Failed to process image. Please try again.",confidenceError:"Low confidence in detection. Please try a clearer image.",sizeError:"Image too large. Please use a smaller image.",formatError:"Unsupported image format. Please use JPEG, PNG, or WebP.",permissionError:"Camera permission denied. Please enable camera access.",unknownError:"An unexpected error occurred. Please try again."}}},fn={enforceHTTPS:et!=="development",tokenValidation:{minLength:10,maxLength:2048,requireBearerPrefix:!1,allowRefreshTokens:!0,maxTokenAge:900*1e3,refreshBuffer:300*1e3},rateLimit:{api:{max:100,windowMs:900*1e3},auth:{max:5,windowMs:900*1e3}},headers:{"X-Content-Type-Options":"nosniff","X-Frame-Options":"DENY","X-XSS-Protection":"1; mode=block","Strict-Transport-Security":"max-age=31536000; includeSubDomains; preload","Content-Security-Policy":"default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self' https://api.openai.com https://generativelanguage.googleapis.com; font-src 'self'; object-src 'none'; media-src 'self'; frame-src 'self'; worker-src 'self'; child-src 'self'; frame-ancestors 'none'; form-action 'self'; manifest-src 'self'; base-uri 'self'","Referrer-Policy":"strict-origin-when-cross-origin","Permissions-Policy":"camera=(), microphone=(), geolocation=()","Cache-Control":"no-store, no-cache, must-revalidate, proxy-revalidate",Pragma:"no-cache",Expires:"0"},cors:{allowedOrigins:[...et==="development"?["http://localhost:3000","http://localhost:5173","http://localhost:4173"]:[],...et==="production"?["https://aicalorietracker.com","https://www.aicalorietracker.com","https://aical.scanitix.com","https://www.aical.scanitix.com"]:[],...et==="staging"?["https://staging.aicalorietracker.com"]:[]],allowedMethods:["GET","POST","PUT","DELETE","PATCH","OPTIONS"],allowedHeaders:["Origin","X-Requested-With","Content-Type","Accept","Authorization","X-API-Key","X-CSRF-Token","X-Session-ID"],exposedHeaders:["X-Total-Count","X-RateLimit-Limit","X-RateLimit-Remaining"],credentials:!0,maxAge:86400},requestValidation:{maxBodySize:"10mb",maxUploadSize:"5mb",allowedFileTypes:["image/jpeg","image/png","image/webp","application/pdf"],sanitizeInput:!0,validateTokenFormat:!0,checkForSQLInjection:!0,checkForXSS:!0},logging:{enableSecurityLogging:!0,logAuthenticationAttempts:!0,logSecurityViolations:!0,logSuspiciousActivity:!0,logTokenValidation:!0,logRequestValidation:!0}},Js={api:_s,features:un,camera:jn,enhancedFoodRecognition:pn,security:fn},K=(s,t)=>{console.error(`[${new Date().toISOString()}] ERROR: ${s}`,t||"")},Ne=(s,t)=>{},Y=(s,t)=>{console.warn(`[${new Date().toISOString()}] WARNING: ${s}`,t||"")},ks={ACCESS_TOKEN:"accessToken",REFRESH_TOKEN:"refreshToken"},ut="tokenMetadata",At=s=>{try{localStorage.setItem(ks.ACCESS_TOKEN,s);const t={expiresAt:Date.now()+840*1e3,issuedAt:Date.now(),lastChecked:Date.now()};localStorage.setItem(ut,JSON.stringify(t)),Ne("Access token stored successfully")}catch(t){throw K("Failed to store access token",t),new Error("Failed to store authentication token")}},Qa=s=>{try{localStorage.setItem(ks.REFRESH_TOKEN,s),Ne("Refresh token stored successfully")}catch(t){throw K("Failed to store refresh token",t),new Error("Failed to store refresh token")}},Oe=()=>{try{return localStorage.getItem(ks.ACCESS_TOKEN)}catch(s){return K("Failed to retrieve access token",s),null}},us=()=>{try{return localStorage.getItem(ks.REFRESH_TOKEN)}catch(s){return K("Failed to retrieve refresh token",s),null}},Je=()=>{try{localStorage.removeItem(ks.ACCESS_TOKEN),localStorage.removeItem(ks.REFRESH_TOKEN),localStorage.removeItem(ut),Ne("All tokens cleared successfully")}catch(s){throw K("Failed to clear tokens",s),new Error("Failed to clear authentication tokens")}},gn=()=>Oe()?Qe()?(Y("Access token is expired"),!1):!0:!1,Nt=s=>{try{if(s.tokens&&s.tokens.accessToken&&s.tokens.refreshToken)At(s.tokens.accessToken),Qa(s.tokens.refreshToken),Ne("Tokens updated from response with new format");else if(s.token)At(s.token),Ne("Token updated from response with old format");else throw Y("No valid tokens found in response data"),new Error("No valid tokens received from server")}catch(t){throw K("Failed to update tokens from response",t),new Error("Failed to store authentication tokens")}},Xa=s=>{try{const a=s.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(a).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""));return JSON.parse(r)}catch(t){return K("Failed to decode JWT token",t),null}},Qe=s=>{try{const t=s||Oe();if(!t)return!0;const a=Xa(t);if(!a||!a.exp)return Y("Token payload missing expiration information"),!0;const r=Math.floor(Date.now()/1e3),i=a.exp<r;return i&&Y(`Token expired at ${new Date(a.exp*1e3).toISOString()}`),i}catch(t){return K("Failed to check token expiration",t),!0}},yn=()=>{try{const s=localStorage.getItem(ut);if(!s)return null;const t=JSON.parse(s);return t.lastChecked=Date.now(),localStorage.setItem(ut,JSON.stringify(t)),t}catch(s){return K("Failed to retrieve token metadata",s),null}},Nn=(s=5)=>{try{const t=Oe();if(!t)return!0;const a=Xa(t);if(!a||!a.exp)return!0;const r=Math.floor(Date.now()/1e3),i=s*60,l=a.exp<r+i;return l&&Y(`Token expiring soon at ${new Date(a.exp*1e3).toISOString()}`),l}catch(t){return K("Failed to check if token is expiring soon",t),!0}},Za=()=>{if(!gn())return Y("Invalid access token for request"),!1;const s=Oe();return s?wn(s)?(Y("Token has been revoked"),!1):vn(s)?bn()?!0:(Y("Secure storage validation failed"),!1):(Y("Token structure validation failed"),!1):!1},ps=()=>{try{const s=Oe(),t=us();let a=!1;s&&Qe(s)&&(Ne("Cleaning up expired access token"),localStorage.removeItem(ks.ACCESS_TOKEN),localStorage.removeItem(ut),a=!0),t&&Qe(t)&&(Ne("Cleaning up expired refresh token"),localStorage.removeItem(ks.REFRESH_TOKEN),a=!0),a&&Ne("Expired tokens cleaned up successfully")}catch(s){K("Failed to cleanup expired tokens",s)}},Xs=()=>{try{Je(),localStorage.removeItem("authState"),localStorage.removeItem("userPreferences"),Ne("All authentication data cleaned up successfully")}catch(s){throw K("Failed to cleanup all auth data",s),new Error("Failed to cleanup authentication data")}},vn=(s,t)=>{try{if(!s||typeof s!="string")return Y("Token is not a valid string"),!1;const a=s.split(".");if(a.length!==3)return Y("Token does not have proper JWT structure"),!1;for(const r of a)if(!/^[A-Za-z0-9_-]*$/.test(r))return Y("Token contains invalid base64url characters"),!1;return Ne("Token structure validation passed (signature verification skipped for browser compatibility)"),!0}catch(a){return K("Token signature validation failed",a),!1}},bn=()=>{try{const s=Oe(),t=us();if(!s||!t)return Y("Missing tokens in storage"),!1;if(!jt(s)||!jt(t))return Y("Invalid token format in storage"),!1;if(Qe(s)||Qe(t))return Y("Expired tokens found in storage"),!1;const a=yn();if(!a)return Y("Missing token metadata"),!1;const r=Date.now();return a.expiresAt<r?(Y("Token metadata indicates expired token"),!1):(Ne("Token storage validation passed"),!0)}catch(s){return K("Token storage validation failed",s),!1}},wn=s=>{try{return!!(!jt(s)||Qe(s))}catch(t){return K("Token revocation check failed",t),!0}},er=s=>{if(!Js.security.enforceHTTPS)return!0;try{const a=new URL(s).protocol==="https:";return a||Y(`HTTPS required but HTTP URL detected: ${s}`),a}catch(t){return K("Invalid URL format for HTTPS validation",t),!1}},ra=(s={})=>{const t=Js.security.headers;return Object.entries(t).forEach(([a,r])=>{s[a]=r}),s},kn=(s={})=>{const t=Oe();if(t&&!Qe(t))s.Authorization=`Bearer ${t}`;else if(t){Y("Expired token detected, attempting cleanup");try{ps()}catch(a){K("Failed to cleanup expired token",a)}}return s},jt=s=>{if(!s)return!1;const t=Js.security.tokenValidation;if(s.length<t.minLength||s.length>t.maxLength)return Y(`Token length validation failed: ${s.length} characters`),!1;const a=s.split(".");if(a.length!==3)return Y("Invalid JWT token structure"),!1;try{const r=JSON.parse(atob(a[0])),i=JSON.parse(atob(a[1]));if(!r.typ||r.typ!=="JWT")return Y("Invalid JWT header type"),!1;if(!i.exp||!i.iat)return Y("JWT missing required expiration or issued at claims"),!1;const n=Math.floor(Date.now()/1e3)-i.iat;if(n>t.maxTokenAge/1e3)return Y(`Token too old: ${n} seconds`),!1}catch(r){return Y("JWT token parsing failed",r),!1}return!0},ha=3,Sn=1e3,Cn=1e4,En=.1;let As=0,zt=!1,_t=0;const ua=5e3,Tn=async()=>{const s=us();if(!s)return K("Token refresh failed: No refresh token available"),null;try{Ne("Attempting to refresh access token");const t=await fetch(`${Js.api}/api/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:s})});if(!t.ok){const i=(await t.json().catch(()=>({}))).message||"Failed to refresh token";throw K(`Token refresh failed: ${i}`,{status:t.status}),new Error(i)}const a=await t.json();return At(a.accessToken),As=0,Ne("Access token refreshed successfully"),a.accessToken}catch(t){throw Je(),As=0,K("Token refresh failed, clearing tokens",t),t}},ja=s=>{const t=Sn*Math.pow(2,s-1),a=t*En*Math.random();return Math.min(t+a,Cn)},Rt=async()=>{const s=Date.now();if(s-_t<ua){const t=ua-(s-_t);await new Promise(a=>setTimeout(a,t))}if(zt){const t=ja(As);return await new Promise(a=>setTimeout(a,t)),Oe()}if(As>=ha)throw K(`Maximum refresh attempts (${ha}) exceeded`),new Error("Maximum refresh attempts exceeded");zt=!0,As++,_t=s;try{const t=await Tn();return As=0,t}catch(t){const a=ja(As);throw Y(`Token refresh failed, waiting ${a}ms before retry`,t),await new Promise(r=>setTimeout(r,a)),t}finally{zt=!1}};async function Gt(s){if(!s.ok){const t=await s.text()||s.statusText;throw new Error(`${s.status}: ${t}`)}}async function ke(s,t,a){try{ps()}catch(n){K("Failed to cleanup expired tokens before request",n)}if(t.startsWith("/api/")&&(t=`${Js.api}${t}`),!er(t))throw new Error("HTTPS is required for all API requests. Please use a secure connection.");const r=Oe();if(!r&&!t.includes("/auth/login")&&!t.includes("/auth/register")&&!t.includes("/auth/refresh"))throw new Error("Authentication required. Please log in to continue.");const i={};if(ra(i),i["Content-Type"]="application/json",r){if(!jt(r)){Y("Token format validation failed, attempting cleanup");try{ps()}catch(p){K("Failed to cleanup invalid token",p)}throw new Error("Authentication token format is invalid. Please log in again.")}let n=0;const d=1;let u=!1;for(;n<=d&&!u;)Za()?u=!0:n<d&&(await new Promise(p=>setTimeout(p,100)),n++);if(u)i.Authorization=`Bearer ${r}`;else throw new Error("Authentication token is invalid. Please log in again.")}let l=await fetch(t,{method:s,headers:i,body:a?JSON.stringify(a):void 0,credentials:"include"});if(l.status===401&&!t.includes("/auth/refresh"))try{const n=await Rt();if(n){const d={...i};if(d.Authorization=`Bearer ${n}`,Ne(`Retrying ${s} ${t} with new token`),l=await fetch(t,{method:s,headers:d,body:a?JSON.stringify(a):void 0,credentials:"include"}),l.status===401)throw K("Token refresh succeeded but retry still failed with 401 - session likely expired"),Je(),new Error("Session expired. Please log in again.");if(!l.ok){const u=await l.text().catch(()=>"Unknown error");throw K(`Retry failed with status ${l.status} for ${s} ${t}: ${u}`),new Error(`Request failed after token refresh: ${l.status} ${l.statusText}`)}return Ne(`Retry successful for ${s} ${t}`),await Gt(l),l}}catch(n){throw n instanceof Error?n.message.includes("Maximum refresh attempts exceeded")?(K(`Token refresh failed for ${s} ${t}: Max attempts exceeded`),Je(),new Error("Session expired. Please log in again.")):n.message.includes("Network")||n.message.includes("fetch")?(K(`Token refresh failed for ${s} ${t}: Network error`,n),new Error("Network error during authentication. Please check your connection and try again.")):(K(`Token refresh failed for ${s} ${t}: ${n.message}`,n),Je(),new Error("Session expired. Please log in again.")):(K(`Token refresh failed for ${s} ${t}: Unknown error`,n),Je(),new Error("Session expired. Please log in again."))}return await Gt(l),l}const cs=({on401:s})=>async t=>{const{queryKey:a}=t;try{ps()}catch(d){K("Failed to cleanup expired tokens before query",d)}let r=a[0];if(r.startsWith("/api/")&&(r=`${Js.api}${r}`),!er(r))return null;const i=Oe(),l={};if(ra(l),i){if(!jt(i)){Y("Token format validation failed for query, attempting cleanup");try{ps()}catch(d){K("Failed to cleanup invalid token for query",d)}return null}if(Za())l.Authorization=`Bearer ${i}`;else return null}let n=await fetch(r,{headers:l,credentials:"include"});if(n.status===401&&!r.includes("/auth/refresh"))try{const d=await Rt();if(d){const u={...l};if(u.Authorization=`Bearer ${d}`,Ne(`Retrying query ${r} with new token`),n=await fetch(r,{headers:u,credentials:"include"}),n.status===401){if(K(`Token refresh succeeded but query retry still failed with 401 for ${r}`),Je(),s==="returnNull")return null;throw new Error("Session expired. Please log in again.")}if(!n.ok){const p=await n.text().catch(()=>"Unknown error");if(K(`Query retry failed with status ${n.status} for ${r}: ${p}`),s==="returnNull")return null;throw new Error(`Query failed after token refresh: ${n.status} ${n.statusText}`)}}}catch(d){return d instanceof Error?d.message.includes("Maximum refresh attempts exceeded")?(K(`Token refresh failed for query ${r}: Max attempts exceeded`),Je(),null):d.message.includes("Network")||d.message.includes("fetch")?(K(`Token refresh failed for query ${r}: Network error`,d),null):(K(`Token refresh failed for query ${r}: ${d.message}`,d),Je(),null):(K(`Token refresh failed for query ${r}: Unknown error`,d),Je(),null)}return n.status===401?null:(await Gt(n),await n.json())},sr=new Yi({defaultOptions:{queries:{queryFn:cs({on401:"returnNull"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),An=1,Rn=1e6;let qt=0;function Pn(){return qt=(qt+1)%Number.MAX_SAFE_INTEGER,qt.toString()}const Bt=new Map,pa=s=>{if(Bt.has(s))return;const t=setTimeout(()=>{Bt.delete(s),it({type:"REMOVE_TOAST",toastId:s})},Rn);Bt.set(s,t)},In=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,An)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(a=>a.id===t.toast.id?{...a,...t.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=t;return a?pa(a):s.toasts.forEach(r=>{pa(r.id)}),{...s,toasts:s.toasts.map(r=>r.id===a||a===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(a=>a.id!==t.toastId)}}},kt=[];let St={toasts:[]};function it(s){St=In(St,s),kt.forEach(t=>{t(St)})}function Fn({...s}){const t=Pn(),a=i=>it({type:"UPDATE_TOAST",toast:{...i,id:t}}),r=()=>it({type:"DISMISS_TOAST",toastId:t});return it({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:i=>{i||r()}}}),{id:t,dismiss:r,update:a}}function ve(){const[s,t]=x.useState(St);return x.useEffect(()=>(kt.push(t),()=>{const a=kt.indexOf(t);a>-1&&kt.splice(a,1)}),[s]),{...s,toast:Fn,dismiss:a=>it({type:"DISMISS_TOAST",toastId:a})}}const Dn=Fr,tr=x.forwardRef(({className:s,...t},a)=>e.jsx(ba,{ref:a,className:L("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...t}));tr.displayName=ba.displayName;const Mn=ft("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),ar=x.forwardRef(({className:s,variant:t,...a},r)=>e.jsx(wa,{ref:r,className:L(Mn({variant:t}),s),...a}));ar.displayName=wa.displayName;const st=x.forwardRef(({className:s,...t},a)=>e.jsx(ka,{ref:a,className:L("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...t}));st.displayName=ka.displayName;const rr=x.forwardRef(({className:s,...t},a)=>e.jsx(Sa,{ref:a,className:L("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,children:e.jsx(Qt,{className:"h-4 w-4"})}));rr.displayName=Sa.displayName;const ir=x.forwardRef(({className:s,...t},a)=>e.jsx(Ca,{ref:a,className:L("text-sm font-semibold",s),...t}));ir.displayName=Ca.displayName;const nr=x.forwardRef(({className:s,...t},a)=>e.jsx(Ea,{ref:a,className:L("text-sm opacity-90",s),...t}));nr.displayName=Ea.displayName;var Rs=(s=>(s.INVALID_CREDENTIALS="INVALID_CREDENTIALS",s.TOKEN_EXPIRED="TOKEN_EXPIRED",s.TOKEN_INVALID="TOKEN_INVALID",s.NETWORK_ERROR="NETWORK_ERROR",s.RATE_LIMITED="RATE_LIMITED",s.ACCOUNT_LOCKED="ACCOUNT_LOCKED",s.ACCOUNT_SUSPENDED="ACCOUNT_SUSPENDED",s.SESSION_EXPIRED="SESSION_EXPIRED",s.REFRESH_TOKEN_FAILED="REFRESH_TOKEN_FAILED",s.TOKEN_REVOKED="TOKEN_REVOKED",s.SECURITY_VIOLATION="SECURITY_VIOLATION",s.SERVER_ERROR="SERVER_ERROR",s.UNKNOWN_ERROR="UNKNOWN_ERROR",s.VALIDATION_ERROR="VALIDATION_ERROR",s.PERMISSION_DENIED="PERMISSION_DENIED",s))(Rs||{}),lr=(s=>(s.NONE="NONE",s.RETRY="RETRY",s.REFRESH_TOKEN="REFRESH_TOKEN",s.RELOGIN="RELOGIN",s.CONTACT_SUPPORT="CONTACT_SUPPORT",s.CLEAR_CACHE="CLEAR_CACHE",s))(lr||{});const fa={analytics:new Map},Ln={maxRetries:3,retryDelay:1e3,retryBackoff:2,enableAnalytics:!0,enableLogging:!0,enableRecovery:!0};let Vt={...Ln};function Ge(s,t,a={}){const r={type:s,message:t,userMessage:On(s,a.userMessage),severity:Un(s),recovery:$n(s),timestamp:new Date,retryable:zn(s),retryCount:0,retryDelay:Vt.retryDelay,...a};return Vt.enableAnalytics&&qn(r),Vt.enableLogging&&_n(r),r}function On(s,t){return t||{INVALID_CREDENTIALS:"Invalid username or password. Please check your credentials and try again.",TOKEN_EXPIRED:"Your session has expired. Please log in again.",TOKEN_INVALID:"Invalid authentication token. Please log in again.",NETWORK_ERROR:"Network connection error. Please check your internet connection and try again.",RATE_LIMITED:"Too many login attempts. Please wait a few minutes before trying again.",ACCOUNT_LOCKED:"Your account has been locked due to too many failed attempts. Please try again later or contact support.",ACCOUNT_SUSPENDED:"Your account has been suspended. Please contact support for assistance.",SESSION_EXPIRED:"Your session has expired. Please log in again to continue.",REFRESH_TOKEN_FAILED:"Failed to refresh your session. Please log in again.",TOKEN_REVOKED:"Your access has been revoked. Please log in again.",SECURITY_VIOLATION:"Security violation detected. Your session has been terminated for your protection.",SERVER_ERROR:"Server error occurred. Please try again later.",UNKNOWN_ERROR:"An unexpected error occurred. Please try again.",VALIDATION_ERROR:"Invalid input. Please check your information and try again.",PERMISSION_DENIED:"You do not have permission to perform this action."}[s]||"An authentication error occurred. Please try again."}function Un(s){return{INVALID_CREDENTIALS:"MEDIUM",TOKEN_EXPIRED:"MEDIUM",TOKEN_INVALID:"HIGH",NETWORK_ERROR:"LOW",RATE_LIMITED:"MEDIUM",ACCOUNT_LOCKED:"HIGH",ACCOUNT_SUSPENDED:"CRITICAL",SESSION_EXPIRED:"MEDIUM",REFRESH_TOKEN_FAILED:"HIGH",TOKEN_REVOKED:"HIGH",SECURITY_VIOLATION:"CRITICAL",SERVER_ERROR:"HIGH",UNKNOWN_ERROR:"HIGH",VALIDATION_ERROR:"LOW",PERMISSION_DENIED:"MEDIUM"}[s]||"MEDIUM"}function $n(s){return{INVALID_CREDENTIALS:"RELOGIN",TOKEN_EXPIRED:"REFRESH_TOKEN",TOKEN_INVALID:"RELOGIN",NETWORK_ERROR:"RETRY",RATE_LIMITED:"NONE",ACCOUNT_LOCKED:"CONTACT_SUPPORT",ACCOUNT_SUSPENDED:"CONTACT_SUPPORT",SESSION_EXPIRED:"RELOGIN",REFRESH_TOKEN_FAILED:"RELOGIN",TOKEN_REVOKED:"RELOGIN",SECURITY_VIOLATION:"CONTACT_SUPPORT",SERVER_ERROR:"RETRY",UNKNOWN_ERROR:"RETRY",VALIDATION_ERROR:"NONE",PERMISSION_DENIED:"NONE"}[s]||"NONE"}function zn(s){return["NETWORK_ERROR","SERVER_ERROR","UNKNOWN_ERROR","TOKEN_EXPIRED","REFRESH_TOKEN_FAILED"].includes(s)}function _n(s){const t={type:s.type,message:s.message,severity:s.severity,timestamp:s.timestamp.toISOString(),code:s.code,details:s.details,retryCount:s.retryCount};switch(s.severity){case"LOW":Y(`Authentication warning: ${s.message}`,t);break;case"MEDIUM":Y(`Authentication error: ${s.message}`,t);break;case"HIGH":K(`Authentication error: ${s.message}`,t);break;case"CRITICAL":K(`Critical authentication error: ${s.message}`,t);break}}function qn(s){const t=fa.analytics.get(s.type);t?(t.frequency++,t.lastOccurrence=s.timestamp,t.affectedUsers.includes("current-user")||t.affectedUsers.push("current-user")):fa.analytics.set(s.type,{errorType:s.type,frequency:1,lastOccurrence:s.timestamp,affectedUsers:["current-user"]})}function xs(s){if(s.response){const t=s.response.status,a=s.response.data;switch(t){case 400:return Ge("VALIDATION_ERROR",a.message||"Invalid request data",{details:a});case 401:return Ge("INVALID_CREDENTIALS",a.message||"Invalid authentication credentials",{details:a});case 403:return Ge("PERMISSION_DENIED",a.message||"Access denied",{details:a});case 429:return Ge("RATE_LIMITED",a.message||"Too many requests",{details:a});case 419:return Ge("SESSION_EXPIRED",a.message||"Session expired",{details:a});case 500:case 502:case 503:return Ge("SERVER_ERROR",a.message||"Server error",{details:a});default:return Ge("UNKNOWN_ERROR",a.message||`HTTP error ${t}`,{details:a,code:`HTTP_${t}`})}}else return s.request?Ge("NETWORK_ERROR","Network error occurred",{details:s.message}):Ge("UNKNOWN_ERROR",s.message||"Unknown authentication error",{details:s})}const ga={activeErrors:new Map,globalError:null,errorHistory:[],isLoading:!1,recoveryInProgress:!1,errorSettings:{enableAnalytics:!0,enableLogging:!0,enableRecovery:!0,maxRetries:3,retryDelay:1e3}};function Bn(s,t){switch(t.type){case"ADD_ERROR":return{...s,activeErrors:new Map(s.activeErrors).set(t.payload.errorId,t.payload.error)};case"REMOVE_ERROR":const a=new Map(s.activeErrors);return a.delete(t.payload),{...s,activeErrors:a};case"SET_GLOBAL_ERROR":return{...s,globalError:t.payload};case"ADD_TO_HISTORY":return{...s,errorHistory:[t.payload,...s.errorHistory].slice(0,100)};case"SET_LOADING":return{...s,isLoading:t.payload};case"SET_RECOVERY_IN_PROGRESS":return{...s,recoveryInProgress:t.payload};case"UPDATE_SETTINGS":return{...s,errorSettings:{...s.errorSettings,...t.payload}};case"CLEAR_ALL_ERRORS":return{...s,activeErrors:new Map,globalError:null};case"CLEAR_HISTORY":return{...s,errorHistory:[]};default:return s}}const cr=x.createContext(null);function Vn({children:s,initialSettings:t}){const[a,r]=x.useReducer(Bn,{...ga,errorSettings:{...ga.errorSettings,...t}}),i=x.useCallback(T=>`${T.type}-${T.timestamp.getTime()}-${Math.random().toString(36).substr(2,9)}`,[]),l=x.useCallback((T,m)=>{const N=m||i(T);return r({type:"ADD_ERROR",payload:{errorId:N,error:T}}),r({type:"ADD_TO_HISTORY",payload:T}),N},[i]),n=x.useCallback(T=>{r({type:"REMOVE_ERROR",payload:T})},[]),d=x.useCallback(T=>{r({type:"SET_GLOBAL_ERROR",payload:T})},[]),u=x.useCallback(T=>{r({type:"ADD_TO_HISTORY",payload:T})},[]),p=x.useCallback(T=>{r({type:"SET_LOADING",payload:T})},[]),o=x.useCallback(T=>{r({type:"SET_RECOVERY_IN_PROGRESS",payload:T})},[]),h=x.useCallback(T=>{r({type:"UPDATE_SETTINGS",payload:T})},[]),j=x.useCallback(()=>{r({type:"CLEAR_ALL_ERRORS"})},[]),f=x.useCallback(()=>{r({type:"CLEAR_HISTORY"})},[]),k=x.useCallback(T=>Array.from(a.activeErrors.values()).find(N=>N.type===T)||null,[a.activeErrors]),c=x.useCallback(T=>Array.from(a.activeErrors.values()).filter(m=>m.severity===T),[a.activeErrors]),R=x.useCallback(T=>T?a.activeErrors.has(`${T}-`):a.activeErrors.size>0,[a.activeErrors]),D=x.useCallback(()=>a.activeErrors.size,[a.activeErrors]),S=x.useCallback(()=>Array.from(a.activeErrors.values()).filter(T=>T.recovery!==lr.NONE&&!T.retryable),[a.activeErrors]),q={state:a,actions:{addError:l,removeError:n,setGlobalError:d,addToHistory:u,setLoading:p,setRecoveryInProgress:o,updateSettings:h,clearAllErrors:j,clearHistory:f,getErrorByType:k,getErrorsBySeverity:c,hasError:R,getErrorCount:D,getRecoveryErrors:S}};return e.jsx(cr.Provider,{value:q,children:s})}function or(){const s=x.useContext(cr);if(!s)throw new Error("useErrorContext must be used within an ErrorProvider");return s}function Hn(){const{state:s,actions:t}=or(),a=x.useCallback(async n=>{t.setLoading(!0),t.setRecoveryInProgress(!0);try{const d=t.addError(n);return await Kn(n)?(t.removeError(d),!0):!1}catch(d){return console.error("Error recovery failed:",d),!1}finally{t.setLoading(!1),t.setRecoveryInProgress(!1)}},[t]),r=x.useCallback(n=>{console.error("Error notification:",n.userMessage)},[]),i=x.useCallback(n=>{t.removeError(n)},[t]),l=x.useCallback(()=>{t.clearAllErrors()},[t]);return{...t,...s,handleError:a,showErrorNotification:r,dismissError:i,dismissAllErrors:l,hasActiveErrors:s.activeErrors.size>0,hasGlobalError:s.globalError!==null,isRecovering:s.recoveryInProgress}}async function Kn(s){return await new Promise(a=>setTimeout(a,1e3)),[Rs.NETWORK_ERROR,Rs.SERVER_ERROR,Rs.TOKEN_EXPIRED,Rs.SESSION_EXPIRED].includes(s.type)?Math.random()>.3:!1}Cs({username:ae().min(3,"Username must be at least 3 characters"),password:ae().min(6,"Password must be at least 6 characters")});Cs({username:ae().min(3,"Username must be at least 3 characters"),email:ae().email("Invalid email address"),password:ae().min(8,"Password must be at least 8 characters"),confirmPassword:ae().min(8,"Password must be at least 8 characters"),firstName:ae().min(1,"First name is required"),lastName:ae().min(1,"Last name is required")}).refine(s=>s.password===s.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]});const dr=x.createContext(null);function Wn({children:s}){const{toast:t}=ve(),[,a]=gt(),r=Ss(),[i,l]=x.useState(!1),[n,d]=x.useState(null),[u,p]=x.useState(!1),{state:o,actions:h}=or(),{handleError:j,showErrorNotification:f}=Hn(),{data:k,error:c,isLoading:R}=W({queryKey:["/api/auth/me"],queryFn:cs({on401:"returnNull"})}),D=J({mutationFn:async m=>{try{const F=await(await ke("POST","/api/auth/login",m)).json();if(!F)throw new Error("Empty response received from login");if(F.tokens&&typeof F.tokens=="object")if(F.tokens.accessToken&&F.tokens.refreshToken){if(!F.tokens.accessToken||typeof F.tokens.accessToken!="string")throw new Error("Invalid access token format in response");if(!F.tokens.refreshToken||typeof F.tokens.refreshToken!="string")throw new Error("Invalid refresh token format in response");if(Nt(F),F.user)return F.user;throw new Error("Login successful but user data missing from response")}else throw new Error("Incomplete token data in response");else if(F.token&&typeof F.token=="string"){if(F.token.length<10)throw new Error("Invalid token format in response");return Nt(F),F}else return F.user?F.user:(Y("Unrecognized login response format",F),F)}catch(N){const F=xs(N);throw await j(F),F}},onSuccess:m=>{r.setQueryData(["/api/auth/me"],m),t({title:"Welcome back!",description:`Logged in as ${m.firstName} ${m.lastName}`}),h.clearAllErrors()},onError:m=>{const N=xs(m);f(N),t({title:"Login failed",description:N.userMessage,variant:"destructive",action:N.recovery==="RELOGIN"?e.jsx(st,{altText:"Retry login",onClick:()=>D.mutateAsync(D.variables),children:"Retry"}):void 0})}}),S=J({mutationFn:async m=>{try{const{confirmPassword:N,...F}=m,_=await(await ke("POST","/api/auth/register",F)).json();return _.tokens&&_.user?(Nt(_),_.user):(_.token&&Nt(_),_)}catch(N){const F=xs(N);throw await j(F),F}},onSuccess:m=>{r.setQueryData(["/api/auth/me"],m),t({title:"Registration successful!",description:`Welcome to NutriScan, ${m.firstName}!`}),a("/onboarding"),h.clearAllErrors()},onError:m=>{const N=xs(m);f(N),t({title:"Registration failed",description:N.userMessage,variant:"destructive"})}}),q=J({mutationFn:async()=>{try{await ke("POST","/api/auth/logout")}catch(m){throw K("Logout API call failed",m),m}},onSuccess:()=>{Xs(),r.setQueryData(["/api/auth/me"],null),r.removeQueries(),d(null),p(!0),h.clearAllErrors(),t({title:"Logged out",description:"You have been logged out successfully"}),a("/login")},onError:async m=>{const N=xs(m);await j(N);try{Xs(),r.setQueryData(["/api/auth/me"],null),r.removeQueries(),d(null),p(!0),h.clearAllErrors(),a("/login")}catch(F){K("Failed to cleanup tokens during failed logout",F)}t({title:"Logout failed",description:N.userMessage,variant:"destructive"})}}),T=J({mutationFn:async({refreshToken:m})=>{try{return await(await ke("POST","/api/auth/refresh",{refreshToken:m})).json()}catch(N){throw xs(N)}},onSuccess:m=>{At(m.accessToken),d(null),p(!1),h.clearAllErrors(),r.setQueryDefaults(["/api/auth/me"],{queryFn:cs({on401:"returnNull"})})},onError:async m=>{const N=xs(m);await j(N),K("Token refresh failed",N);try{Xs(),r.setQueryData(["/api/auth/me"],null),r.removeQueries(),d("Session expired. Please log in again."),p(!0),t({title:"Session expired",description:N.userMessage,variant:"destructive",action:e.jsx(st,{altText:"Go to login",onClick:()=>a("/login"),children:"Login"})}),a("/login")}catch(F){throw K("Failed to cleanup tokens during refresh failure",F),F}}});return x.useEffect(()=>{(async()=>{const N=Oe(),F=us();if(N&&!k)try{if(!Qe(N))Ne("Valid access token found, user profile should load automatically");else if(F&&!Qe(F)){Ne("Access token expired but refresh token valid, attempting refresh");try{await Rt(),Ne("Silent token refresh successful during session recovery")}catch(A){Y("Silent token refresh failed during session recovery",A)}}else Y("Both tokens expired or invalid, clearing session"),Xs(),d("Your session has expired. Please log in again.")}catch(A){K("Session recovery failed",A)}if(!us()&&F&&Qa(F),n){const A=Ge(Rs.SESSION_EXPIRED,n);f(A),t({title:"Authentication Error",description:n,variant:"destructive",action:n.includes("expired")?e.jsx(st,{altText:"Go to login",onClick:()=>a("/login"),children:"Login"}):void 0}),d(null)}})()},[k,n,t,a]),x.useEffect(()=>{const m=()=>{try{if(ps(),Oe()&&Qe()&&(Y("Access token expired, attempting cleanup"),ps(),us()&&Qe(us()))){Y("Both tokens expired, forcing logout"),p(!0);const A=Ge(Rs.SESSION_EXPIRED,"Your session has expired. Please log in again.");h.addError(A),f(A),t({title:"Session Expired",description:A.userMessage,variant:"destructive",action:e.jsx(st,{altText:"Go to login",onClick:()=>a("/login"),children:"Login"})})}Oe()&&Nn(5)&&(Ne("Token expiring soon, attempting refresh"),us()&&Rt().catch(_=>{const Q=xs(_);j(Q),K("Preemptive token refresh failed",_)}))}catch(A){K("Token cleanup failed",A)}};m();const N=setInterval(m,6e4),F=()=>{try{ps()}catch(A){K("Failed to cleanup tokens on page unload",A)}};return window.addEventListener("beforeunload",F),()=>{clearInterval(N),window.removeEventListener("beforeunload",F)}},[a,t]),x.useEffect(()=>{if(u)try{Xs(),r.removeQueries(),d(null),Ne("Token cleanup trigger processed successfully")}catch(m){K("Failed to process token cleanup trigger",m)}finally{p(!1)}},[u,r]),e.jsx(dr.Provider,{value:{user:k??null,isLoading:R,error:c,loginMutation:D,logoutMutation:q,registerMutation:S,refreshMutation:T,isRefreshing:i,authError:n},children:s})}function Le(){const s=x.useContext(dr);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s}const Yt=ft("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover:shadow-md active:scale-95",{variants:{variant:{default:"bg-neutral-900 text-neutral-100 hover:bg-neutral-800 shadow-md",dark:"bg-neutral-900 text-neutral-100 hover:bg-neutral-800 shadow-md",accent:"bg-gradient-to-r from-green-600 to-lime-500 text-white shadow-lg hover:from-green-700 hover:to-lime-600",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"dark",size:"default"}}),v=x.forwardRef(({className:s,variant:t,size:a,asChild:r=!1,...i},l)=>{const n=r?Ta:"button";return e.jsx(n,{className:L(Yt({variant:t,size:a,className:s})),ref:l,...i})});v.displayName="Button";function Gn({user:s,currentPath:t,onLogout:a,onClose:r}){const i=s?`${s.firstName.charAt(0)}${s.lastName.charAt(0)}`:null,l=()=>{r()},n=()=>{a(),r()};return e.jsxs("div",{className:"md:hidden bg-white border-b border-neutral-200 px-4 py-2",children:[s&&e.jsx("div",{className:"flex items-center py-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"inline-flex items-center justify-center h-8 w-8 rounded-full bg-primary-100",children:e.jsx("span",{className:"text-sm font-medium leading-none text-primary-700",children:i})}),e.jsxs("span",{className:"ml-2 text-neutral-700 font-medium",children:[s.firstName," ",s.lastName]})]})}),e.jsxs("nav",{className:"py-2 space-y-1",children:[e.jsx(V,{href:"/dashboard",onClick:l,children:e.jsx("a",{className:`block px-3 py-2 rounded-md text-base font-medium ${t==="/dashboard"?"text-primary-700 bg-primary-50":"text-neutral-700 hover:text-primary-600 hover:bg-primary-50"}`,children:"Dashboard"})}),e.jsx(V,{href:"/history",onClick:l,children:e.jsx("a",{className:`block px-3 py-2 rounded-md text-base font-medium ${t==="/history"?"text-primary-700 bg-primary-50":"text-neutral-700 hover:text-primary-600 hover:bg-primary-50"}`,children:"History"})}),e.jsx(V,{href:"/chatbot",onClick:l,children:e.jsx("a",{className:`block px-3 py-2 rounded-md text-base font-medium ${t==="/chatbot"?"text-primary-700 bg-primary-50":"text-neutral-700 hover:text-primary-600 hover:bg-primary-50"}`,children:"Nutrition Coach"})}),e.jsx(V,{href:"/achievements",onClick:l,children:e.jsxs("a",{className:`block px-3 py-2 rounded-md text-base font-medium ${t==="/achievements"?"text-primary-700 bg-primary-50":"text-neutral-700 hover:text-primary-600 hover:bg-primary-50"}`,children:[e.jsx(Vs,{className:"h-4 w-4 inline mr-2"})," Achievements"]})}),e.jsx(V,{href:"/nutrition-education",onClick:l,children:e.jsxs("a",{className:`block px-3 py-2 rounded-md text-base font-medium ${t==="/nutrition-education"?"text-primary-700 bg-primary-50":"text-neutral-700 hover:text-primary-600 hover:bg-primary-50"}`,children:[e.jsx(tt,{className:"h-4 w-4 inline mr-2"})," Nutrition Education"]})}),e.jsx(V,{href:"/profile",onClick:l,children:e.jsxs("a",{className:`block px-3 py-2 rounded-md text-base font-medium ${t==="/profile"?"text-primary-700 bg-primary-50":"text-neutral-700 hover:text-primary-600 hover:bg-primary-50"}`,children:[e.jsx(Ns,{className:"h-4 w-4 inline mr-2"})," Profile"]})}),e.jsx(V,{href:"/premium-analytics",onClick:l,children:e.jsxs("a",{className:`block px-3 py-2 rounded-md text-base font-medium ${t==="/premium-analytics"?"text-primary-700 bg-primary-50":"text-neutral-700 hover:text-primary-600 hover:bg-primary-50"}`,children:[e.jsx(It,{className:"h-4 w-4 inline mr-2"})," Analytics"]})}),e.jsx("button",{onClick:n,className:"w-full text-left block px-3 py-2 rounded-md text-base font-medium text-neutral-700 hover:text-primary-600 hover:bg-primary-50",children:"Logout"})]})]})}function Yn(){const{i18n:s}=Dr(),t=x.useCallback(a=>{const r=a.target.value;s.changeLanguage(r),document.dir=r==="ar"?"rtl":"ltr"},[s]);return e.jsxs("select",{className:"border border-neutral-300 rounded-md px-2 py-1 text-sm bg-primary focus:outline-none focus:ring-2 focus:ring-primary-500",value:s.language,onChange:t,"aria-label":"Select language",children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"ar",children:"عربي"}),e.jsx("option",{value:"es",children:"Español"}),e.jsx("option",{value:"fr",children:"Français"}),e.jsx("option",{value:"pt",children:"Português"})]})}function He(){const[s]=gt(),{user:t,logoutMutation:a}=Le(),[r,i]=x.useState(!1),l=()=>{a.mutate()},n=()=>{i(!r)},d=t?`${t.firstName.charAt(0)}${t.lastName.charAt(0)}`:null;return e.jsxs(e.Fragment,{children:[e.jsx("header",{className:"bg-white/95 border-b border-neutral-200 sticky top-0 z-50 shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ns,{className:"h-8 w-8 text-primary"}),e.jsx("span",{className:"ml-2 text-2xl font-bold text-neutral-800",children:"NutriScan"})]}),e.jsxs("nav",{className:"hidden md:flex space-x-8 items-center",children:[t?e.jsxs(e.Fragment,{children:[e.jsx(V,{href:"/dashboard",className:`text-neutral-700 hover:text-primary-600 font-medium ${s==="/dashboard"?"text-primary-600":""}`,children:"Dashboard"}),e.jsx(V,{href:"/history",className:`text-neutral-700 hover:text-primary-600 font-medium ${s==="/history"?"text-primary-600":""}`,children:"History"}),e.jsx(V,{href:"/chatbot",className:`text-neutral-700 hover:text-primary-600 font-medium ${s==="/chatbot"?"text-primary-600":""}`,children:"Nutrition Coach"}),e.jsxs(V,{href:"/achievements",className:`text-neutral-700 hover:text-primary-600 font-medium ${s==="/achievements"?"text-primary-600":""}`,children:[e.jsx(Vs,{className:"h-4 w-4 inline mr-1"})," Achievements"]}),e.jsxs(V,{href:"/nutrition-education",className:`text-neutral-700 hover:text-primary-600 font-medium ${s==="/nutrition-education"?"text-primary-600":""}`,children:[e.jsx(tt,{className:"h-4 w-4 inline mr-1"})," Nutrition Education"]}),e.jsxs(V,{href:"/profile",className:`text-neutral-700 hover:text-primary-600 font-medium ${s==="/profile"?"text-primary-600":""}`,children:[e.jsx(Ns,{className:"h-4 w-4 inline mr-1"})," Profile"]}),e.jsxs(V,{href:"/premium-analytics",className:`text-neutral-700 hover:text-primary-600 font-medium ${s==="/premium-analytics"?"text-primary-600":""}`,children:[e.jsx(It,{className:"h-4 w-4 inline mr-1"})," Analytics"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{href:"/try-it",className:`text-neutral-700 hover:text-primary-600 font-medium ${s==="/try-it"?"text-primary-600":""}`,children:"Try It"}),e.jsx(V,{href:"/about",className:`text-neutral-700 hover:text-primary-600 font-medium ${s==="/about"?"text-primary-600":""}`,children:"About"})]}),e.jsx(Yn,{})," "]}),e.jsxs("div",{className:"flex items-center",children:[t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden md:flex items-center mr-4",children:[e.jsx("span",{className:"inline-flex items-center justify-center h-8 w-8 rounded-full bg-primary-100",children:e.jsx("span",{className:"text-sm font-medium leading-none text-primary-700",children:d})}),e.jsxs("span",{className:"ml-2 text-neutral-700 font-medium",children:[t.firstName," ",t.lastName]})]}),e.jsx(v,{size:"sm",className:"hidden md:flex",onClick:l,children:"Logout"})]}):e.jsx(V,{href:"/login",children:e.jsx(v,{variant:"default",size:"sm",className:"hidden md:flex",children:"Sign In"})}),e.jsx("button",{type:"button",className:"md:hidden inline-flex items-center justify-center p-2 rounded-md text-neutral-500 hover:text-neutral-700 hover:bg-neutral-100 focus:outline-none",onClick:n,"aria-expanded":r,children:e.jsx("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})})]})]})})}),r&&e.jsx(Gn,{user:t,currentPath:s,onLogout:l,onClose:()=>i(!1)})]})}function qe(){const s=new Date().getFullYear();return e.jsx("footer",{className:"bg-white border-t border-neutral-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"md:flex md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex justify-center md:justify-start space-x-6",children:[e.jsx(V,{href:"/about",children:e.jsx("a",{className:"text-neutral-500 hover:text-neutral-700",children:"About"})}),e.jsx(V,{href:"/terms",children:e.jsx("a",{className:"text-neutral-500 hover:text-neutral-700",children:"Terms"})}),e.jsx(V,{href:"/privacy",children:e.jsx("a",{className:"text-neutral-500 hover:text-neutral-700",children:"Privacy"})}),e.jsx(V,{href:"/contact",children:e.jsx("a",{className:"text-neutral-500 hover:text-neutral-700",children:"Contact"})})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsxs("p",{className:"text-center md:text-right text-neutral-500 text-sm",children:["© ",s," NutriScan. All rights reserved."]})})]})})})}function mr(){const s=x.useRef(null),[t,a]=x.useState(!1),[r,i]=x.useState(!1),[l,n]=x.useState(null),[d,u]=x.useState(null),p=x.useCallback(()=>{a(!0),u(null)},[]),o=x.useCallback(()=>{a(!1),i(!1),n(null),u(null)},[]);x.useCallback(()=>{i(!0),u(null)},[]),x.useCallback(f=>{console.error("Camera error:",f),u(typeof f=="string"?f:"Failed to access camera"),i(!1)},[]);const h=x.useCallback(()=>{if(s.current){const f=s.current.getScreenshot();f?n(f):u("Failed to capture image")}else u("Camera not initialized")},[s]),j=x.useCallback(()=>{n(null)},[]);return{webcamRef:s,isOpen:t,isCameraReady:r,capturedImage:l,error:d,openCamera:p,closeCamera:o,captureImage:h,resetImage:j}}const we=x.forwardRef(({className:s,value:t,...a},r)=>e.jsx(Aa,{ref:r,className:L("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...a,children:e.jsx(Mr,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));we.displayName=Aa.displayName;function Jn({results:s,onBack:t,onUpdate:a}){const[r,i]=x.useState(null),[l,n]=x.useState(0),[d,u]=x.useState([]),p=j=>{i(j),n(s.foods?.[j]?.portionSize?.estimatedWeight||0)},o=j=>{if(l<=0)return;const f=s.foods?.[j];if(!f)return;const k=l/(f.portionSize?.estimatedWeight||1),c={...f,portionSize:{...f.portionSize,estimatedWeight:l},nutritionalInfo:{...f.nutritionalInfo,calories:Math.round(f.nutritionalInfo?.calories||0*k),protein:Math.round((f.nutritionalInfo?.protein||0)*k*10)/10,carbs:Math.round((f.nutritionalInfo?.carbs||0)*k*10)/10,fat:Math.round((f.nutritionalInfo?.fat||0)*k*10)/10}};a&&a(j,c),i(null)},h=j=>{const f=[...d];f[j]=!f[j],u(f)};return s.error?e.jsxs("div",{className:"fixed inset-0 bg-black z-50 p-4 flex flex-col",children:[e.jsx("button",{onClick:t,className:"absolute top-4 left-4 text-white bg-black/50 rounded-full p-2 z-10",children:e.jsx($s,{className:"h-6 w-6"})}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-xl text-center max-w-md",children:[e.jsx("div",{className:"text-red-500 mb-4",children:e.jsx(be,{className:"h-12 w-12 mx-auto"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Analysis Failed"}),e.jsx("p",{className:"text-gray-600 mb-6",children:s.error}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(v,{onClick:()=>t(),className:"w-full",variant:"outline",children:"Try Again"}),e.jsx(v,{onClick:()=>{s.fallbackData&&t()},className:"w-full",children:"Use Original Image"})]})]})})]}):s.foodName?e.jsxs("div",{className:"fixed inset-0 bg-black z-50 p-4 flex flex-col",children:[e.jsx("button",{onClick:t,className:"absolute top-4 left-4 text-white bg-black/50 rounded-full p-2 z-10",children:e.jsx($s,{className:"h-6 w-6"})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:s.foodName}),s.nutritionalInfo?.healthScore&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ft,{className:"h-5 w-5 text-red-500"}),e.jsxs("span",{className:"font-semibold text-gray-700",children:["Health Score: ",s.nutritionalInfo.healthScore,"/100"]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-lg font-medium",children:"Calories"}),e.jsx("span",{className:"text-2xl font-bold text-primary-600",children:s.nutritionalInfo?.calories||0})]}),e.jsx(we,{value:Math.min((s.nutritionalInfo?.calories||0)/800*100,100),className:"h-3"})]}),s.portionSize&&e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Lr,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"font-semibold text-blue-800",children:"Portion Size"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg px-3 py-2 text-sm font-medium",children:[s.portionSize.estimatedWeight,"g"]}),s.portionSize.referenceObject&&e.jsxs("div",{className:"bg-white rounded-lg px-3 py-2 text-sm text-gray-600",children:["Compared to ",s.portionSize.referenceObject]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-sm text-green-600 mb-1",children:"Protein"}),e.jsxs("div",{className:"text-xl font-bold text-green-800",children:[s.nutritionalInfo?.protein||0,"g"]})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-sm text-yellow-600 mb-1",children:"Carbs"}),e.jsxs("div",{className:"text-xl font-bold text-yellow-800",children:[s.nutritionalInfo?.carbs||0,"g"]})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-sm text-red-600 mb-1",children:"Fat"}),e.jsxs("div",{className:"text-xl font-bold text-red-800",children:[s.nutritionalInfo?.fat||0,"g"]})]})]}),s.analysisMetadata&&e.jsxs("div",{className:"text-sm text-gray-500 border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Processing Time:"}),e.jsxs("span",{children:[s.analysisMetadata.processingTime,"ms"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Model Version:"}),e.jsx("span",{children:s.analysisMetadata.modelVersion})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(v,{onClick:t,className:"flex-1",children:"Done"}),e.jsxs(v,{variant:"outline",onClick:()=>{s.portionSize&&(i(0),n(s.portionSize.estimatedWeight))},children:[e.jsx(Ct,{className:"h-4 w-4 mr-2"}),"Edit Portion"]})]})]})})]}):s.foods&&s.foods.length>0?e.jsxs("div",{className:"fixed inset-0 bg-black z-50 p-4 flex flex-col",children:[e.jsx("button",{onClick:t,className:"absolute top-4 left-4 text-white bg-black/50 rounded-full p-2 z-10",children:e.jsx($s,{className:"h-6 w-6"})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Detected Foods"}),s.analysisMetadata&&e.jsxs("p",{className:"text-gray-300",children:["Found ",s.analysisMetadata.totalFoods," foods with average confidence of ",(s.analysisMetadata.averageConfidence*100).toFixed(1),"%"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:s.foods.map((j,f)=>e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:j.foodName}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>h(f),className:"text-gray-500 hover:text-gray-700",children:e.jsx(Ra,{size:18})}),e.jsx("button",{onClick:()=>p(f),className:"text-blue-600 hover:text-blue-800",children:e.jsx(Ct,{size:18})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{children:"Calories"}),e.jsx("span",{className:"font-semibold",children:j.nutritionalInfo?.calories||0})]}),e.jsx(we,{value:Math.min((j.nutritionalInfo?.calories||0)/800*100,100),className:"h-2"})]}),r===f?e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Adjust Portion (grams)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",value:l,onChange:k=>n(Number(k.target.value)),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md",min:"1"}),e.jsx(v,{size:"sm",onClick:()=>o(f),children:e.jsx(pt,{size:16})}),e.jsx(v,{size:"sm",variant:"outline",onClick:()=>i(null),children:e.jsx(Qt,{size:16})})]})]}):j.portionSize&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Portion Size"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"bg-gray-100 rounded-lg px-3 py-1 text-sm",children:[j.portionSize.estimatedWeight,"g"]}),j.portionSize.referenceObject!=="none"&&e.jsxs("div",{className:"bg-gray-100 rounded-lg px-3 py-1 text-sm",children:["Compared to ",j.portionSize.referenceObject]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-xs text-blue-600",children:"Protein"}),e.jsxs("div",{className:"font-bold text-blue-800",children:[j.nutritionalInfo?.protein||0,"g"]})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-xs text-green-600",children:"Carbs"}),e.jsxs("div",{className:"font-bold text-green-800",children:[j.nutritionalInfo?.carbs||0,"g"]})]}),e.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg text-center",children:[e.jsx("div",{className:"text-xs text-yellow-600",children:"Fat"}),e.jsxs("div",{className:"font-bold text-yellow-800",children:[j.nutritionalInfo?.fat||0,"g"]})]})]}),j.healthScore&&e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{children:"Health Score"}),e.jsxs("span",{children:[j.healthScore,"/100"]})]}),e.jsx(we,{value:j.healthScore,className:"h-2 bg-gray-200"})]}),d[f]&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Confidence:"}),e.jsxs("span",{className:"font-medium ml-2",children:[(j.confidence*100).toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Category:"}),e.jsx("span",{className:"font-medium ml-2",children:j.category||"Unknown"})]})]})})]},f))}),s.analysisMetadata&&e.jsx("div",{className:"mt-6 p-4 bg-white/10 rounded-lg",children:e.jsxs("div",{className:"text-sm text-gray-300",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Processing Time:"}),e.jsxs("span",{children:[s.analysisMetadata.processingTime,"ms"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Model Version:"}),e.jsx("span",{children:s.analysisMetadata.modelVersion})]})]})}),e.jsx("div",{className:"mt-6",children:e.jsx(v,{onClick:t,className:"w-full",children:"Done"})})]})})]}):e.jsxs("div",{className:"fixed inset-0 bg-black z-50 p-4 flex flex-col",children:[e.jsx("button",{onClick:t,className:"absolute top-4 left-4 text-white bg-black/50 rounded-full p-2 z-10",children:e.jsx($s,{className:"h-6 w-6"})}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-white text-center",children:[e.jsx("p",{children:"No results available"}),e.jsx(v,{onClick:t,className:"mt-4",children:"Back"})]})})]})}function Qn({onCapture:s,onClose:t,isAnalyzing:a}){const{webcamRef:r,capturedImage:i,error:l,captureImage:n,resetImage:d}=mr(),[u,p]=x.useState(!1),[o,h]=x.useState(null),[j,f]=x.useState(!1),[k,c]=x.useState([]),[R,D]=x.useState(!1),[S,q]=x.useState(null),T={width:1280,height:720,facingMode:"environment"};x.useEffect(()=>{!a&&i&&(j?(c([...k,i]),d()):t())},[a,i,t]);const m=async()=>{if(j&&k.length>0||!j&&i)try{D(!0);const A=i||k[0];if(!A||!A.startsWith("data:image/"))throw new Error("Invalid image data format");if(!A.includes("data:image/jpeg")&&!A.includes("data:image/png"))throw new Error("Unsupported image format. Please use JPEG or PNG images.");const _=j?"/api/user/enhanced-food-recognition/analyze-multi":"/api/user/enhanced-food-recognition/analyze-single",Q={enablePortionEstimation:!0,enable3DEstimation:!1,confidenceThreshold:.7,referenceObjects:["hand","credit_card","smartphone"],restaurantMode:!1},ie=await ke("POST",`${_s}${_}`,{imageData:A,options:Q});if(!ie.ok){const z=await ie.json().catch(()=>({}));throw new Error(z.error||"Failed to analyze image")}const ge=await ie.json(),ne=ge.success?ge.data:ge;if(j){const M={foods:Array.isArray(ne.foods)?ne.foods:Array.isArray(ne)?ne:[ne],analysisMetadata:ne.analysisMetadata};q(M)}else{const z=ne.data||ne,M={foodName:z.foodName,nutritionalInfo:z.nutritionalInfo,portionSize:z.portionSize,analysisMetadata:ne.analysisMetadata};q(M)}}catch(A){console.error("Enhanced food analysis failed:",A);let _="Analysis failed";A instanceof Error&&(A.message.includes("Invalid image data format")?_="Invalid image format. Please try capturing the image again.":A.message.includes("Unsupported image format")?_="Unsupported image format. Please use JPEG or PNG images.":A.message.includes("Failed to fetch")?_="Network error. Please check your connection and try again.":_=A.message),s({error:_,fallbackData:k.length>0?k:i||null})}finally{D(!1)}},N=()=>{j||c([]),f(!j),d()},F=()=>{q(null),d(),c([])};return S?e.jsx(Jn,{results:S,onBack:F}):e.jsx("div",{className:"fixed inset-0 bg-black z-50",children:e.jsxs("div",{className:"relative h-full",children:[i?e.jsx("div",{className:"h-full w-full",children:e.jsx("img",{src:i,alt:"Captured meal",className:"h-full w-full object-cover"})}):e.jsxs(e.Fragment,{children:[e.jsx(Or,{audio:!1,ref:r,screenshotFormat:"image/jpeg",videoConstraints:T,className:"h-full w-full object-cover",onUserMedia:()=>{p(!0)},onUserMediaError:A=>{console.error("Camera error:",A),h(typeof A=="string"?A:"Failed to access camera")}}),(l||o)&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-80",children:e.jsxs("div",{className:"text-white text-center p-4",children:[e.jsx("p",{className:"mb-4",children:l||o}),e.jsx(v,{variant:"default",onClick:t,children:"Close"})]})})]}),e.jsxs("div",{className:"camera-overlay",children:[a&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center z-10",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-xl text-center max-w-sm",children:[e.jsx(Ue,{className:"h-12 w-12 text-primary-600 animate-spin mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-neutral-800 mb-2",children:"Analyzing Your Meal"}),e.jsx("p",{className:"text-neutral-600 mb-4",children:"Our AI is working on identifying your food and calculating nutritional information."}),e.jsx("div",{className:"w-full h-2 bg-neutral-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary-500 animate-pulse rounded-full"})})]})}),e.jsxs("div",{className:"flex justify-between w-full px-6 mb-4",children:[e.jsx(v,{variant:"secondary",size:"lg",className:"rounded-full bg-white shadow-lg h-14 w-14 flex items-center justify-center",onClick:t,disabled:a,children:e.jsx($s,{className:"h-7 w-7 text-neutral-900"})}),i?e.jsx(v,{variant:"default",size:"lg",className:"rounded-full bg-primary-600 shadow-lg h-16 w-16 flex items-center justify-center",onClick:m,disabled:a,children:a?e.jsx(Ue,{className:"h-8 w-8 text-white animate-spin"}):e.jsx(Os,{className:"h-8 w-8 text-white"})}):e.jsx(v,{variant:"default",size:"lg",className:"rounded-full bg-primary-600 shadow-lg h-16 w-16 flex items-center justify-center",onClick:n,disabled:!u||a,children:e.jsx(lt,{className:"h-8 w-8 text-white"})}),e.jsx(v,{variant:j?"default":"secondary",size:"lg",className:"rounded-full bg-white shadow-lg h-14 w-14 flex items-center justify-center",onClick:N,disabled:a,children:j?e.jsx("span",{className:"text-lg font-bold",children:"+"}):e.jsx("span",{className:"text-lg font-bold",children:"1"})})]}),e.jsx("div",{className:"text-center text-white text-base font-medium mb-4 px-6 py-2 bg-black bg-opacity-40 rounded-full",children:a?"Analyzing your meal...":j?`Captured ${k.length} items. Add more or finish.`:"Position your meal in the frame"})]})]})})}const G=x.forwardRef(({className:s,...t},a)=>e.jsx(Pa,{className:L("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...t,ref:a,children:e.jsx(Ur,{className:L("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));G.displayName=Pa.displayName;function Xn(){const{toast:s}=ve(),t=x.useRef(null),[a,r]=x.useState(null),[i,l]=x.useState(!1),[n,d]=x.useState(null),{isOpen:u,capturedImage:p,openCamera:o,closeCamera:h}=mr(),j=J({mutationFn:async q=>(await ke("POST","/api/analyze-food",{imageData:q})).json(),onSuccess:q=>{sr.invalidateQueries({queryKey:["/api/meal-analyses"]}),s({title:"Analysis complete!",description:`Detected ${q.foodName} with ${q.estimatedCalories} calories.`}),r(null)},onError:q=>{s({title:"Analysis failed",description:q.message,variant:"destructive"})}}),f=q=>{const T=q.target.files?.[0];if(!T)return;const m=new FileReader;m.onload=N=>{const F=N.target?.result;r(F)},m.readAsDataURL(T)},k=()=>{t.current?.click()},c=()=>{!a&&!p||(d(null),i?R(a||p):j.mutate(a||p))},R=async q=>{try{const m=await(await ke("POST","/api/analyze-multi-food",{imageData:q})).json();d(m),s({title:"Multi-Food Analysis complete!",description:`Detected ${m.foods.length} foods in the image.`}),r(null)}catch(T){s({title:"Multi-Food Analysis failed",description:T.message,variant:"destructive"})}},D=()=>{r(null),t.current&&(t.current.value="")},S=j.isPending;return x.useEffect(()=>{u&&p&&r(p),!u&&a===p&&r(null)},[u,p]),e.jsxs(e.Fragment,{children:[e.jsxs(g,{className:"card-gradient hover-effect rounded-xl shadow-sm border border-neutral-200 overflow-hidden",children:[e.jsxs(b,{className:"px-6 py-5 border-b border-neutral-200 flex flex-col gap-2",children:[e.jsx(w,{className:"text-xl font-semibold text-neutral-800",children:"Scan Your Meal"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{checked:i,onCheckedChange:l,id:"multi-food-switch"}),e.jsx("label",{htmlFor:"multi-food-switch",className:"text-sm text-neutral-500 cursor-pointer",children:"Multi-Food Recognition"})]})]}),e.jsxs(y,{className:"p-6",children:[e.jsxs("div",{className:"relative bg-neutral-100 rounded-lg overflow-hidden",style:{minHeight:"300px"},children:[a?e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("img",{src:a,alt:"Uploaded meal",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center p-4 space-y-4",children:[e.jsx(v,{onClick:c,disabled:S,className:"border border-neutral-100 bg-primary-600 hover:bg-primary-700 text-white font-medium px-6 py-2 h-12 text-base",children:S?e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"h-5 w-5 mr-2 animate-spin"}),"Analyzing..."]}):"Analyze Image"}),e.jsx(v,{variant:"secondary",onClick:D,disabled:S,className:"font-medium",children:"Cancel"}),S&&e.jsxs("div",{className:"mt-2 text-white text-center",children:[e.jsx("p",{className:"mb-2",children:"AI is analyzing your meal"}),e.jsx("div",{className:"w-48 h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary-500 animate-pulse rounded-full"})})]})]})})]}):e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-6 text-center",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 text-neutral-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("p",{className:"text-neutral-600 font-medium mb-2",children:"Take a photo or upload an image of your meal"}),e.jsx("p",{className:"text-neutral-500 text-sm",children:"Supported formats: JPG, PNG"})]}),e.jsxs("div",{className:"absolute bottom-0 inset-x-0 p-6 flex justify-center space-x-4",children:[e.jsxs(v,{onClick:k,variant:"outline",className:"inline-flex items-center px-4 py-2.5 border border-neutral-300 shadow-sm text-sm font-medium rounded-md text-neutral-700 bg-white hover:bg-neutral-50",disabled:S,children:[e.jsx(ct,{className:"h-5 w-5 mr-2 text-neutral-500"}),"Upload Photo"]}),e.jsxs(v,{onClick:o,className:"inline-flex items-center px-4 py-2.5 border border-transparent text-sm font-medium rounded-md shadow-sm bg-primary hover:bg-primary-700",disabled:S,children:[e.jsx(lt,{className:"h-5 w-5 mr-2"}),"Take Photo"]}),e.jsx("input",{type:"file",ref:t,onChange:f,accept:"image/jpeg, image/png",className:"hidden"})]})]}),n&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Detected Foods"}),e.jsx("ul",{className:"divide-y divide-neutral-200",children:n.foods.map((q,T)=>e.jsxs("li",{className:"py-3",children:[e.jsx("div",{className:"font-medium text-neutral-900",children:q.foodName}),e.jsxs("div",{className:"text-sm text-neutral-600 flex gap-4",children:[e.jsxs("span",{children:["Calories: ",q.calories]}),e.jsxs("span",{children:["Protein: ",q.protein,"g"]}),e.jsxs("span",{children:["Carbs: ",q.carbs,"g"]}),e.jsxs("span",{children:["Fat: ",q.fat,"g"]}),e.jsxs("span",{children:["Fiber: ",q.fiber,"g"]})]})]},T))})]})]})]}),u&&e.jsx(Qn,{onCapture:()=>{h()},onClose:h,isAnalyzing:S})]})}function Xe({value:s,maxValue:t,color:a}){const r=Math.min(100,Math.max(0,s/t*100));return e.jsx("div",{className:"nutrition-chart",children:e.jsx("div",{className:`nutrition-fill ${a}`,style:{width:`${r}%`}})})}function Zn(){const{data:s,isLoading:t,error:a}=W({queryKey:["/api/meal-analyses"]});return e.jsxs(g,{className:"bg-white rounded-xl shadow-sm border border-neutral-200 overflow-hidden",children:[e.jsxs(b,{className:"px-6 py-5 border-b border-neutral-200 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(w,{className:"text-xl font-semibold text-neutral-800",children:"Recent Results"}),e.jsx("p",{className:"text-neutral-600 text-sm mt-1",children:"Your latest meal analysis"})]}),e.jsx(V,{href:"/history",className:"text-sm font-medium text-primary hover:text-primary-700",children:"View All"})]}),e.jsx(y,{className:"p-0",children:t?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx(Ue,{className:"h-8 w-8 animate-spin text-primary"})}):a?e.jsx("div",{className:"p-6 text-center text-neutral-600",children:e.jsx("p",{children:"Error loading results"})}):s&&s.length>0?e.jsx("div",{className:"divide-y divide-neutral-200",children:s.slice(0,3).map(r=>{const l=(n=>{if(!n)return"/placeholder-food.svg";if(n.startsWith("data:")||n.startsWith("http://")||n.startsWith("https://"))return n;const d=n.replace(/\\/g,"/");return`/api/images/optimized/${d.split("/").pop()||d}`})(r.imageUrl);return e.jsxs("div",{className:"p-6 flex flex-col md:flex-row",children:[e.jsx("div",{className:"flex-shrink-0 w-full md:w-32 h-24 md:h-32 mb-4 md:mb-0 md:mr-6 bg-neutral-200 rounded-lg overflow-hidden relative",children:e.jsx("img",{src:l,alt:r.foodName,className:"w-full h-full object-cover",onError:n=>{const d=n.currentTarget;if(d.dataset.fallbackTried){if(d.dataset.fallbackTried==="1"){d.dataset.fallbackTried="2";const p=(r.imageUrl||"").replace(/\\/g,"/").split("/").pop()||"";if(p){d.src=`/api/images/original/${p}`;return}}}else{d.dataset.fallbackTried="1";const p=(r.imageUrl||"").replace(/\\/g,"/").split("/").pop()||"";if(p){d.src=`/api/images/thumbnail/${p}`;return}}d.src="/placeholder-food.svg"}})}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-neutral-900",children:r.foodName}),e.jsx("p",{className:"text-sm text-neutral-500",children:r.analysisTimestamp?Gi(new Date(r.analysisTimestamp),{addSuffix:!0}):"No date available"})]}),e.jsx("div",{className:"mt-2 md:mt-0 flex items-center bg-primary-50 text-primary-800 py-1 px-3 rounded-full text-sm font-medium",children:e.jsxs("span",{children:[r.estimatedCalories||0," calories"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Protein"}),e.jsxs("span",{className:"text-sm text-neutral-600",children:[parseFloat(r.estimatedProtein||"0"),"g"]})]}),e.jsx(Xe,{value:parseFloat(r.estimatedProtein||"0"),maxValue:50,color:"bg-chart-1"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Carbs"}),e.jsxs("span",{className:"text-sm text-neutral-600",children:[parseFloat(r.estimatedCarbs||"0"),"g"]})]}),e.jsx(Xe,{value:parseFloat(r.estimatedCarbs||"0"),maxValue:100,color:"bg-chart-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Fat"}),e.jsxs("span",{className:"text-sm text-neutral-600",children:[parseFloat(r.estimatedFat||"0"),"g"]})]}),e.jsx(Xe,{value:parseFloat(r.estimatedFat||"0"),maxValue:40,color:"bg-chart-3"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Fiber"}),e.jsx("span",{className:"text-sm text-neutral-600",children:"0g"})]}),e.jsx(Xe,{value:0,maxValue:20,color:"bg-chart-4"})]})]})]})]},r.id)})}):e.jsx("div",{className:"p-6 text-center text-neutral-600",children:e.jsx("p",{children:"No meal analyses yet. Take a photo of your meal to get started!"})})})]})}function el({stats:s,daysOfWeek:t}){if(!s)return e.jsxs(g,{className:"card-gradient glass-effect rounded-xl border border-neutral-800",children:[e.jsx(b,{children:e.jsx(w,{children:"Overview"})}),e.jsx(y,{className:"text-neutral-400 text-center py-8",children:"No stats available."})]});const a=s.caloriesByDay;return e.jsxs(g,{className:"card-gradient glass-effect rounded-xl border border-neutral-800",children:[e.jsx(b,{children:e.jsx(w,{children:"Overview"})}),e.jsxs(y,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-primary-900 to-neutral-900 rounded-xl p-5 shadow-md flex items-center gap-4","aria-label":"Average Daily Calories",tabIndex:0,children:[e.jsx($r,{className:"w-8 h-8 text-primary-200 bg-primary-900 rounded-full p-1 shadow"}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-primary-200 text-sm font-medium mb-1",children:"Avg. Daily Calories"}),e.jsx("span",{className:"text-2xl font-bold text-primary-100","aria-live":"polite",children:s.averageCalories??"--"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-900 to-neutral-900 rounded-xl p-5 shadow-md flex items-center gap-4","aria-label":"Meals Tracked",tabIndex:0,children:[e.jsx(Ps,{className:"w-8 h-8 text-blue-200 bg-blue-900 rounded-full p-1 shadow"}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-blue-200 text-sm font-medium mb-1",children:"Meals Tracked"}),e.jsx("span",{className:"text-2xl font-bold text-blue-100","aria-live":"polite",children:s.mealsTracked??0})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-amber-900 to-neutral-900 rounded-xl p-5 shadow-md flex items-center gap-4","aria-label":"Average Protein",tabIndex:0,children:[e.jsx(Dt,{className:"w-8 h-8 text-amber-200 bg-amber-900 rounded-full p-1 shadow"}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-amber-200 text-sm font-medium mb-1",children:"Protein (avg)"}),e.jsxs("span",{className:"text-2xl font-bold text-amber-100","aria-live":"polite",children:[s.averageProtein??"--","g"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-900 to-neutral-900 rounded-xl p-5 shadow-md flex items-center gap-4","aria-label":"Healthiest Day",tabIndex:0,children:[e.jsx(zr,{className:"w-8 h-8 text-green-200 bg-green-900 rounded-full p-1 shadow"}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-green-200 text-sm font-medium mb-1",children:"Healthiest Day"}),e.jsx("span",{className:"text-2xl font-bold text-green-100","aria-live":"polite",children:s.healthiestDay??"--"})]})]})]}),e.jsx("div",{className:"my-8 border-t border-neutral-800"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-fuchsia-900 to-neutral-900 rounded-xl p-5 shadow flex items-center gap-4","aria-label":"Current Streak",tabIndex:0,children:[e.jsx(Vs,{className:"w-8 h-8 text-fuchsia-200 bg-fuchsia-900 rounded-full p-1 shadow"}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-fuchsia-200 text-sm font-medium mb-1",children:"Current Streak"}),e.jsxs("span",{className:"text-2xl font-bold text-fuchsia-100","aria-live":"polite",children:[(()=>{let r=0;for(let i=t.length-1;i>=0;i--){const l=a?.[t[i]]??0;if(l>=1500&&l<=2200)r++;else break}return r})()," days"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-indigo-900 to-neutral-900 rounded-xl p-5 shadow flex items-center gap-4","aria-label":"Longest Streak",tabIndex:0,children:[e.jsx(Vs,{className:"w-8 h-8 text-indigo-200 bg-indigo-900 rounded-full p-1 shadow"}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-indigo-200 text-sm font-medium mb-1",children:"Longest Streak"}),e.jsxs("span",{className:"text-2xl font-bold text-indigo-100","aria-live":"polite",children:[(()=>{let r=0,i=0;for(let l=0;l<t.length;l++){const n=a?.[t[l]]??0;n>=1500&&n<=2200?(r++,i=Math.max(i,r)):r=0}return i})()," days"]})]})]})]}),e.jsx("div",{className:"my-8 border-t border-neutral-800"}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ps,{className:"w-5 h-5 text-primary-200"}),e.jsx("h3",{className:"font-medium text-primary-100",children:"Weekly Calorie Goal Progress"})]}),e.jsx("div",{className:"w-full bg-neutral-800 rounded-full h-4 overflow-hidden",children:(()=>{const i=Object.values(a??{}).reduce((n,d)=>n+d,0),l=Math.min(100,Math.round(i/14e3*100));return e.jsx("div",{className:"h-4 bg-gradient-to-r from-primary-400 to-primary-700 rounded-full transition-all duration-500",style:{width:`${l}%`},"aria-label":`Weekly calorie goal progress: ${l}%`})})()}),e.jsxs("div",{className:"flex justify-between text-xs mt-1 text-neutral-400",children:[e.jsxs("span",{children:["Consumed: ",Object.values(a??{}).reduce((r,i)=>r+i,0)," kcal"]}),e.jsx("span",{children:"Goal: 14000 kcal"})]})]})]})]})}const sl={light:"",dark:".dark"},xr=x.createContext(null);function hr(){const s=x.useContext(xr);if(!s)throw new Error("useChart must be used within a <ChartContainer />");return s}const Lt=x.forwardRef(({id:s,className:t,children:a,config:r,...i},l)=>{const n=x.useId(),d=`chart-${s||n.replace(/:/g,"")}`;return e.jsx(xr.Provider,{value:{config:r},children:e.jsxs("div",{"data-chart":d,ref:l,className:L("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",t),...i,children:[e.jsx(tl,{id:d,config:r}),e.jsx(Ce,{children:a})]})})});Lt.displayName="Chart";const tl=({id:s,config:t})=>{const a=Object.entries(t).filter(([,r])=>r.theme||r.color);return a.length?e.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(sl).map(([r,i])=>`
${i} [data-chart=${s}] {
${a.map(([l,n])=>{const d=n.theme?.[r]||n.color;return d?`  --color-${l}: ${d};`:null}).join(`
`)}
}
`).join(`
`)}}):null},al=x.forwardRef(({active:s,payload:t,className:a,indicator:r="dot",hideLabel:i=!1,hideIndicator:l=!1,label:n,labelFormatter:d,labelClassName:u,formatter:p,color:o,nameKey:h,labelKey:j},f)=>{const{config:k}=hr(),c=x.useMemo(()=>{if(i||!t?.length)return null;const[D]=t,S=`${j||D?.dataKey||D?.name||"value"}`,q=Jt(k,D,S),T=!j&&typeof n=="string"?k[n]?.label||n:q?.label;return d?e.jsx("div",{className:L("font-medium",u),children:d(T,t)}):T?e.jsx("div",{className:L("font-medium",u),children:T}):null},[n,d,t,i,u,k,j]);if(!s||!t?.length)return null;const R=t.length===1&&r!=="dot";return e.jsxs("div",{ref:f,className:L("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",a),children:[R?null:c,e.jsx("div",{className:"grid gap-1.5",children:t.map((D,S)=>{const q=`${h||D.name||D.dataKey||"value"}`,T=Jt(k,D,q),m=o||D.payload.fill||D.color;return e.jsx("div",{className:L("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",r==="dot"&&"items-center"),children:p&&D?.value!==void 0&&D.name?p(D.value,D.name,D,S,D.payload):e.jsxs(e.Fragment,{children:[T?.icon?e.jsx(T.icon,{}):!l&&e.jsx("div",{className:L("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":r==="dot","w-1":r==="line","w-0 border-[1.5px] border-dashed bg-transparent":r==="dashed","my-0.5":R&&r==="dashed"}),style:{"--color-bg":m,"--color-border":m}}),e.jsxs("div",{className:L("flex flex-1 justify-between leading-none",R?"items-end":"items-center"),children:[e.jsxs("div",{className:"grid gap-1.5",children:[R?c:null,e.jsx("span",{className:"text-muted-foreground",children:T?.label||D.name})]}),D.value&&e.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:D.value.toLocaleString()})]})]})},D.dataKey)})})]})});al.displayName="ChartTooltip";const rl=x.forwardRef(({className:s,hideIcon:t=!1,payload:a,verticalAlign:r="bottom",nameKey:i},l)=>{const{config:n}=hr();return a?.length?e.jsx("div",{ref:l,className:L("flex items-center justify-center gap-4",r==="top"?"pb-3":"pt-3",s),children:a.map(d=>{const u=`${i||d.dataKey||"value"}`,p=Jt(n,d,u);return e.jsxs("div",{className:L("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[p?.icon&&!t?e.jsx(p.icon,{}):e.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:d.color}}),p?.label]},d.value)})}):null});rl.displayName="ChartLegend";function Jt(s,t,a){if(typeof t!="object"||t===null)return;const r="payload"in t&&typeof t.payload=="object"&&t.payload!==null?t.payload:void 0;let i=a;return a in t&&typeof t[a]=="string"?i=t[a]:r&&a in r&&typeof r[a]=="string"&&(i=r[a]),i in s?s[i]:s[a]}const ya=[{value:"none",label:"None"},{value:"diabetes",label:"Diabetes"},{value:"hypertension",label:"Hypertension"},{value:"kidney",label:"Kidney Disease"},{value:"celiac",label:"Celiac Disease"}];function il({stats:s,daysOfWeek:t,selectedCondition:a,onConditionChange:r}){if(!s)return null;const i=s.macrosByDay??{};return e.jsxs(g,{className:"card-gradient glass-effect rounded-xl border border-neutral-800",children:[e.jsxs(b,{className:"flex flex-col gap-2",children:[e.jsx(w,{children:"Analytics"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{htmlFor:"medical-condition-select",className:"text-xs text-neutral-400",children:"Medical Diet:"}),e.jsx("select",{id:"medical-condition-select",className:"rounded px-2 py-1 text-xs bg-neutral-900 text-neutral-100 border border-neutral-700",value:a,onChange:l=>r(l.target.value),children:ya.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))}),a!=="none"&&e.jsxs("span",{className:"ml-2 px-2 py-0.5 rounded bg-emerald-800 text-emerald-100 text-xs font-semibold",children:[ya.find(l=>l.value===a)?.label," Mode"]})]})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Ps,{className:"w-5 h-5 text-primary-500"}),e.jsx("h3",{className:"font-medium text-neutral-900",children:"Calorie Trend"})]}),a!=="none"&&e.jsxs("div",{className:"mb-2 p-2 rounded bg-emerald-900/60 text-emerald-200 text-xs",children:[a==="diabetes"&&e.jsx(e.Fragment,{children:"Diabetes Mode: Carbohydrate intake and glycemic load are highlighted. Try to keep carbs consistent and avoid high-sugar spikes."}),a==="hypertension"&&e.jsx(e.Fragment,{children:"Hypertension Mode: Sodium and potassium balance are prioritized. Watch for high-sodium foods and aim for more potassium-rich meals."}),a==="kidney"&&e.jsx(e.Fragment,{children:"Kidney Disease Mode: Protein, sodium, and potassium are carefully balanced. Avoid excess protein and high-potassium foods."}),a==="celiac"&&e.jsx(e.Fragment,{children:"Celiac Disease Mode: Gluten-containing foods are flagged. Ensure all meals are gluten-free."})]}),e.jsx("div",{className:"h-48 bg-gradient-to-br from-neutral-900 to-neutral-800 rounded-lg flex items-end justify-between p-4 shadow-inner",children:t.map(l=>{const n=s.caloriesByDay[l]||0,d=Math.max(...Object.values(s.caloriesByDay)),u=d>0?n/d*100:0,p=new Date().getDay(),h=t.indexOf(l)<=p;let j=h?"bg-primary-400 w-full rounded-t-sm":"bg-primary-900 w-full rounded-t-sm";return a==="diabetes"&&(i[l]?.carbs||0)>60&&(j+=" ring-2 ring-amber-400"),a==="kidney"&&(i[l]?.protein||0)>60&&(j+=" ring-2 ring-red-400"),e.jsxs("div",{className:"w-1/7 flex flex-col items-center",children:[e.jsx("div",{className:j,style:{height:`${u}%`},"aria-label":`Calories for ${l}: ${n}`}),e.jsx("span",{className:`text-xs mt-2 ${h?"text-neutral-100":"text-neutral-500"}`,children:l.substring(0,3)})]},l)})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Ps,{className:"w-5 h-5 text-primary-200"}),e.jsx("h3",{className:"font-medium text-primary-100",children:"Weekly Nutrition Breakdown"})]}),e.jsx("div",{className:"h-64 bg-gradient-to-br from-neutral-900 to-neutral-800 rounded-lg p-4 shadow-inner",children:e.jsx(Lt,{config:{calories:{label:"Calories",color:"#4CAF50"}},children:e.jsx(Ce,{width:"100%",height:"100%",children:e.jsxs(is,{data:t.map(l=>{const n=i[l]||{protein:0,carbs:0};let d=s.caloriesByDay[l]||0,u=n.carbs,p=n.protein,o=!1;return a==="diabetes"&&u>60&&(o=!0),a==="kidney"&&p>60&&(o=!0),{day:l.substring(0,3),calories:d,clinicalFlag:o}}),margin:{top:10,right:20,left:0,bottom:0},children:[e.jsx(Pe,{dataKey:"day",stroke:"#b5e3b6"}),e.jsx(Ie,{stroke:"#b5e3b6"}),e.jsx(Re,{contentStyle:{background:"#23272b",border:"1px solid #333",color:"#fff"}}),e.jsx(Fs,{}),e.jsx(je,{type:"monotone",dataKey:"calories",stroke:"#4CAF50",strokeWidth:2,dot:!1},"calories"),e.jsx(je,{type:"monotone",dataKey:"calories",stroke:"transparent",dot:l=>{if(!l||typeof l.cx!="number"||typeof l.cy!="number"||!l.payload)return e.jsx(e.Fragment,{});const{cx:n,cy:d,payload:u}=l;return u.clinicalFlag?e.jsx("circle",{cx:n,cy:d,r:7,fill:"#fbbf24",stroke:"#b45309",strokeWidth:2,style:{filter:"drop-shadow(0 0 4px #fbbf24)"},children:e.jsx("title",{children:"Clinical Alert: This day exceeds recommended limits for your selected condition."})},l.payload.day):e.jsx(e.Fragment,{})}},"clinical-calories")]})})})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Dt,{className:"w-5 h-5 text-amber-200"}),e.jsx("h3",{className:"font-medium text-amber-500",children:"Macro Distribution"})]}),e.jsx("div",{className:"h-56 bg-gradient-to-br from-neutral-900 to-neutral-800 rounded-lg p-4 flex items-center justify-center shadow-inner",children:e.jsx(Ce,{width:"100%",height:"100%",children:e.jsxs(is,{data:t.map(l=>{const n=i[l]||{protein:0,carbs:0,fat:0};let d=!1;return a==="diabetes"&&n.carbs>60&&(d=!0),a==="kidney"&&n.protein>60&&(d=!0),{name:l.substring(0,3),Protein:n.protein,Carbs:n.carbs,Fat:n.fat,clinicalMacroFlag:d}}),children:[e.jsx(Pe,{dataKey:"name"}),e.jsx(Ie,{}),e.jsx(Re,{contentStyle:{background:"#23272b",border:"1px solid #333",color:"#fff"}}),e.jsx(Fs,{}),e.jsx(je,{type:"monotone",dataKey:"Protein",stroke:"#a78bfa",strokeWidth:2,dot:!0},"protein"),e.jsx(je,{type:"monotone",dataKey:"Carbs",stroke:"#2dd4bf",strokeWidth:2,dot:!0},"carbs"),e.jsx(je,{type:"monotone",dataKey:"Fat",stroke:"#fbbf24",strokeWidth:2,dot:!0},"fat"),e.jsx(je,{type:"monotone",dataKey:"Protein",stroke:"transparent",dot:l=>{if(!l||typeof l.cx!="number"||typeof l.cy!="number"||!l.payload)return e.jsx(e.Fragment,{});const{cx:n,cy:d,payload:u}=l;return u.clinicalMacroFlag?e.jsx("circle",{cx:n,cy:d,r:7,fill:"#fbbf24",stroke:"#b45309",strokeWidth:2,style:{filter:"drop-shadow(0 0 4px #fbbf24)"},children:e.jsx("title",{children:"Clinical Alert: This day exceeds recommended macro limits for your selected condition."})},l.payload.name):e.jsx(e.Fragment,{})}},"clinical-macro")]})})}),e.jsx("div",{className:"mt-4 text-sm text-neutral-600 text-center",children:(()=>{let l=0,n=0,d=0;for(const o of t){const h=i[o]||{protein:0,carbs:0,fat:0};l+=h.protein,n+=h.carbs,d+=h.fat}const u=l+n+d,p=o=>u>0?Math.round(o/u*100):0;return e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"mr-4",children:["Protein: ",e.jsxs("span",{className:"text-amber-600 font-semibold",children:[l,"g"]})," (",p(l),"%)"]}),e.jsxs("span",{className:"mr-4",children:["Carbs: ",e.jsxs("span",{className:"text-teal-600 font-semibold",children:[n,"g"]})," (",p(n),"%)"]}),e.jsxs("span",{children:["Fat: ",e.jsxs("span",{className:"text-yellow-600 font-semibold",children:[d,"g"]})," (",p(d),"%)"]})]})})()})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Ps,{className:"w-5 h-5 text-primary-200"}),e.jsx("h3",{className:"font-medium text-primary-100",children:"Macro Consistency"})]}),e.jsx("div",{className:"h-56 bg-gradient-to-br from-neutral-900 to-neutral-800 rounded-lg p-4 flex items-center justify-center shadow-inner",children:e.jsx(Ce,{width:"100%",height:"100%",children:e.jsxs(is,{data:t.map(l=>{const n=i[l]||{protein:0,carbs:0,fat:0},d=n.protein+n.carbs+n.fat;return{name:l.substring(0,3),Protein:d>0?Math.round(n.protein/d*100):0,Carbs:d>0?Math.round(n.carbs/d*100):0,Fat:d>0?Math.round(n.fat/d*100):0}}),children:[e.jsx(Pe,{dataKey:"name"}),e.jsx(Ie,{domain:[0,100],tickFormatter:l=>`${l}%`}),e.jsx(Re,{formatter:l=>`${l}%`,contentStyle:{background:"#23272b",border:"1px solid #333",color:"#fff"}}),e.jsx(Fs,{}),e.jsx(je,{type:"monotone",dataKey:"Protein",stroke:"#a78bfa",strokeWidth:2,dot:!0},"protein-consistency"),e.jsx(je,{type:"monotone",dataKey:"Carbs",stroke:"#2dd4bf",strokeWidth:2,dot:!0},"carbs-consistency"),e.jsx(je,{type:"monotone",dataKey:"Fat",stroke:"#fbbf24",strokeWidth:2,dot:!0},"fat-consistency")]})})}),e.jsx("div",{className:"mt-4 text-sm text-emerald-600 text-center",children:(()=>{let l=t[0],n=-1/0,d=0,u=0;for(const p of t){const o=i[p]||{protein:0,carbs:0,fat:0},h=o.protein+o.carbs+o.fat;if(h===0)continue;const j=o.protein/h,f=o.carbs/h,k=o.fat/h,R=1-(Math.abs(j-.3)+Math.abs(f-.45)+Math.abs(k-.25));d+=R,u++,R>n&&(n=R,l=p)}return d=u>0?Math.round(d/u*100):0,e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"mr-4",children:["Avg. Consistency: ",e.jsxs("span",{className:"font-semibold",children:[d,"%"]})]}),e.jsxs("span",{className:"mr-4",children:["Best Macro Day: ",e.jsx("span",{className:"font-semibold",children:l})]})]})})()})]})]})]})}function nl(){const{data:s,isLoading:t}=W({queryKey:["/api/meal-analyses"]}),a={};(s||[]).forEach(l=>{if(l.analysisTimestamp){const n=rt(new Date(l.analysisTimestamp),"yyyy-MM-dd");a[n]||(a[n]={calories:0,protein:0,carbs:0,fat:0}),a[n].calories+=l.estimatedCalories||0,a[n].protein+=parseFloat(l.estimatedProtein||"0"),a[n].carbs+=parseFloat(l.estimatedCarbs||"0"),a[n].fat+=parseFloat(l.estimatedFat||"0")}});const i=Object.keys(a).sort().map(l=>({date:l,...a[l]}));return e.jsxs(g,{className:"card-gradient hover-effect rounded-xl overflow-hidden",children:[e.jsxs(b,{className:"px-6 py-5 border-b border-neutral-200 flex items-center gap-2",children:[e.jsx(Ht,{className:"h-5 w-5 text-primary-500"}),e.jsx(w,{className:"text-xl font-semibold text-neutral-800",children:"Meal Trends"})]}),e.jsx(y,{className:"p-4",children:t?e.jsx("div",{className:"flex justify-center items-center py-8 text-primary",children:"Loading trends..."}):i.length===0?e.jsx("div",{className:"text-neutral-300 text-center py-8",children:"No meal data to show trends."}):e.jsx("div",{className:"h-64",children:e.jsx(Lt,{config:{calories:{label:"Calories",color:"#4CAF50"},protein:{label:"Protein (g)",color:"#a78bfa"},carbs:{label:"Carbs (g)",color:"#2dd4bf"},fat:{label:"Fat (g)",color:"#fbbf24"}},children:e.jsx(Ce,{width:"100%",height:"100%",children:e.jsxs(is,{data:i.map(l=>({...l,date:rt(new Date(l.date),"MMM d")})),children:[e.jsx(Pe,{dataKey:"date"}),e.jsx(Ie,{}),e.jsx(Re,{contentStyle:{background:"#23272b",border:"1px solid #333",color:"#fff"}}),e.jsx(Fs,{}),e.jsx(je,{type:"monotone",dataKey:"calories",stroke:"#4CAF50",strokeWidth:2,dot:!0}),e.jsx(je,{type:"monotone",dataKey:"protein",stroke:"#a78bfa",strokeWidth:2,dot:!0}),e.jsx(je,{type:"monotone",dataKey:"carbs",stroke:"#2dd4bf",strokeWidth:2,dot:!0}),e.jsx(je,{type:"monotone",dataKey:"fat",stroke:"#fbbf24",strokeWidth:2,dot:!0})]})})})})})]})}function ll(){const{user:s}=Le(),[t,a]=x.useState("none"),{data:r}=W({queryKey:[`/api/weekly-stats?medicalCondition=${t}`],queryFn:cs({on401:"returnNull"})}),i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return s?e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(He,{}),e.jsx("main",{className:"flex-grow",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-neutral-900 mb-2",children:"Dashboard"}),e.jsxs("p",{className:"text-neutral-500",children:["Welcome back, ",s.firstName,". Track your nutrition with AI-powered analysis."]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 flex flex-col gap-6",children:[e.jsx(Xn,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(el,{stats:r,daysOfWeek:i}),e.jsx(il,{stats:r,daysOfWeek:i,selectedCondition:t,onConditionChange:a})]}),e.jsx(Zn,{})]}),e.jsx("div",{className:"flex flex-col gap-6",children:e.jsx(nl,{})})]})]})}),e.jsx(qe,{})]}):e.jsx("div",{children:"Loading..."})}class cl extends x.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null,errorInfo:null},this.handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})},this.handleGoHome=()=>{window.location.href="/"}}static getDerivedStateFromError(t){return{hasError:!0,error:t,errorInfo:null}}componentDidCatch(t,a){console.error("Auth Error Boundary caught an error:",t,a),this.setState({error:t,errorInfo:a})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-neutral-50 p-4",children:e.jsxs(g,{className:"w-full max-w-md",children:[e.jsxs(b,{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(rs,{className:"h-12 w-12 text-destructive"})}),e.jsx(w,{className:"text-xl",children:"Authentication Error"})]}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"text-center text-neutral-600",children:[e.jsx("p",{className:"mb-2",children:"Something went wrong with the authentication process."}),this.state.error&&e.jsx("p",{className:"text-sm font-mono bg-neutral-100 p-2 rounded text-xs",children:this.state.error.message})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(v,{onClick:this.handleReset,className:"w-full",variant:"outline",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Try Again"]}),e.jsxs(v,{onClick:this.handleGoHome,className:"w-full",children:[e.jsx(Ia,{className:"h-4 w-4 mr-2"}),"Go to Home"]})]})]})]})}):this.props.children}}const I=x.forwardRef(({className:s,type:t,...a},r)=>e.jsx("input",{type:t,className:L("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:r,...a}));I.displayName="Input";const ol=ft("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),C=x.forwardRef(({className:s,...t},a)=>e.jsx(Fa,{ref:a,className:L(ol(),s),...t}));C.displayName=Fa.displayName;const Ys=qr,ur=x.createContext({}),he=({...s})=>e.jsx(ur.Provider,{value:{name:s.name},children:e.jsx(Br,{...s})}),Ot=()=>{const s=x.useContext(ur),t=x.useContext(jr),{getFieldState:a,formState:r}=_r(),i=a(s.name,r);if(!s)throw new Error("useFormField should be used within <FormField>");const{id:l}=t;return{id:l,name:s.name,formItemId:`${l}-form-item`,formDescriptionId:`${l}-form-item-description`,formMessageId:`${l}-form-item-message`,...i}},jr=x.createContext({}),ce=x.forwardRef(({className:s,...t},a)=>{const r=x.useId();return e.jsx(jr.Provider,{value:{id:r},children:e.jsx("div",{ref:a,className:L("space-y-2",s),...t})})});ce.displayName="FormItem";const oe=x.forwardRef(({className:s,...t},a)=>{const{error:r,formItemId:i}=Ot();return e.jsx(C,{ref:a,className:L(r&&"text-destructive",s),htmlFor:i,...t})});oe.displayName="FormLabel";const de=x.forwardRef(({...s},t)=>{const{error:a,formItemId:r,formDescriptionId:i,formMessageId:l}=Ot();return e.jsx(Ta,{ref:t,id:r,"aria-describedby":a?`${i} ${l}`:`${i}`,"aria-invalid":!!a,...s})});de.displayName="FormControl";const dl=x.forwardRef(({className:s,...t},a)=>{const{formDescriptionId:r}=Ot();return e.jsx("p",{ref:a,id:r,className:L("text-sm text-muted-foreground",s),...t})});dl.displayName="FormDescription";const me=x.forwardRef(({className:s,children:t,...a},r)=>{const{error:i,formMessageId:l}=Ot(),n=i?String(i?.message??""):t;return n?e.jsx("p",{ref:r,id:l,className:L("text-sm font-medium text-destructive",s),...a,children:n}):null});me.displayName="FormMessage";const ts=x.forwardRef(({className:s,orientation:t="horizontal",decorative:a=!0,...r},i)=>e.jsx(Da,{ref:i,decorative:a,orientation:t,className:L("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",s),...r}));ts.displayName=Da.displayName;const ml=Cs({username:ae().min(1,"Username or email is required"),password:ae().min(1,"Password is required")}),xl=Cs({firstName:ae().min(1,"First name is required"),lastName:ae().min(1,"Last name is required"),email:ae().email("Please enter a valid email address"),username:ae().min(3,"Username must be at least 3 characters"),password:ae().min(8,"Password must be at least 8 characters"),confirmPassword:ae().min(8,"Please confirm your password")}).refine(s=>s.password===s.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]});function hl(){const[s,t]=x.useState("login"),{user:a,loginMutation:r,registerMutation:i}=Le(),l=Hs({resolver:Gs(ml),defaultValues:{username:"",password:""}}),n=Hs({resolver:Gs(xl),defaultValues:{firstName:"",lastName:"",email:"",username:"",password:"",confirmPassword:""},mode:"onChange",reValidateMode:"onChange"}),d=async o=>{try{await r.mutateAsync(o)}catch(h){console.error("Login failed:",h)}},u=async o=>{try{if(!o.firstName||!o.lastName||!o.email||!o.username||!o.password)throw console.error("[REGISTRATION DEBUG] Missing required fields:",{firstName:!!o.firstName,lastName:!!o.lastName,email:!!o.email,username:!!o.username,password:!!o.password}),new Error("All fields are required");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email))throw console.error("[REGISTRATION DEBUG] Invalid email format:",o.email),new Error("Please enter a valid email address");if(o.password.length<8)throw console.error("[REGISTRATION DEBUG] Password too short:",o.password.length),new Error("Password must be at least 8 characters long");if(o.password!==o.confirmPassword)throw console.error("[REGISTRATION DEBUG] Passwords do not match"),new Error("Passwords do not match");const{confirmPassword:j,...f}=o;await i.mutateAsync(o)}catch(h){throw console.error("Registration failed:",h),h}},p=o=>{};return a?e.jsx(aa,{to:"/dashboard"}):e.jsx(cl,{children:e.jsxs("div",{className:"min-h-screen flex flex-col bg-neutral-50",children:[e.jsx(He,{}),e.jsx("div",{className:"w-full md:w-1/2 flex items-center justify-center p-6 md:p-12",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx(ns,{className:"h-10 w-10 text-primary-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-neutral-900",children:"NutriScan"}),e.jsx("p",{className:"text-neutral-600 mt-2",children:"AI-powered calorie estimation"})]}),e.jsxs(g,{children:[e.jsx(b,{className:"pb-4",children:e.jsxs("div",{className:"flex rounded-lg bg-neutral-100 p-1",children:[e.jsx("button",{onClick:()=>t("login"),className:`flex-1 text-sm font-medium py-2 px-3 rounded-md transition-colors ${s==="login"?"bg-white text-neutral-900 shadow-sm":"text-neutral-600 hover:text-neutral-900"}`,children:"Login"}),e.jsx("button",{onClick:()=>t("register"),className:`flex-1 text-sm font-medium py-2 px-3 rounded-md transition-colors ${s==="register"?"bg-white text-neutral-900 shadow-sm":"text-neutral-600 hover:text-neutral-900"}`,children:"Register"})]})}),e.jsx(y,{className:"space-y-4",children:s==="login"?e.jsx(Ys,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(d),className:"space-y-4",children:[e.jsx(he,{control:l.control,name:"username",render:({field:o})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Username or Email"}),e.jsx(de,{children:e.jsx(I,{placeholder:"johndoe or john@example.com",...o})}),e.jsx(me,{})]})}),e.jsx(he,{control:l.control,name:"password",render:({field:o})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Password"}),e.jsx(de,{children:e.jsx(I,{type:"password",placeholder:"Your password",...o})}),e.jsx(me,{})]})}),e.jsx(v,{type:"submit",className:"w-full",disabled:r.isPending,children:r.isPending?"Signing in...":"Sign in"})]})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs(v,{variant:"outline",onClick:()=>p(),className:"w-full flex items-center justify-center gap-3 h-11",disabled:!0,children:[e.jsx(vs,{className:"h-5 w-5 text-red-500"}),"Continue with Google",e.jsx("span",{className:"text-xs text-neutral-400 ml-2",children:"(Coming Soon)"})]}),e.jsxs(v,{variant:"outline",onClick:()=>p(),className:"w-full flex items-center justify-center gap-3 h-11",disabled:!0,children:[e.jsx(Xt,{className:"h-5 w-5"}),"Continue with Apple",e.jsx("span",{className:"text-xs text-neutral-400 ml-2",children:"(Coming Soon)"})]}),e.jsxs("div",{className:"relative my-6",children:[e.jsx(ts,{}),e.jsx("span",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-white px-2 text-xs text-neutral-500",children:"or register with email"})]}),e.jsx(Ys,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(u),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(he,{control:n.control,name:"firstName",render:({field:o})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"First Name"}),e.jsx(de,{children:e.jsx(I,{placeholder:"John",...o})}),e.jsx(me,{})]})}),e.jsx(he,{control:n.control,name:"lastName",render:({field:o})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Last Name"}),e.jsx(de,{children:e.jsx(I,{placeholder:"Doe",...o})}),e.jsx(me,{})]})})]}),e.jsx(he,{control:n.control,name:"email",render:({field:o})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Email"}),e.jsx(de,{children:e.jsx(I,{type:"email",placeholder:"john@example.com",...o})}),e.jsx(me,{})]})}),e.jsx(he,{control:n.control,name:"username",render:({field:o})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Username"}),e.jsx(de,{children:e.jsx(I,{placeholder:"johndoe",...o})}),e.jsx(me,{})]})}),e.jsx(he,{control:n.control,name:"password",render:({field:o})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Password"}),e.jsx(de,{children:e.jsx(I,{type:"password",placeholder:"Create a password",...o})}),e.jsx(me,{})]})}),e.jsx(he,{control:n.control,name:"confirmPassword",render:({field:o})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Confirm Password"}),e.jsx(de,{children:e.jsx(I,{type:"password",placeholder:"Confirm your password",...o})}),e.jsx(me,{})]})}),e.jsx(v,{type:"submit",className:"w-full",disabled:i.isPending||!n.formState.isValid,children:i.isPending?"Creating account...":"Create account"})]})})]})})]}),e.jsx("p",{className:"text-xs text-neutral-500 text-center",children:"By signing in or creating an account, you agree to our Terms of Service and Privacy Policy"})]})}),e.jsx("div",{className:"w-full md:w-1/2 bg-primary-600 text-white p-6 md:p-12 hidden md:flex md:flex-col md:justify-center",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx(Zt,{className:"h-16 w-16 mb-6"}),e.jsx("h2",{className:"text-4xl font-bold mb-4",children:"Track Your Nutrition with AI"}),e.jsx("p",{className:"text-primary-100 text-lg",children:"Simply take a photo of your meal and get instant calorie and nutrition information powered by advanced AI."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"bg-primary-500 rounded-full p-1 mr-4",children:e.jsx(at,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Instant Analysis"}),e.jsx("p",{className:"text-primary-100",children:"Get calorie counts and nutritional breakdown in seconds"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"bg-primary-500 rounded-full p-1 mr-4",children:e.jsx(at,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Track Progress"}),e.jsx("p",{className:"text-primary-100",children:"Monitor your nutrition over time with detailed statistics"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"bg-primary-500 rounded-full p-1 mr-4",children:e.jsx(at,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Smart Recommendations"}),e.jsx("p",{className:"text-primary-100",children:"Receive personalized nutrition tips based on your eating habits"})]})]})]})]})})]})})}function ul(){const{data:s,isLoading:t,error:a}=W({queryKey:["/api/meal-analyses"]}),r=s?.reduce((l,n)=>{if(!n.analysisTimestamp)return console.warn("Meal analysis missing timestamp:",n.id),l;try{const d=rt(new Date(n.analysisTimestamp),"yyyy-MM-dd");l[d]||(l[d]=[]),l[d].push(n)}catch(d){console.error("Invalid timestamp for meal analysis:",n.id,n.analysisTimestamp,d)}return l},{})||{},i=Object.keys(r).sort((l,n)=>new Date(n).getTime()-new Date(l).getTime());return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(He,{}),e.jsx("main",{className:"flex-grow",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-neutral-900 mb-2",children:"Meal History"}),e.jsx("p",{className:"text-neutral-600",children:"View your past meal analyses and nutrition data"})]}),e.jsx(V,{href:"/dashboard",children:e.jsxs(v,{variant:"outline",className:"flex items-center",children:[e.jsx(ea,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]})})]}),t?e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx(Ue,{className:"h-12 w-12 animate-spin text-primary"})}):a?e.jsx(g,{children:e.jsx(y,{className:"p-6 text-center",children:e.jsx("p",{className:"text-neutral-600",children:"Error loading meal history"})})}):s&&s.length>0?e.jsx("div",{className:"space-y-8",children:i.map(l=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(ze,{className:"h-5 w-5 text-primary-600 mr-2"}),e.jsx("h2",{className:"text-xl font-semibold text-neutral-800",children:rt(new Date(l),"EEEE, MMMM d, yyyy")})]}),e.jsx("div",{className:"space-y-4",children:r[l].map(n=>e.jsx(g,{className:"overflow-hidden",children:e.jsx(y,{className:"p-0",children:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsx("div",{className:"w-full md:w-48 h-48 bg-neutral-200",children:(()=>{const u=(p=>{if(!p)return"/placeholder-food.svg";if(p.startsWith("data:")||p.startsWith("http://")||p.startsWith("https://"))return p;const o=p.replace(/\\/g,"/");return`/api/images/optimized/${o.split("/").pop()||o}`})(n.imageUrl);return e.jsx("img",{src:u,alt:n.foodName,className:"w-full h-full object-cover",onError:p=>{const o=p.currentTarget;if(o.dataset.fallbackTried){if(o.dataset.fallbackTried==="1"){o.dataset.fallbackTried="2";const j=(n.imageUrl||"").replace(/\\\\/g,"/").split("/").pop()||"";if(j){o.src=`/api/images/original/${j}`;return}}}else{o.dataset.fallbackTried="1";const j=(n.imageUrl||"").replace(/\\\\/g,"/").split("/").pop()||"";if(j){o.src=`/api/images/thumbnail/${j}`;return}}o.src="/placeholder-food.svg"}})})()}),e.jsxs("div",{className:"p-6 flex-grow",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-medium text-neutral-900",children:n.foodName}),e.jsx("p",{className:"text-sm text-neutral-500",children:n.analysisTimestamp?rt(new Date(n.analysisTimestamp),"h:mm a"):"Unknown time"})]}),e.jsx("div",{className:"mt-2 md:mt-0 flex items-center bg-primary-50 text-primary-800 py-1 px-3 rounded-full text-sm font-medium",children:e.jsxs("span",{children:[n.estimatedCalories||0," calories"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Protein"}),e.jsxs("span",{className:"text-sm text-neutral-600",children:[parseFloat(n.estimatedProtein||"0"),"g"]})]}),e.jsx(Xe,{value:parseFloat(n.estimatedProtein||"0"),maxValue:50,color:"bg-chart-1"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Carbs"}),e.jsxs("span",{className:"text-sm text-neutral-600",children:[parseFloat(n.estimatedCarbs||"0"),"g"]})]}),e.jsx(Xe,{value:parseFloat(n.estimatedCarbs||"0"),maxValue:100,color:"bg-chart-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Fat"}),e.jsxs("span",{className:"text-sm text-neutral-600",children:[parseFloat(n.estimatedFat||"0"),"g"]})]}),e.jsx(Xe,{value:parseFloat(n.estimatedFat||"0"),maxValue:40,color:"bg-chart-3"})]})]})]})]})})},n.id))})]},l))}):e.jsx(g,{children:e.jsxs(y,{className:"p-6 text-center py-20",children:[e.jsx("p",{className:"text-neutral-600 mb-4",children:"No meal analyses found"}),e.jsx(V,{href:"/",children:e.jsx(v,{children:"Scan a Meal"})})]})})]})}),e.jsx(qe,{})]})}function jl(){const{user:s}=Le(),[t,a]=x.useState(null),[r,i]=x.useState(!0);x.useEffect(()=>{i(!0),fetch("/api/admin/content/home").then(f=>f.json()).then(f=>{try{a(JSON.parse(f.value))}catch{a(null)}i(!1)}).catch(()=>i(!1))},[]);const l=t?.hero||{title:"Analyze Your Food With AI Technology",subtitle:"Take a photo of your meal and instantly get detailed nutrition information. Track calories, protein, carbs, and more with NutriScan.",image:"https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=800&auto=format&fit=crop&q=80",calories:425},n=t?.features||[{icon:"Camera",title:"Snap a Photo",desc:"Simply take a picture of your meal using our app's camera or upload an existing image."},{icon:"Zap",title:"AI Analysis",desc:"Our advanced AI identifies the food items and calculates nutrition data instantly."},{icon:"LineChart",title:"Track Progress",desc:"View detailed reports, monitor your nutritional intake and track improvement over time."}],d=t?.pricingCta||{title:"Ready to Transform Your Nutrition Tracking?",subtitle:"Choose a plan that works for you and start your nutrition journey today."},u=t?.testimonials||[{name:"Sarah M.",role:"Fitness Coach",avatar:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=100&h=100&fit=crop",quote:"NutriScan has completely changed how I track my clients' nutrition. The AI analysis is incredibly accurate and saves hours of manual logging."},{name:"James K.",role:"Marathon Runner",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100&h=100&fit=crop",quote:"Being able to quickly snap a photo and get nutrition data has helped me optimize my training diet. The protein tracking feature is invaluable."},{name:"Emily R.",role:"Nutrition Student",avatar:"https://images.unsplash.com/photo-1517841905240-472988babdf9?w=100&h=100&fit=crop",quote:"As someone studying nutrition, I'm impressed by the accuracy of the AI analysis. It's extremely helpful for both my studies and personal meal planning."}],p=t?.featureList||[{icon:"CheckCircle",title:"Advanced AI Recognition",desc:"Accurately identifies food items from images"},{icon:"LineChart",title:"Meal History & Trends",desc:"View your meal analysis history and visualize nutrition trends over time."},{icon:"Zap",title:"Smart Meal Suggestions",desc:"Get AI-powered suggestions for healthier meals and recipes based on your goals."},{icon:"Camera",title:"Multi-Food Recognition",desc:"Analyze multiple foods in a single image for comprehensive nutrition info."},{icon:"Shield",title:"Personalized Nutrition Goals",desc:"Set calorie and macro goals, and track your progress automatically."},{icon:"CheckCircle",title:"Allergen & Diet Warnings",desc:"Get instant warnings for allergens or foods outside your dietary preferences."}],o=t?.featureListDesc||{title:"Why Choose NutriScan?",subtitle:"Our platform offers advanced features for both casual users and nutrition professionals"},h=t?.featureListImage||"https://images.unsplash.com/photo-1530021232320-687d8e3dba54?w=800&h=600&fit=crop",j=t?.finalCta||{title:"Start Your Nutrition Journey Today",subtitle:"Join thousands of users who have transformed their relationship with food using NutriScan"};return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx("header",{className:"bg-white/80 backdrop-blur-md sticky top-0 z-50 border-b border-slate-100 shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-primary-500/10 p-2 rounded-xl",children:e.jsx(ns,{className:"h-7 w-7 text-primary-600"})}),e.jsx("span",{className:"ml-3 text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary-600 to-secondary-500",children:"NutriScan"})]}),e.jsxs("nav",{className:"hidden md:flex space-x-8 items-center",children:[e.jsx(V,{href:"/",className:"text-slate-700 hover:text-primary-600 font-medium transition-colors",children:"Home"}),e.jsx(V,{href:"/try-it",className:"text-slate-700 hover:text-primary-600 font-medium transition-colors",children:"Try It Free"}),e.jsx(V,{href:"/pricing",className:"text-slate-700 hover:text-primary-600 font-medium transition-colors",children:"Pricing"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:s?e.jsx(V,{href:"/dashboard",children:e.jsx(v,{size:"sm",className:"bg-primary-600 hover:bg-primary-700 shadow-md hover:shadow-lg transition-all duration-300",children:"Dashboard"})}):e.jsxs(e.Fragment,{children:[e.jsx(V,{href:"/login",className:"hidden sm:block",children:e.jsx(v,{variant:"outline",size:"sm",className:"border-primary-200 text-primary-700 hover:bg-primary-50 transition-all duration-300",children:"Sign In"})}),e.jsx(V,{href:"/login",children:e.jsx(v,{size:"sm",className:"bg-primary-600 hover:bg-primary-700 shadow-md hover:shadow-glow transition-all duration-300",children:"Get Started"})})]})})]})})}),e.jsxs("section",{className:"bg-gradient-to-br from-primary-50 via-white to-secondary-50 py-20 md:py-28 overflow-hidden relative",children:[e.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden z-0 opacity-60",children:[e.jsx("div",{className:"absolute top-1/4 left-1/4 w-64 h-64 bg-primary-200 rounded-full mix-blend-multiply filter blur-3xl animate-pulse-slow"}),e.jsx("div",{className:"absolute bottom-1/3 right-1/4 w-64 h-64 bg-secondary-200 rounded-full mix-blend-multiply filter blur-3xl animate-pulse-slow animation-delay-2000"}),e.jsx("div",{className:"absolute top-2/3 left-1/2 w-64 h-64 bg-accent-200 rounded-full mix-blend-multiply filter blur-3xl animate-pulse-slow animation-delay-4000"})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between",children:[e.jsxs("div",{className:"md:w-1/2 mb-10 md:mb-0",children:[e.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full bg-primary-100 text-primary-700 text-sm font-medium mb-6",children:[e.jsx(js,{className:"h-4 w-4 mr-2"}),"AI-Powered Nutrition Tracking"]}),e.jsx("h1",{className:"text-4xl md:text-5xl xl:text-6xl font-extrabold mb-6 leading-tight",children:e.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-primary-600 to-secondary-500",children:r?"Loading...":l.title})}),e.jsx("p",{className:"text-lg md:text-xl text-slate-600 mb-8 max-w-lg leading-relaxed",children:r?"":l.subtitle}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[e.jsx(V,{href:"/try-it",children:e.jsx(v,{size:"lg",className:"bg-gradient-to-r from-primary-600 to-secondary-500 hover:from-primary-700 hover:to-secondary-600 shadow-lg hover:shadow-glow transition-all duration-300 px-8 text-white",children:"Try It Free"})}),e.jsx(V,{href:"/login",children:e.jsxs(v,{size:"lg",variant:"outline",className:"border-primary-200 text-primary-700 hover:bg-primary-50 transition-all duration-300",children:["Get Started ",e.jsx(zs,{className:"ml-2 h-4 w-4"})]})})]}),e.jsxs("div",{className:"mt-8 flex items-center space-x-4",children:[e.jsxs("div",{className:"flex -space-x-2",children:[e.jsx("img",{src:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=100&h=100&fit=crop",className:"w-8 h-8 rounded-full border-2 border-white",alt:"User"}),e.jsx("img",{src:"https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=100&h=100&fit=crop",className:"w-8 h-8 rounded-full border-2 border-white",alt:"User"}),e.jsx("img",{src:"https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=100&h=100&fit=crop",className:"w-8 h-8 rounded-full border-2 border-white",alt:"User"})]}),e.jsxs("span",{className:"text-sm text-slate-600",children:["Joined by ",e.jsx("span",{className:"font-medium text-slate-900",children:"2,000+"})," users"]})]})]}),e.jsx("div",{className:"md:w-1/2 flex justify-center",children:e.jsxs("div",{className:"relative w-full max-w-lg",children:[e.jsx("div",{className:"absolute -top-6 -left-6 w-32 h-32 bg-primary-200 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-float"}),e.jsx("div",{className:"absolute -bottom-10 -right-10 w-48 h-48 bg-secondary-200 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-float animation-delay-2000"}),e.jsxs("div",{className:"glass-effect rounded-2xl shadow-xl overflow-hidden p-2 relative",children:[e.jsx("img",{src:l.image,alt:"Healthy food plate",className:"w-full h-auto rounded-xl shadow-md"}),e.jsxs("div",{className:"absolute top-4 right-4 glass-effect rounded-xl shadow-lg p-3 border border-white/40",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-700",children:"Calories"}),e.jsx("div",{className:"text-2xl font-bold text-primary-600",children:l.calories})]}),e.jsx("div",{className:"absolute -bottom-3 -left-3 glass-effect rounded-xl shadow-lg p-3 border border-white/40",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-8 bg-primary-500 rounded-full"}),e.jsx("div",{className:"w-2 h-8 bg-secondary-500 rounded-full"}),e.jsx("div",{className:"w-2 h-8 bg-accent-500 rounded-full"}),e.jsxs("div",{className:"ml-1",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-700",children:"Balanced Nutrition"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Protein • Carbs • Fat"})]})]})})]})]})})]})})]}),e.jsxs("section",{className:"py-24 bg-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-white via-primary-50/30 to-white opacity-50 z-0"}),e.jsx("div",{className:"absolute right-0 top-1/4 w-64 h-64 bg-primary-100 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-float"}),e.jsx("div",{className:"absolute left-0 bottom-1/4 w-64 h-64 bg-secondary-100 rounded-full mix-blend-multiply filter blur-3xl opacity-70 animate-float animation-delay-2000"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full bg-primary-100 text-primary-700 text-sm font-medium mb-4",children:[e.jsx(js,{className:"h-4 w-4 mr-2"}),"Simple Process"]}),e.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-6 section-title inline-block",children:e.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-primary-600 to-secondary-500",children:"How NutriScan Works"})}),e.jsx("p",{className:"text-lg text-slate-600 max-w-3xl mx-auto",children:"Our AI-powered platform makes nutrition tracking simple, fast, and accurate"})]}),e.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:n.map((f,k)=>e.jsxs("div",{className:"glass-effect p-8 rounded-2xl card-hover border border-white/40 relative",children:[e.jsx("div",{className:"absolute -top-4 -right-4 w-8 h-8 rounded-full bg-gradient-to-r from-primary-500 to-secondary-500 flex items-center justify-center text-white font-bold text-sm shadow-lg",children:k+1}),e.jsxs("div",{className:"bg-gradient-to-br from-primary-100 to-primary-50 w-16 h-16 rounded-2xl flex items-center justify-center mb-6 shadow-md",children:[f.icon==="Camera"&&e.jsx(lt,{className:"h-8 w-8 text-primary-600"}),f.icon==="Zap"&&e.jsx(Ze,{className:"h-8 w-8 text-primary-600"}),f.icon==="LineChart"&&e.jsx(Ht,{className:"h-8 w-8 text-primary-600"})]}),e.jsx("h3",{className:"text-xl font-bold text-slate-900 mb-3",children:f.title}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:f.desc}),e.jsx("div",{className:"absolute bottom-4 right-4 w-12 h-1 rounded-full bg-gradient-to-r from-primary-300/40 to-secondary-300/40"})]},k))}),e.jsx("div",{className:"mt-16 bg-gradient-to-r from-primary-50 to-secondary-50 p-8 rounded-2xl shadow-lg border border-white/40",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between",children:[e.jsxs("div",{className:"md:w-2/3 mb-6 md:mb-0 md:pr-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-3",children:"Ready to transform your nutrition tracking?"}),e.jsx("p",{className:"text-slate-600",children:"Join thousands of users who have improved their health with our AI-powered nutrition analysis."})]}),e.jsx("div",{children:e.jsx(V,{href:"/try-it",children:e.jsxs(v,{size:"lg",className:"bg-gradient-to-r from-primary-600 to-secondary-500 hover:from-primary-700 hover:to-secondary-600 shadow-lg hover:shadow-glow transition-all duration-300 px-8 text-white",children:["Get Started ",e.jsx(zs,{className:"ml-2 h-4 w-4"})]})})})]})})]})]}),e.jsx("section",{className:"py-24 bg-gradient-to-b from-white to-slate-50",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-gradient-to-br from-primary-600 to-secondary-600 rounded-3xl p-10 md:p-16 overflow-hidden relative shadow-xl",children:[e.jsx("div",{className:"absolute right-0 top-0 w-64 h-64 bg-white/10 rounded-full blur-3xl opacity-70 -mr-20 -mt-20 animate-pulse-slow"}),e.jsx("div",{className:"absolute left-0 bottom-0 w-64 h-64 bg-white/10 rounded-full blur-3xl opacity-60 -ml-20 -mb-20 animate-pulse-slow animation-delay-2000"}),e.jsx("div",{className:"absolute right-1/4 bottom-1/4 w-32 h-32 bg-white/10 rounded-full blur-2xl opacity-40 animate-pulse-slow animation-delay-4000"}),e.jsx("div",{className:"absolute top-8 right-8 w-24 h-24 border-4 border-white/20 rounded-xl rotate-12 opacity-70"}),e.jsx("div",{className:"absolute bottom-8 left-8 w-16 h-16 border-4 border-white/20 rounded-full opacity-70"}),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"text-center max-w-3xl mx-auto",children:[e.jsxs("div",{className:"inline-flex items-center px-4 py-2 rounded-full bg-white/20 text-white text-sm font-medium mb-6 backdrop-blur-sm",children:[e.jsx(Ks,{className:"h-4 w-4 mr-2 text-yellow-300"}),"Premium Features Available"]}),e.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-6 text-white",children:r?"Loading...":d.title}),e.jsx("p",{className:"text-xl mb-10 text-white/90",children:r?"":d.subtitle}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center space-y-4 sm:space-y-0 sm:space-x-6",children:[e.jsx(V,{href:"/pricing",children:e.jsx(v,{size:"lg",className:"bg-white text-primary-700 hover:bg-slate-100 px-8 shadow-lg hover:shadow-xl transition-all duration-300 font-semibold",children:"View Pricing Plans"})}),e.jsx(V,{href:"/try-it",children:e.jsxs(v,{size:"lg",variant:"outline",className:"border-white text-white hover:bg-white/10 px-8 backdrop-blur-sm transition-all duration-300",children:["Try Free Demo ",e.jsx(zs,{className:"ml-2 h-4 w-4"})]})})]}),e.jsxs("div",{className:"mt-10 flex flex-wrap justify-center gap-6 items-center",children:[e.jsxs("div",{className:"flex items-center text-white/80 text-sm",children:[e.jsx(fe,{className:"h-5 w-5 mr-2 text-green-300"}),"No credit card required"]}),e.jsxs("div",{className:"flex items-center text-white/80 text-sm",children:[e.jsx(fe,{className:"h-5 w-5 mr-2 text-green-300"}),"14-day free trial"]}),e.jsxs("div",{className:"flex items-center text-white/80 text-sm",children:[e.jsx(fe,{className:"h-5 w-5 mr-2 text-green-300"}),"Cancel anytime"]})]})]})})]})})}),e.jsxs("section",{className:"py-24 bg-gradient-to-b from-slate-50 to-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute left-0 top-1/4 w-72 h-72 bg-primary-100 rounded-full blur-3xl opacity-60 -ml-20"}),e.jsx("div",{className:"absolute right-0 bottom-1/4 w-72 h-72 bg-secondary-100 rounded-full blur-3xl opacity-60 -mr-20"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsxs("div",{className:"inline-flex items-center px-4 py-2 rounded-full bg-accent-100 text-accent-700 text-sm font-medium mb-6",children:[e.jsx(Ft,{className:"h-4 w-4 mr-2 text-accent-500"}),"What Our Users Say"]}),e.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-6 bg-gradient-to-r from-primary-600 to-secondary-600 text-transparent bg-clip-text",children:"Trusted by thousands of users worldwide"}),e.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"See what people are saying about their experience with NutriScan"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:u.map((f,k)=>e.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-md hover:shadow-lg transition-all duration-300 border border-slate-100",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex items-center mb-1",children:[...Array(5)].map((c,R)=>e.jsx(Ks,{className:"h-5 w-5 text-yellow-400 fill-yellow-400"},R))})}),e.jsxs("p",{className:"text-slate-700 mb-6 italic",children:['"',f.quote,'"']}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-14 rounded-full overflow-hidden mr-4 ring-2 ring-primary-100",children:e.jsx("img",{src:f.avatar||"/placeholder-avatar.png",alt:`${f.name} avatar`,className:"h-full w-full object-cover"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900",children:f.name}),e.jsx("p",{className:"text-sm text-slate-500",children:f.role})]})]})]},k))}),e.jsxs("div",{className:"mt-20 pt-10 border-t border-slate-200",children:[e.jsx("h3",{className:"text-center text-lg font-medium text-slate-700 mb-8",children:"Trusted by health-conscious individuals worldwide"}),e.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-8 md:gap-16 opacity-70",children:[e.jsx("div",{className:"text-slate-400 font-semibold text-xl",children:"FitnessMag"}),e.jsx("div",{className:"text-slate-400 font-semibold text-xl",children:"HealthTech"}),e.jsx("div",{className:"text-slate-400 font-semibold text-xl",children:"NutritionDaily"}),e.jsx("div",{className:"text-slate-400 font-semibold text-xl",children:"WellnessHub"}),e.jsx("div",{className:"text-slate-400 font-semibold text-xl",children:"FitLife"})]})]})]})]}),e.jsx("section",{className:"py-16 bg-neutral-50",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"md:flex items-center",children:[e.jsxs("div",{className:"md:w-1/2 mb-10 md:mb-0",children:[e.jsx("h2",{className:"text-3xl font-bold text-neutral-900 mb-4",children:o.title}),e.jsx("p",{className:"text-lg text-neutral-600 mb-8",children:o.subtitle}),e.jsx("div",{className:"space-y-4",children:p.map((f,k)=>e.jsxs("div",{className:"flex",children:[f.icon==="CheckCircle"&&e.jsx(fe,{className:"h-6 w-6 text-primary-600 mr-3 flex-shrink-0"}),f.icon==="LineChart"&&e.jsx(Ht,{className:"h-6 w-6 text-primary-600 mr-3 flex-shrink-0"}),f.icon==="Zap"&&e.jsx(Ze,{className:"h-6 w-6 text-primary-600 mr-3 flex-shrink-0"}),f.icon==="Camera"&&e.jsx(lt,{className:"h-6 w-6 text-primary-600 mr-3 flex-shrink-0"}),f.icon==="Shield"&&e.jsx(Ee,{className:"h-6 w-6 text-primary-600 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-neutral-900",children:f.title}),e.jsx("p",{className:"text-neutral-600",children:f.desc})]})]},k))})]}),e.jsx("div",{className:"md:w-1/2 md:pl-12",children:e.jsx("div",{className:"bg-white p-1 rounded-xl shadow-lg",children:e.jsx("img",{src:h,alt:"AI-powered nutrition analysis",className:"w-full h-auto rounded-lg shadow-lg"})})})]})})}),e.jsxs("section",{className:"py-32 bg-gradient-to-b from-white to-slate-50 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-primary-100 rounded-full blur-3xl opacity-50"}),e.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-secondary-100 rounded-full blur-3xl opacity-50"}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-64 h-64 bg-accent-100 rounded-full blur-3xl opacity-30"})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative",children:e.jsxs("div",{className:"text-center max-w-3xl mx-auto",children:[e.jsxs("div",{className:"inline-flex items-center px-4 py-2 rounded-full bg-primary-100 text-primary-700 text-sm font-medium mb-6",children:[e.jsx(js,{className:"h-4 w-4 mr-2 text-primary-500"}),"Start Your Journey Today"]}),e.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-6 bg-gradient-to-r from-primary-600 via-secondary-600 to-accent-600 text-transparent bg-clip-text",children:r?"Loading...":j.title}),e.jsx("p",{className:"text-xl mb-10 text-slate-600",children:r?"":j.subtitle}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(V,{href:"/login",children:e.jsxs(v,{size:"lg",className:"px-10 py-7 text-lg font-semibold shadow-lg hover:shadow-xl transition-all duration-300 bg-gradient-to-r from-primary-600 to-secondary-600 hover:from-primary-700 hover:to-secondary-700",children:["Create Free Account ",e.jsx(zs,{className:"ml-2 h-5 w-5"})]})}),e.jsxs("p",{className:"mt-6 text-slate-500 flex items-center",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"No credit card required. Cancel anytime."]})]}),e.jsxs("div",{className:"mt-16 grid grid-cols-2 md:grid-cols-4 gap-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-primary-600",children:"10k+"}),e.jsx("p",{className:"text-slate-500",children:"Active Users"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-primary-600",children:"5M+"}),e.jsx("p",{className:"text-slate-500",children:"Meals Tracked"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-primary-600",children:"98%"}),e.jsx("p",{className:"text-slate-500",children:"Satisfaction"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-primary-600",children:"24/7"}),e.jsx("p",{className:"text-slate-500",children:"Support"})]})]})]})})]}),e.jsxs("footer",{className:"bg-slate-900 text-white pt-20 pb-10 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-primary-900/20 rounded-full blur-3xl opacity-30"}),e.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-secondary-900/20 rounded-full blur-3xl opacity-30"})]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-12 lg:gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"flex items-center mb-6",children:e.jsx("div",{className:"text-2xl font-bold bg-gradient-to-r from-primary-400 to-secondary-400 text-transparent bg-clip-text",children:"AICalorieTracker"})}),e.jsx("p",{className:"text-slate-400 mb-6 max-w-md",children:"AI-powered nutrition tracking for a healthier you. Analyze your meals, track your progress, and achieve your health goals."}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("a",{href:"#",className:"bg-slate-800 p-2 rounded-full text-slate-400 hover:text-white hover:bg-primary-600 transition-colors duration-300",children:[e.jsx("span",{className:"sr-only",children:"Twitter"}),e.jsx(Vr,{className:"h-5 w-5"})]}),e.jsxs("a",{href:"#",className:"bg-slate-800 p-2 rounded-full text-slate-400 hover:text-white hover:bg-primary-600 transition-colors duration-300",children:[e.jsx("span",{className:"sr-only",children:"Facebook"}),e.jsx(Hr,{className:"h-5 w-5"})]}),e.jsxs("a",{href:"#",className:"bg-slate-800 p-2 rounded-full text-slate-400 hover:text-white hover:bg-primary-600 transition-colors duration-300",children:[e.jsx("span",{className:"sr-only",children:"Instagram"}),e.jsx(Kr,{className:"h-5 w-5"})]}),e.jsxs("a",{href:"#",className:"bg-slate-800 p-2 rounded-full text-slate-400 hover:text-white hover:bg-primary-600 transition-colors duration-300",children:[e.jsx("span",{className:"sr-only",children:"GitHub"}),e.jsx(Wr,{className:"h-5 w-5"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-6 text-white",children:"Product"}),e.jsxs("ul",{className:"space-y-4",children:[e.jsx("li",{children:e.jsx(V,{href:"/features",className:"text-slate-400 hover:text-white transition-colors duration-200",children:"Features"})}),e.jsx("li",{children:e.jsx(V,{href:"/pricing",className:"text-slate-400 hover:text-white transition-colors duration-200",children:"Pricing"})}),e.jsx("li",{children:e.jsx(V,{href:"/try-it",className:"text-slate-400 hover:text-white transition-colors duration-200",children:"Try Demo"})}),e.jsx("li",{children:e.jsx(V,{href:"/integrations",className:"text-slate-400 hover:text-white transition-colors duration-200",children:"Integrations"})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-6 text-white",children:"Company"}),e.jsxs("ul",{className:"space-y-4",children:[e.jsx("li",{children:e.jsx(V,{href:"/about",className:"text-slate-400 hover:text-white transition-colors duration-200",children:"About Us"})}),e.jsx("li",{children:e.jsx(V,{href:"/blog",className:"text-slate-400 hover:text-white transition-colors duration-200",children:"Blog"})}),e.jsx("li",{children:e.jsx(V,{href:"/careers",className:"text-slate-400 hover:text-white transition-colors duration-200",children:"Careers"})}),e.jsx("li",{children:e.jsx(V,{href:"/contact",className:"text-slate-400 hover:text-white transition-colors duration-200",children:"Contact"})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-6 text-white",children:"Legal"}),e.jsxs("ul",{className:"space-y-4",children:[e.jsx("li",{children:e.jsx(V,{href:"/privacy",className:"text-slate-400 hover:text-white transition-colors duration-200",children:"Privacy Policy"})}),e.jsx("li",{children:e.jsx(V,{href:"/terms",className:"text-slate-400 hover:text-white transition-colors duration-200",children:"Terms of Service"})}),e.jsx("li",{children:e.jsx(V,{href:"/cookies",className:"text-slate-400 hover:text-white transition-colors duration-200",children:"Cookie Policy"})}),e.jsx("li",{children:e.jsx(V,{href:"/gdpr",className:"text-slate-400 hover:text-white transition-colors duration-200",children:"GDPR"})})]})]})]}),e.jsxs("div",{className:"border-t border-slate-800 mt-16 pt-8 flex flex-col md:flex-row justify-between items-center",children:[e.jsxs("p",{className:"text-slate-500 text-sm",children:["© ",new Date().getFullYear()," AICalorieTracker. All rights reserved."]}),e.jsxs("div",{className:"mt-4 md:mt-0 flex flex-wrap justify-center gap-4 text-sm text-slate-500",children:[e.jsx(V,{href:"/sitemap",className:"hover:text-white transition-colors duration-200",children:"Sitemap"}),e.jsx("span",{children:"·"}),e.jsx(V,{href:"/accessibility",className:"hover:text-white transition-colors duration-200",children:"Accessibility"}),e.jsx("span",{children:"·"}),e.jsx(V,{href:"/help",className:"hover:text-white transition-colors duration-200",children:"Help Center"})]})]}),e.jsx("div",{className:"mt-16 pt-8 border-t border-slate-800",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[e.jsxs("div",{className:"mb-4 md:mb-0",children:[e.jsx("h5",{className:"text-white font-semibold mb-2",children:"Subscribe to our newsletter"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Get the latest updates and nutrition tips"})]}),e.jsxs("div",{className:"flex w-full md:w-auto",children:[e.jsx("input",{type:"email",placeholder:"Enter your email",className:"px-4 py-2 bg-slate-800 text-white rounded-l-md focus:outline-none focus:ring-2 focus:ring-primary-500 w-full md:w-auto"}),e.jsx("button",{className:"bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-r-md transition-colors duration-300",children:"Subscribe"})]})]})})]})]})]})}function pl(){const{user:s}=Le(),{toast:t}=ve(),a=x.useRef(null),[r,i]=x.useState(null),[l,n]=x.useState(null),[d,u]=x.useState(null),[p,o]=x.useState(!0),h=J({mutationFn:async D=>(await ke("POST","/api/demo-analyze",{imageData:D})).json(),onSuccess:D=>{n(D),t({title:"Analysis complete!",description:`Detected ${D.foodName} with ${D.calories} calories.`})},onError:D=>{t({title:"Analysis failed",description:D.message,variant:"destructive"})}});x.useEffect(()=>{o(!0),fetch("/api/admin/content/try-it").then(D=>D.json()).then(D=>{u(D.value),o(!1)}).catch(()=>o(!1))},[]);const j=D=>{const S=D.target.files?.[0];if(!S)return;const q=new FileReader;q.onload=T=>{const m=T.target?.result;i(m)},q.readAsDataURL(S)},f=()=>{a.current?.click()},k=()=>{r&&h.mutate(r)},c=()=>{i(null),n(null),a.current&&(a.current.value="")},R=h.isPending;return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx("header",{className:"bg-white shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ns,{className:"h-8 w-8 text-primary"}),e.jsx("span",{className:"ml-2 text-2xl font-bold text-neutral-800",children:"NutriScan"})]}),e.jsxs("nav",{className:"hidden md:flex space-x-8 items-center",children:[e.jsx(V,{href:"/",className:"text-neutral-700 hover:text-primary-600 font-medium",children:"Home"}),e.jsx(V,{href:"/try-it",className:"text-primary-600 font-medium",children:"Try It Free"}),e.jsx(V,{href:"/pricing",className:"text-neutral-700 hover:text-primary-600 font-medium",children:"Pricing"})]}),e.jsx("div",{className:"flex items-center",children:s?e.jsx(V,{href:"/dashboard",children:e.jsx(v,{size:"sm",className:"bg-primary-600 hover:bg-primary-700",children:"Dashboard"})}):e.jsx(V,{href:"/login",children:e.jsx(v,{size:"sm",className:"bg-primary-600 hover:bg-primary-700",children:"Sign In"})})})]})})}),e.jsxs("main",{className:"flex-grow",children:[e.jsx("section",{className:"bg-gradient-to-b from-primary-50 to-white py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-primary mb-4",children:"Try NutriScan for Free"}),e.jsx("p",{className:"text-lg text-neutral-600 mb-8 max-w-2xl mx-auto",children:"Upload a food image to see how our AI instantly analyzes the nutritional content. No account required!"}),e.jsx("div",{className:"flex justify-center",children:e.jsx(V,{href:"/",children:e.jsxs(v,{variant:"outline",className:"flex items-center space-x-2",children:[e.jsx($s,{className:"h-4 w-4"}),e.jsx("span",{children:"Back to Home"})]})})})]})}),e.jsx("section",{className:"py-12",children:e.jsx("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-12",children:[e.jsx("div",{children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-neutral-200 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-5 border-b border-neutral-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-neutral-800",children:p?"Loading...":d||"Upload a Food Image"}),e.jsx("p",{className:"text-neutral-600 text-sm mt-1",children:p?"":d?null:"Take a photo or select an image of your meal"})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"relative bg-neutral-100 rounded-lg overflow-hidden",style:{minHeight:"300px"},children:[r?e.jsxs("div",{className:"absolute inset-0",children:[e.jsx("img",{src:r,alt:"Uploaded meal",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center p-4 space-y-4",children:[e.jsx(v,{onClick:k,disabled:R,className:"border border-neutral-100 bg-primary-600 hover:bg-primary-700 text-white font-medium px-6 py-2 h-12 text-base",children:R?e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"h-5 w-5 mr-2 animate-spin"}),"Analyzing..."]}):"Analyze Image"}),e.jsx(v,{variant:"secondary",onClick:c,disabled:R,className:"font-medium",children:"Cancel"}),R&&e.jsxs("div",{className:"mt-2 text-white text-center",children:[e.jsx("p",{className:"mb-2",children:"AI is analyzing your meal"}),e.jsx("div",{className:"w-48 h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary-500 animate-pulse rounded-full"})})]})]})})]}):e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-6 text-center",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 text-neutral-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("p",{className:"text-neutral-600 font-medium mb-2",children:"Take a photo or upload an image of your meal"}),e.jsx("p",{className:"text-neutral-500 text-sm",children:"Supported formats: JPG, PNG"})]}),e.jsxs("div",{className:"absolute bottom-0 inset-x-0 p-6 flex justify-center space-x-4",children:[e.jsxs(v,{onClick:f,variant:"outline",className:"inline-flex items-center px-4 py-2.5 border border-neutral-300 shadow-sm text-sm font-medium rounded-md text-neutral-700 bg-white hover:bg-primary",disabled:R,children:[e.jsx(ct,{className:"h-5 w-5 mr-2 text-neutral-500"}),"Upload Photo"]}),e.jsx("input",{type:"file",ref:a,onChange:j,accept:"image/jpeg, image/png",className:"hidden"})]})]}),e.jsxs("div",{className:"mt-4 flex items-center p-3 bg-primary-50 rounded-lg",children:[e.jsx(Ra,{className:"h-5 w-5 text-primary-600 mr-2 flex-shrink-0"}),e.jsxs("p",{className:"text-sm text-neutral-700",children:["This is a demo version with limited features. ",e.jsx(V,{href:"/login",className:"text-primary-600 font-medium",children:"Sign up"})," for full access."]})]})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-neutral-200 overflow-hidden h-full",children:[e.jsxs("div",{className:"px-6 py-5 border-b border-neutral-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-neutral-800",children:"Analysis Results"}),e.jsx("p",{className:"text-neutral-600 text-sm mt-1",children:"See the nutritional breakdown of your meal"})]}),e.jsx("div",{className:"p-6",children:l?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-neutral-900 mb-1",children:l.foodName}),e.jsx("div",{className:"inline-flex items-center bg-primary-50 text-primary-800 py-1 px-3 rounded-full text-sm font-medium",children:e.jsxs("span",{children:[l.calories," calories"]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Protein"}),e.jsxs("span",{className:"text-sm text-neutral-600",children:[l.protein,"g"]})]}),e.jsx(Xe,{value:l.protein,maxValue:50,color:"bg-chart-1"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Carbs"}),e.jsxs("span",{className:"text-sm text-neutral-600",children:[l.carbs,"g"]})]}),e.jsx(Xe,{value:l.carbs,maxValue:100,color:"bg-chart-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Fat"}),e.jsxs("span",{className:"text-sm text-neutral-600",children:[l.fat,"g"]})]}),e.jsx(Xe,{value:l.fat,maxValue:40,color:"bg-chart-3"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Fiber"}),e.jsxs("span",{className:"text-sm text-neutral-600",children:[l.fiber,"g"]})]}),e.jsx(Xe,{value:l.fiber,maxValue:20,color:"bg-chart-4"})]})]}),e.jsxs("div",{className:"mt-8 text-center",children:[e.jsx(V,{href:"/login",children:e.jsx(v,{className:"bg-primary-600 hover:bg-primary-700",children:"Sign Up for Full Access"})}),e.jsx("p",{className:"mt-2 text-sm text-neutral-500",children:"Create an account to save and track your meal history"})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center text-center py-12",children:[e.jsx("div",{className:"bg-neutral-100 rounded-full p-6 mb-4",children:e.jsx(ns,{className:"h-12 w-12 text-neutral-400"})}),e.jsx("h3",{className:"text-lg font-medium text-neutral-900 mb-2",children:"No Analysis Yet"}),e.jsx("p",{className:"text-neutral-600 max-w-sm mb-6",children:'Upload a food image and click "Analyze Image" to see the nutritional information of your meal'}),e.jsx("div",{className:"flex space-x-4",children:e.jsx(V,{href:"/login",children:e.jsx(v,{variant:"outline",children:"Sign Up"})})})]})})]})})]})})}),e.jsx("section",{className:"py-12 bg-neutral-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900 mb-2",children:"Unlock Full Features with a Free Account"}),e.jsx("p",{className:"text-neutral-600 max-w-2xl mx-auto",children:"Sign up to access all the powerful features of NutriScan"})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsx(g,{className:"bg-white",children:e.jsxs(y,{className:"pt-6",children:[e.jsx("div",{className:"bg-primary-100 w-12 h-12 rounded-lg flex items-center justify-center mb-4",children:e.jsx(lt,{className:"h-6 w-6 text-primary-600"})}),e.jsx("h3",{className:"font-semibold text-lg text-neutral-900 mb-2",children:"Save Your History"}),e.jsx("p",{className:"text-neutral-600",children:"Track all your meals over time and monitor your nutritional trends"})]})}),e.jsx(g,{className:"bg-white",children:e.jsxs(y,{className:"pt-6",children:[e.jsx("div",{className:"bg-primary-100 w-12 h-12 rounded-lg flex items-center justify-center mb-4",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-6 w-6 text-primary-600",children:e.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})})}),e.jsx("h3",{className:"font-semibold text-lg text-neutral-900 mb-2",children:"Weekly Statistics"}),e.jsx("p",{className:"text-neutral-600",children:"Get detailed weekly reports with insights about your nutritional intake"})]})}),e.jsx(g,{className:"bg-white",children:e.jsxs(y,{className:"pt-6",children:[e.jsx("div",{className:"bg-primary-100 w-12 h-12 rounded-lg flex items-center justify-center mb-4",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-6 w-6 text-primary-600",children:[e.jsx("path",{d:"M12 2v8L7 5"}),e.jsx("circle",{cx:"12",cy:"14",r:"8"})]})}),e.jsx("h3",{className:"font-semibold text-lg text-neutral-900 mb-2",children:"Smart Recommendations"}),e.jsx("p",{className:"text-neutral-600",children:"Receive personalized nutrition tips based on your eating habits"})]})})]}),e.jsx("div",{className:"text-center mt-10",children:e.jsx(V,{href:"/login",children:e.jsx(v,{size:"lg",className:"bg-primary hover:bg-primary-700 text-primary-100",children:"Create Free Account"})})})]})})]}),e.jsx(qe,{})]})}const Te=Gr,Se=x.forwardRef(({className:s,...t},a)=>e.jsx(Ma,{ref:a,className:L("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...t}));Se.displayName=Ma.displayName;const U=x.forwardRef(({className:s,...t},a)=>e.jsx(La,{ref:a,className:L("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...t}));U.displayName=La.displayName;const $=x.forwardRef(({className:s,...t},a)=>e.jsx(Oa,{ref:a,className:L("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t}));$.displayName=Oa.displayName;function fl(){const{user:s}=Le(),[t,a]=x.useState("monthly"),[r,i]=x.useState(null),[l,n]=x.useState(!0);x.useEffect(()=>{n(!0),fetch("/api/admin/content/pricing").then(u=>u.json()).then(u=>{try{const p=JSON.parse(u.value);i(p)}catch{i({title:u.value||"Simple, Transparent Pricing",subtitle:"Choose the plan that fits your nutrition tracking needs. All plans include our core AI-powered food analysis technology."})}n(!1)}).catch(()=>n(!1))},[]);const d=[{name:"Basic",id:"basic",href:s?"/subscribe?plan=basic":"/login",price:{monthly:"$9.99",yearly:"$99.99",discount:"Save 15%"},description:"Perfect for individuals getting started with nutrition tracking",features:["25 AI food analyses per month","Basic nutrition tracking","Weekly reports","Email support"],featured:!1},{name:"Premium",id:"premium",href:s?"/subscribe?plan=premium":"/login",price:{monthly:"$19.99",yearly:"$199.99",discount:"Save 15%"},description:"Enhanced features for more detailed nutrition tracking",features:["100 AI food analyses per month","Advanced nutrition reporting","Personalized meal suggestions","Weekly & monthly trends","Priority email support"],featured:!0},{name:"Professional",id:"professional",href:s?"/subscribe?plan=professional":"/login",price:{monthly:"$39.99",yearly:"$399.99",discount:"Save 15%"},description:"For nutritionists and fitness professionals",features:["Unlimited AI food analyses","Client management tools","Advanced analytics dashboard","Custom reporting","API access","Dedicated support"],featured:!1}];return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx("header",{className:"bg-white shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center py-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ns,{className:"h-8 w-8 text-primary"}),e.jsx("span",{className:"ml-2 text-2xl font-bold text-neutral-800",children:"NutriScan"})]}),e.jsxs("nav",{className:"hidden md:flex space-x-8 items-center",children:[e.jsx(V,{href:"/",className:"text-neutral-700 hover:text-primary-600 font-medium",children:"Home"}),e.jsx(V,{href:"/try-it",className:"text-neutral-700 hover:text-primary-600 font-medium",children:"Try It Free"}),e.jsx(V,{href:"/pricing",className:"text-primary-600 font-medium",children:"Pricing"})]}),e.jsx("div",{className:"flex items-center",children:s?e.jsx(V,{href:"/dashboard",children:e.jsx(v,{size:"sm",className:"bg-primary-600 hover:bg-primary-700",children:"Dashboard"})}):e.jsx(V,{href:"/login",children:e.jsx(v,{size:"sm",className:"bg-primary-600 hover:bg-primary-700",children:"Sign In"})})})]})})}),e.jsxs("main",{className:"flex-grow",children:[e.jsx("section",{className:"bg-gradient-to-b from-primary-50 to-white py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-primary mb-4",children:l?"Loading...":r?.title||"Simple, Transparent Pricing"}),e.jsx("p",{className:"text-lg text-neutral-600 mb-8 max-w-2xl mx-auto",children:l?"":r?.subtitle||"Choose the plan that fits your nutrition tracking needs. All plans include our core AI-powered food analysis technology."}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Te,{defaultValue:"monthly",className:"w-full max-w-xs",value:t,onValueChange:u=>a(u),children:e.jsxs(Se,{className:"grid w-full grid-cols-2",children:[e.jsx(U,{value:"monthly",children:"Monthly"}),e.jsx(U,{value:"yearly",children:"Yearly"})]})})}),t==="yearly"&&e.jsx("p",{className:"mt-2 text-sm text-primary-600 font-medium",children:"Save up to 15% with yearly billing"})]})}),e.jsx("section",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:d.map(u=>e.jsxs(g,{className:`border ${u.featured?"border-primary-500 ring-1 ring-primary-500":"border-neutral-200"} overflow-hidden`,children:[u.featured&&e.jsx("div",{className:"bg-primary-500 text-white text-xs font-semibold text-center py-1",children:"MOST POPULAR"}),e.jsxs(b,{className:u.featured?"bg-primary-50":"",children:[e.jsx(w,{children:u.name}),e.jsx(ds,{children:u.description})]}),e.jsxs(y,{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("span",{className:"text-4xl font-bold text-neutral",children:t==="monthly"?u.price.monthly:u.price.yearly}),e.jsx("span",{className:"text-neutral-600 ml-2",children:t==="monthly"?"/ month":"/ year"}),t==="yearly"&&e.jsx("span",{className:"block mt-1 text-sm text-primary-600 font-medium",children:u.price.discount})]}),e.jsx("ul",{className:"space-y-3",children:u.features.map((p,o)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx(pt,{className:"h-5 w-5 text-primary-500 mr-3 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-neutral",children:p})]},o))})]}),e.jsx(Ts,{className:"bg-neutral-50 px-6 py-4",children:e.jsx(V,{href:u.href,className:"w-full",children:e.jsx(v,{className:`w-full ${u.featured?"bg-primary hover:bg-gradient-to-b":"hover:bg-primary"}`,variant:u.featured?"default":"outline",children:s?"Subscribe Now":"Create Account"})})})]},u.id))}),e.jsx("div",{className:"mt-12 bg-neutral-50 rounded-xl p-8 md:p-10",children:e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"mb-6 md:mb-0 md:mr-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-neutral-900 mb-2",children:"Enterprise Plan"}),e.jsx("p",{className:"text-neutral-600 max-w-xl",children:"Need a custom solution for your organization? Our enterprise plan includes custom features, dedicated support, and volume pricing."})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(V,{href:"/contact",children:e.jsx(v,{size:"lg",className:"w-full 'bg-primary hover:bg-gradient-to-b",children:"Contact Sales"})})})]})})]})}),e.jsx("section",{className:"py-12 bg-white",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900 mb-3",children:"Secure Payment Methods"}),e.jsx("p",{className:"text-neutral-600 max-w-2xl mx-auto",children:"We support various payment methods to make your subscription process seamless"})]}),e.jsxs("div",{className:"bg-neutral-50 rounded-xl p-8 flex flex-wrap justify-center items-center gap-8 md:gap-12",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(sa,{className:"h-10 w-10 text-neutral-600 mb-2"}),e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Credit Card"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("svg",{viewBox:"0 0 24 24",className:"h-10 w-10 text-[#003087] mb-2",children:e.jsx("path",{fill:"currentColor",d:"M7.07 10.588h2.168c.073 0 .145.01.214.03a.606.606 0 0 1 .442.547.584.584 0 0 1-.189.452.653.653 0 0 1-.442.189c-.073 0-.145-.01-.214-.03H7.07v-.886zm0-1.822h1.745c.067 0 .134.009.197.027a.582.582 0 0 1 .415.544.566.566 0 0 1-.179.442.61.61 0 0 1-.415.174h-1.763v-.914zm3.258 2.995a1.81 1.81 0 0 0 1.24-.459c.34-.308.516-.749.477-1.199a1.657 1.657 0 0 0-.318-.943 1.692 1.692 0 0 0-.836-.595 1.485 1.485 0 0 0 .71-.587c.176-.291.255-.626.228-.96a1.551 1.551 0 0 0-.482-1.17 1.936 1.936 0 0 0-1.369-.448h-3.01v7.188h3.144c.078.002.156.002.234 0l-.018-.827zM20.471 13.44a.656.656 0 0 0-.656-.656H19.5V9.905c0-.363-.293-.657-.656-.657h-.778a.655.655 0 0 0-.614.422l-1.309 3.113-1.307-3.113a.656.656 0 0 0-.615-.422h-.778a.656.656 0 0 0-.656.657v2.88h-.315a.656.656 0 0 0-.657.655v.723h2.072v-.674h.314V10.99l1.483 3.52a.656.656 0 0 0 .607.414h.508c.25.001.482-.136.606-.357l1.484-3.531v2.739h.314v.674h2.072v-.723M3.867 7.38h-.436a.656.656 0 0 0-.58.352L.523 12.67a.656.656 0 0 0 .58.96h.919a.656.656 0 0 0 .58-.351l.414-.92h2.29l.392.92c.1.232.33.382.58.381h.92a.656.656 0 0 0 .58-.96L5.446 7.704a.655.655 0 0 0-.58-.352h-.436V7.38h-.564v.657zm-.142 3.531l.708-1.596.709 1.596H3.725z"})}),e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"PayPal"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("svg",{viewBox:"0 0 24 24",className:"h-10 w-10 text-[#635BFF] mb-2",children:e.jsx("path",{fill:"currentColor",d:"M13.479 9.883c-1.626 0-2.511.706-2.511 1.723 0 .867.788 1.37 2.306 1.37 1.625 0 2.51-.706 2.51-1.723 0-.866-.787-1.37-2.305-1.37zm-2.367-3.021c0 .706.706 1.206 1.934 1.206 1.274 0 1.98-.5 1.98-1.206 0-.753-.706-1.207-1.98-1.207-1.228 0-1.934.454-1.934 1.207zm10.84-4.147c1.166 0 2.118.952 2.118 2.118v14.334c0 1.166-.952 2.118-2.118 2.118H2.118A2.118 2.118 0 0 1 0 19.167V4.833c0-1.166.952-2.118 2.118-2.118zm-1.984 9.649c0-1.192-.972-2.14-2.756-2.14-1.112 0-1.744.252-2.373.57.035-.226.035-.452.035-.652 0-1.031-.813-1.652-2.221-1.652-.917 0-1.465.282-1.809.634.21-.106.35-.331.35-.622 0-.813-.847-1.271-1.991-1.271-.988 0-1.622.317-1.656 1.336a9.756 9.756 0 0 0-2.068.657v5.952h.882v-5.066c.387-.175.829-.35 1.396-.49.07.813.695 1.231 1.795 1.231.493 0 .9-.105 1.221-.282-.035.211-.035.423-.035.617 0 1.336.952 2.085 2.651 2.085.687 0 1.186-.88 1.66-.264-.035.158-.035.334-.035.493 0 1.02.864 1.62 2.221 1.62.864 0 1.465-.193 1.83-.546-.017.123-.017.246-.017.369 0 .759.599 1.248 1.622 1.248.687 0 1.151-.194 1.485-.477v-2.25h-1.133v1.476c-.106.088-.317.158-.582.158-.44 0-.723-.264-.723-.758v-1.09h1.465v-.917h-1.465v-1.477h-.882v1.477h-.971v.917h.97v1.09c0 .265-.52.547-.44.67.318.124.67.195 1.15.195.688 0 1.222-.125 1.729-.37-.035.247-.035.476-.035.706 0 1.302.9 2.049 2.598 2.049.723 0 1.239-.088 1.678-.299v-.916c-.44.228-.952.351-1.57.351-1.133 0-1.65-.44-1.65-1.39v-.37c0-.265.018-.547.07-.847h2.545V12.5h-2.668v-.988h3.164v-.864h-3.164v-.97h2.756v-.847h-2.756v-.881h-.847v.881H14.22v.847h2.545v.97h-3.129v.864h3.13v.988h-2.563c.052-.3.088-.618.088-.934l-.017-.087c-.018.018-.53.018-.88.018-.511 0-.952-.088-1.31-.281a2.063 2.063 0 0 0 1.345-.882h-.9a1.345 1.345 0 0 1-1.099.511c-.952 0-1.55-.53-1.55-1.373 0-.635.369-1.09.971-1.302-.389.123-.744.176-1.046.176-1.222 0-1.925-.583-1.925-1.566 0-.899.6-1.514 1.586-1.674-.387.159-.793.23-1.204.23-1.256 0-2.05-.563-2.05-1.46 0-.778.441-1.307 1.15-1.567h7.5V2.118H2.118v19.764h19.764V4.833c0-.037-.02-.073-.022-.11a2.102 2.102 0 0 0-2.096-2.008h-3.22c-.23.257-.3.64-.3 1.037 0 1.037.723 1.62 2.086 1.62 1.046 0 1.693-.3 2.068-.634-.123.37-.194.758-.194 1.196 0 1.39.899 2.261 2.332 2.261.387 0 .723-.053 1.063-.176l.035-.018z"})}),e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Stripe"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("svg",{viewBox:"0 0 24 24",className:"h-10 w-10 text-[#FFC439] mb-2",children:[e.jsx("rect",{width:"24",height:"24",rx:"4",fill:"currentColor"}),e.jsx("path",{d:"M8.04 7.044H4.638c-.065 0-.13.013-.19.039a.499.499 0 0 0-.272.272.501.501 0 0 0-.39.19v5.212c-.034.224.12.433.344.467.022.003.045.005.067.005h1.91a.466.466 0 0 0 .466-.402l.527-3.35.527 3.35a.466.466 0 0 0 .466.402h1.91a.467.467 0 0 0 .467-.403l1.062-6.742h-1.9a.466.466 0 0 0-.466.402l-.54 3.421-.539-3.42a.466.466 0 0 0-.466-.403M20.323 7.046h-1.909a.466.466 0 0 0-.467.402l-1.063 6.743h1.91a.466.466 0 0 0 .466-.402l1.063-6.743zM16.413 7.044h-1.91c-.24 0-.45.175-.49.412L13.09 13.732a.467.467 0 0 0 .41.518c.027.004.054.005.081.005h1.686c.241 0 .451-.175.49-.413l.307-1.95h1.096c1.695 0 2.673-.82 3.002-2.438.13-.644.005-1.15-.364-1.505-.405-.393-1.122-.594-2.075-.594h-.532l.211-1.315a.466.466 0 0 0-.462-.533c-.9.0018-.18.0036-.27.0054zm.253 2.884l-.193 1.235h-.871l.194-1.235h.87z",fill:"#253B80"})]}),e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Apple Pay"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("svg",{viewBox:"0 0 24 24",className:"h-10 w-10 text-[#4285F4] mb-2",children:[e.jsx("path",{d:"M12 24c6.624 0 12-5.376 12-12S18.624 0 12 0 0 5.376 0 12s5.376 12 12 12z",fill:"#4285F4"}),e.jsx("path",{d:"M12 9.5v3h4.199c-.17 1.15-1.231 3.36-4.199 3.36-2.52 0-4.58-2.09-4.58-4.66 0-2.56 2.06-4.65 4.58-4.65 1.44 0 2.4.61 2.95 1.14l2.01-1.94C15.47 4.36 13.9 3.5 12 3.5c-4.42 0-8 3.58-8 8s3.58 8 8 8c4.62 0 7.69-3.25 7.69-7.82 0-.52-.07-.92-.15-1.33H12z",fill:"#FFF"})]}),e.jsx("span",{className:"text-sm font-medium text-neutral-700",children:"Google Pay"})]})]})]})}),e.jsx("section",{className:"py-12 bg-neutral-50",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900 mb-2",children:"Frequently Asked Questions"}),e.jsx("p",{className:"text-neutral-600",children:"Find answers to common questions about our subscription plans"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-2",children:"Can I change my plan later?"}),e.jsx("p",{className:"text-neutral-600",children:"Yes, you can upgrade or downgrade your plan at any time. Changes to your subscription will be applied at the beginning of your next billing cycle."})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-2",children:"Is there a free trial?"}),e.jsx("p",{className:"text-neutral-600",children:"Yes! You can try our demo version for free with limited features. Additionally, all paid plans come with a 7-day free trial period."})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-2",children:"How does the food analysis count work?"}),e.jsx("p",{className:"text-neutral-600",children:"Each plan includes a specific number of AI food analyses per month. One analysis is counted each time you upload or take a photo of a meal for nutritional analysis."})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900 mb-2",children:"Can I cancel my subscription?"}),e.jsx("p",{className:"text-neutral-600",children:"Yes, you can cancel your subscription at any time. You'll continue to have access to your plan until the end of your current billing period."})]})]}),e.jsxs("div",{className:"mt-10 text-center",children:[e.jsx("p",{className:"text-neutral-600 mb-4",children:"Have more questions? We're here to help."}),e.jsx(V,{href:"/contact",children:e.jsx(v,{children:"Contact Support"})})]})]})})]}),e.jsx(qe,{})]})}function gl(){return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(He,{}),e.jsx("main",{className:"flex-grow bg-gradient-to-b from-neutral-50 to-white",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"py-16 md:py-24 text-center",children:[e.jsxs("h1",{className:"text-4xl md:text-5xl font-bold text-neutral-900 mb-4 tracking-tight",children:["About ",e.jsx("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-primary-500 to-primary-700",children:"NutriScan"})]}),e.jsx("p",{className:"text-lg md:text-xl text-neutral-600 max-w-3xl mx-auto",children:"Revolutionizing nutrition tracking with cutting-edge AI technology"})]}),e.jsx("div",{className:"mb-16 md:mb-24",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-neutral-200 overflow-hidden",children:e.jsxs("div",{className:"p-6 md:p-10",children:[e.jsx("h2",{className:"text-3xl font-bold text-neutral-900 mb-6",children:"Our Story"}),e.jsxs("div",{className:"prose max-w-none text-neutral-700",children:[e.jsx("p",{children:"NutriScan was born from a simple observation: tracking nutrition accurately is too difficult and time-consuming for most people."}),e.jsx("p",{children:"Our founder, a nutrition enthusiast with a background in AI, struggled with traditional food tracking apps that required manual logging and often provided inaccurate nutritional information. The tedious process of searching databases, weighing food, and estimating portions made consistent tracking nearly impossible."}),e.jsx("p",{children:"We envisioned a simpler solution: what if you could just take a photo of your meal and instantly get accurate nutritional information? By combining the latest advances in computer vision and large language models, we've created an AI system that can analyze food with remarkable accuracy."}),e.jsx("p",{children:"Today, NutriScan helps thousands of users make better nutritional choices without the friction of traditional tracking methods. Our mission is to make nutrition tracking effortless, accurate, and accessible to everyone."})]})]})})}),e.jsxs("div",{className:"mb-16 md:mb-24",children:[e.jsx("h2",{className:"text-3xl font-bold text-neutral-900 mb-8 text-center",children:"Our Technology"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{icon:e.jsx(ta,{className:"h-10 w-10 text-primary-600"}),title:"Advanced AI",description:"Utilizing state-of-the-art large language models and computer vision to accurately identify food items and their nutritional content."},{icon:e.jsx(Ze,{className:"h-10 w-10 text-primary-600"}),title:"Instant Analysis",description:"Get nutritional information in seconds, not minutes. No more tedious manual logging or searching databases."},{icon:e.jsx(Yr,{className:"h-10 w-10 text-primary-600"}),title:"Food Recognition",description:"Our AI can identify thousands of different foods and ingredients, even in complex mixed meals."},{icon:e.jsx(ye,{className:"h-10 w-10 text-primary-600"}),title:"Personalization",description:"The more you use NutriScan, the more it learns about your habits, providing increasingly accurate recommendations."}].map((s,t)=>e.jsx(g,{className:"border border-neutral-200 shadow-sm bg-white",children:e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"rounded-full bg-primary-50 p-3 mb-4",children:s.icon}),e.jsx("h3",{className:"text-lg font-medium text-neutral-900 mb-2",children:s.title}),e.jsx("p",{className:"text-neutral-600",children:s.description})]})})},t))})]}),e.jsx("div",{className:"mb-16 md:mb-24",children:e.jsx("div",{className:"bg-gradient-to-r from-primary-500 to-primary-700 text-white rounded-2xl overflow-hidden",children:e.jsxs("div",{className:"p-8 md:p-12",children:[e.jsx("h2",{className:"text-3xl font-bold mb-8 text-center",children:"Our Vision & Values"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Our Vision"}),e.jsx("p",{className:"text-primary-50 mb-4",children:"We envision a world where everyone has access to accurate nutritional information at their fingertips, empowering them to make better food choices and improve their overall health."}),e.jsx("p",{className:"text-primary-50",children:"By removing the friction from nutrition tracking, we aim to help millions of people develop healthier relationships with food and achieve their wellness goals."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Our Values"}),e.jsxs("ul",{className:"space-y-3 text-primary-50",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"font-bold mr-2",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Accuracy:"})," We're committed to providing the most precise nutritional information possible."]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"font-bold mr-2",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Accessibility:"})," Our tools should be easy to use for everyone, regardless of tech savviness."]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"font-bold mr-2",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Privacy:"})," We respect user data and maintain the highest standards of privacy."]})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"font-bold mr-2",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Innovation:"})," We continuously improve our technology to deliver the best experience."]})]})]})]})]})]})})})]})}),e.jsx(qe,{})]})}const $e=x.forwardRef(({className:s,...t},a)=>e.jsx("textarea",{className:L("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:a,...t}));$e.displayName="Textarea";const yl=Cs({name:ae().min(2,"Name must be at least 2 characters"),email:ae().email("Please enter a valid email address"),subject:ae().min(5,"Subject must be at least 5 characters"),message:ae().min(10,"Message must be at least 10 characters")});function Nl(){const{toast:s}=ve(),[t,a]=x.useState(!1),[r,i]=x.useState(!1),l=Hs({resolver:Gs(yl),defaultValues:{name:"",email:"",subject:"",message:""}}),n=d=>{a(!0),setTimeout(()=>{a(!1),i(!0),s({title:"Message sent!",description:"We'll get back to you as soon as possible."})},1500)};return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(He,{}),e.jsx("main",{className:"flex-grow bg-neutral-50",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-neutral-900 mb-4",children:"Get in Touch"}),e.jsx("p",{className:"text-lg text-neutral-600 max-w-2xl mx-auto",children:"Have questions about NutriScan? We're here to help. Reach out to our team and we'll respond as soon as possible."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx(g,{className:"border border-neutral-200 bg-white shadow-sm",children:e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"bg-primary-100 rounded-full p-3 mr-4",children:e.jsx(vs,{className:"h-5 w-5 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-1",children:"Email Us"}),e.jsx("p",{className:"text-neutral-600 mb-1",children:"For general inquiries:"}),e.jsx("a",{href:"mailto:hello@nutriscan.app",className:"text-primary-600 hover:text-primary-700 font-medium",children:"hello@nutriscan.app"}),e.jsx("p",{className:"text-neutral-600 mt-2 mb-1",children:"For support:"}),e.jsx("a",{href:"mailto:support@nutriscan.app",className:"text-primary-600 hover:text-primary-700 font-medium",children:"support@nutriscan.app"})]})]})})}),e.jsx(g,{className:"border border-neutral-200 bg-white shadow-sm",children:e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"bg-primary-100 rounded-full p-3 mr-4",children:e.jsx(Jr,{className:"h-5 w-5 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-1",children:"Call Us"}),e.jsx("p",{className:"text-neutral-600 mb-1",children:"Customer service:"}),e.jsx("a",{href:"tel:+1-800-123-4567",className:"text-primary-600 hover:text-primary-700 font-medium",children:"+1 (800) 123-4567"}),e.jsx("p",{className:"text-neutral-600 mt-2 mb-1",children:"Hours of operation:"}),e.jsx("p",{className:"text-neutral-700",children:"Monday - Friday: 9am - 5pm EST"})]})]})})}),e.jsx(g,{className:"border border-neutral-200 bg-white shadow-sm",children:e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"bg-primary-100 rounded-full p-3 mr-4",children:e.jsx(Kt,{className:"h-5 w-5 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-1 text-primary",children:"Visit Us"}),e.jsx("p",{className:"text-neutral-600 mb-1",children:"Our headquarters:"}),e.jsxs("address",{className:"not-italic text-neutral-700",children:["123 Nutrition Street",e.jsx("br",{}),"Suite 456",e.jsx("br",{}),"San Francisco, CA 94107",e.jsx("br",{}),"United States"]})]})]})})})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx(g,{className:"border border-neutral-200 bg-white shadow-sm",children:e.jsx(y,{className:"p-6 md:p-8",children:r?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"bg-green-100 rounded-full p-4 inline-flex mx-auto mb-6",children:e.jsx(pt,{className:"h-10 w-10 text-green-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-neutral-900 mb-2",children:"Message Received!"}),e.jsx("p",{className:"text-neutral-600 mb-6",children:"Thank you for reaching out. We've received your message and will get back to you as soon as possible."}),e.jsx(v,{onClick:()=>i(!1),variant:"outline",children:"Send Another Message"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900 mb-6",children:"Send Us a Message"}),e.jsx(Ys,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(n),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(he,{control:l.control,name:"name",render:({field:d})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Your Name"}),e.jsx(de,{children:e.jsx(I,{placeholder:"John Doe",...d})}),e.jsx(me,{})]})}),e.jsx(he,{control:l.control,name:"email",render:({field:d})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Email Address"}),e.jsx(de,{children:e.jsx(I,{placeholder:"john@example.com",...d})}),e.jsx(me,{})]})})]}),e.jsx(he,{control:l.control,name:"subject",render:({field:d})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Subject"}),e.jsx(de,{children:e.jsx(I,{placeholder:"How can we help you?",...d})}),e.jsx(me,{})]})}),e.jsx(he,{control:l.control,name:"message",render:({field:d})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Message"}),e.jsx(de,{children:e.jsx($e,{placeholder:"Tell us more about your inquiry...",className:"min-h-[150px]",...d})}),e.jsx(me,{})]})}),e.jsx(v,{type:"submit",disabled:t,className:"w-full",children:t?e.jsxs(e.Fragment,{children:[e.jsx(vs,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Et,{className:"mr-2 h-4 w-4"}),"Send Message"]})})]})})]})})})})]}),e.jsxs("div",{className:"bg-white border border-neutral-200 rounded-xl shadow-sm p-6 md:p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900 mb-8 text-center",children:"Frequently Asked Questions"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[{question:"How accurate is NutriScan's food recognition?",answer:"NutriScan's AI can identify thousands of foods with an accuracy rate of over 90%. For common foods, the accuracy is even higher. However, for homemade dishes with many ingredients or rare foods, accuracy may vary."},{question:"Does NutriScan work offline?",answer:"NutriScan requires an internet connection to analyze images as our AI processing happens on secure cloud servers. This allows us to maintain a powerful recognition system without requiring excessive device resources."},{question:"How is my data used and protected?",answer:"We take data privacy seriously. Your food images and analysis results are used to improve our service and provide personalized insights. All data is encrypted and stored securely. You can request data deletion at any time."},{question:"Can I use NutriScan for dietary restrictions?",answer:"Yes! NutriScan can help identify foods that match your dietary preferences or restrictions. You can set up allergies, vegetarian/vegan preferences, and other dietary needs in your profile settings."}].map((d,u)=>e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-neutral-900 mb-2",children:d.question}),e.jsx("p",{className:"text-neutral-600",children:d.answer})]},u))})]})]})}),e.jsx(qe,{})]})}function vl(){return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(He,{}),e.jsx("main",{className:"flex-grow bg-neutral-50",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-neutral-200 p-6 md:p-10",children:[e.jsx("h1",{className:"text-3xl font-bold text-neutral-900 mb-6",children:"Terms of Service"}),e.jsx("p",{className:"text-neutral-500 mb-8",children:"Last updated: April, 2025"}),e.jsxs("div",{className:"prose max-w-none text-neutral-700",children:[e.jsx("p",{children:'Welcome to NutriScan. Please read these Terms of Service ("Terms") carefully as they contain important information about your legal rights, remedies, and obligations. By accessing or using the NutriScan service, you agree to comply with and be bound by these Terms.'}),e.jsx("h2",{children:"1. Acceptance of Terms"}),e.jsx("p",{children:"By creating an account, accessing, or using our Services, you agree to be bound by these Terms and our Privacy Policy. If you do not agree to these Terms, you may not access or use our Services."}),e.jsx("h2",{children:"2. Description of Service"}),e.jsx("p",{children:"NutriScan is an AI-powered application that provides nutritional analysis of food through image recognition technology. Our services include but are not limited to:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Food image analysis and nutritional information"}),e.jsx("li",{children:"Personalized nutrition tracking and insights"}),e.jsx("li",{children:"Meal history and progress tracking"})]}),e.jsx("h2",{children:"3. User Accounts"}),e.jsx("p",{children:"To use certain features of our Services, you must create an account. You are responsible for maintaining the confidentiality of your account information, including your password, and for all activity that occurs under your account. You agree to notify us immediately of any unauthorized access to or use of your account."}),e.jsx("h2",{children:"4. Use of Service"}),e.jsx("p",{children:"You agree to use the Service only for purposes that are permitted by these Terms and in compliance with all applicable laws and regulations. You may not:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Use the Service for any illegal purpose or to violate any laws"}),e.jsx("li",{children:"Upload viruses or malicious code or content"}),e.jsx("li",{children:"Attempt to access accounts, systems, or data not belonging to you"}),e.jsx("li",{children:"Interfere with or disrupt the integrity or performance of the Service"}),e.jsx("li",{children:"Reproduce, duplicate, copy, sell, trade, or resell any portion of the Service"})]}),e.jsx("h2",{children:"5. User Content"}),e.jsx("p",{children:'Our Service allows you to upload, store, and share content, including food images and nutritional data ("User Content"). You retain all rights to your User Content, but you grant us a worldwide, non-exclusive, royalty-free license to use, reproduce, modify, adapt, publish, and display such User Content for the purpose of providing and improving our Services.'}),e.jsx("h2",{children:"6. Data Privacy"}),e.jsx("p",{children:"We collect and process personal information as described in our Privacy Policy. By using our Service, you consent to such processing and you represent that all information you provide is accurate."}),e.jsx("h2",{children:"7. Intellectual Property"}),e.jsx("p",{children:"The Service and its original content, features, and functionality are owned by NutriScan and are protected by international copyright, trademark, patent, trade secret, and other intellectual property or proprietary rights laws."}),e.jsx("h2",{children:"8. Subscription Plans and Payments"}),e.jsx("p",{children:"We offer both free and paid subscription plans. By selecting a paid plan, you agree to pay all fees applicable to the selected plan. We may change our fees at any time, but changes will not apply retroactively and will provide notice of changes."}),e.jsx("h2",{children:"9. Termination"}),e.jsx("p",{children:"We may terminate or suspend your account and access to the Service immediately, without prior notice or liability, for any reason, including if you breach these Terms. Upon termination, your right to use the Service will cease immediately."}),e.jsx("h2",{children:"10. Disclaimer of Warranties"}),e.jsx("p",{children:'The Service is provided on an "as is" and "as available" basis. NutriScan makes no warranties, express or implied, regarding the accuracy of nutritional information provided through the Service. The information provided is for informational purposes only and should not be considered medical advice.'}),e.jsx("h2",{children:"11. Limitation of Liability"}),e.jsx("p",{children:"To the maximum extent permitted by law, in no event shall NutriScan be liable for any indirect, incidental, special, consequential, or punitive damages, including without limitation, loss of profits, data, use, goodwill, or other intangible losses, resulting from your use of or inability to use the Service."}),e.jsx("h2",{children:"12. Governing Law"}),e.jsx("p",{children:"These Terms shall be governed by and construed in accordance with the laws of the United States and the State of California, without regard to its conflict of law provisions."}),e.jsx("h2",{children:"13. Changes to Terms"}),e.jsx("p",{children:"We reserve the right to modify or replace these Terms at any time. If a revision is material, we will provide at least 30 days' notice prior to any new terms taking effect. What constitutes a material change will be determined at our sole discretion."}),e.jsx("h2",{children:"14. Contact Us"}),e.jsx("p",{children:"If you have any questions about these Terms, please contact us at legal@nutriscan.app."})]})]})})}),e.jsx(qe,{})]})}function bl(){return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(He,{}),e.jsx("main",{className:"flex-grow bg-neutral-50",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-neutral-200 p-6 md:p-10",children:[e.jsx("h1",{className:"text-3xl font-bold text-neutral-900 mb-6",children:"Privacy Policy"}),e.jsx("p",{className:"text-neutral-500 mb-8",children:"Last updated: April, 2025"}),e.jsxs("div",{className:"prose max-w-none text-neutral-700",children:[e.jsx("p",{children:"At NutriScan, we take your privacy seriously. This Privacy Policy explains how we collect, use, and protect your personal information."}),e.jsx("h2",{children:"1. Information We Collect"}),e.jsx("p",{children:"We collect the following types of information:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Account information (email, name, password)"}),e.jsx("li",{children:"Food images and nutritional data"}),e.jsx("li",{children:"Usage data and analytics"}),e.jsx("li",{children:"Device information"})]}),e.jsx("h2",{children:"2. How We Use Your Information"}),e.jsx("p",{children:"We use your information to:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Provide and improve our services"}),e.jsx("li",{children:"Analyze food images and generate nutritional information"}),e.jsx("li",{children:"Send important updates and notifications"}),e.jsx("li",{children:"Personalize your experience"})]}),e.jsx("h2",{children:"3. Data Storage and Security"}),e.jsx("p",{children:"We implement industry-standard security measures to protect your data. Your information is encrypted both in transit and at rest."}),e.jsx("h2",{children:"4. Data Sharing"}),e.jsx("p",{children:"We do not sell your personal information. We may share data with service providers who help us deliver our services, subject to strict confidentiality agreements."}),e.jsx("h2",{children:"5. Your Rights"}),e.jsx("p",{children:"You have the right to:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Access your personal data"}),e.jsx("li",{children:"Correct inaccurate data"}),e.jsx("li",{children:"Request deletion of your data"}),e.jsx("li",{children:"Export your data"})]}),e.jsx("h2",{children:"6. Cookies and Tracking"}),e.jsx("p",{children:"We use cookies and similar technologies to improve your experience and analyze usage patterns."}),e.jsx("h2",{children:"7. Changes to Privacy Policy"}),e.jsx("p",{children:"We may update this policy periodically. We will notify you of any significant changes."}),e.jsx("h2",{children:"8. Contact Us"}),e.jsx("p",{children:"If you have questions about our privacy practices, please contact us at privacy@nutriscan.app."})]})]})})}),e.jsx(qe,{})]})}const wl=Qr,kl=Xr,Sl=ei,Cl=ti,El=ai,Tl=ri,Al=ii,Rl=ni,Pl=li,Il=ci,Fl=oi,Dl=di,pr=Zr,Ml=si,Ll=pt,Z=mi,re=xi,ee=x.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(wl,{ref:r,className:L("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...a,children:[t,e.jsx(kl,{asChild:!0,children:e.jsx(pr,{className:"h-4 w-4 opacity-50"})})]}));ee.displayName="SelectTrigger";const fr=x.forwardRef(({className:s,...t},a)=>e.jsx(Sl,{ref:a,className:L("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(Ml,{className:"h-4 w-4"})}));fr.displayName="SelectScrollUpButton";const gr=x.forwardRef(({className:s,...t},a)=>e.jsx(Cl,{ref:a,className:L("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(pr,{className:"h-4 w-4"})}));gr.displayName="SelectScrollDownButton";const se=x.forwardRef(({className:s,children:t,position:a="popper",...r},i)=>e.jsx(El,{children:e.jsxs(Tl,{ref:i,className:L("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:a,...r,children:[e.jsx(fr,{}),e.jsx(Al,{className:L("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(gr,{})]})}));se.displayName="SelectContent";const Ol=x.forwardRef(({className:s,...t},a)=>e.jsx(Rl,{ref:a,className:L("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...t}));Ol.displayName="SelectLabel";const E=x.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(Pl,{ref:r,className:L("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Il,{children:e.jsx(Ll,{className:"h-4 w-4"})})}),e.jsx(Fl,{children:t})]}));E.displayName="SelectItem";const Ul=x.forwardRef(({className:s,...t},a)=>e.jsx(Dl,{ref:a,className:L("-mx-1 my-1 h-px bg-muted",s),...t}));Ul.displayName="SelectSeparator";function $l(){const{data:s,isLoading:t,error:a}=W({queryKey:["/api/smart-meal-suggestions"],queryFn:cs({on401:"returnNull"})}),r=["Grilled chicken breast with quinoa and steamed broccoli","Salmon salad with mixed greens, cherry tomatoes, and olive oil vinaigrette","Vegetarian stir-fry with tofu, bell peppers, and brown rice"],i=s?.suggestions&&s.suggestions.length>0?s.suggestions:r;return e.jsxs(g,{className:"card-gradient hover-effect rounded-xl overflow-hidden",children:[e.jsx(b,{className:"px-6 py-5 border-b border-neutral-200",children:e.jsxs(w,{className:"text-xl font-semibold text-neutral-800 flex items-center gap-2",children:[e.jsx(Ze,{className:"h-5 w-5 text-primary-500"}),"Smart Meal Suggestions"]})}),e.jsx(y,{className:"p-4",children:t?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx(Ue,{className:"h-8 w-8 animate-spin text-primary"})}):a?e.jsx("ul",{className:"divide-y divide-neutral-200",children:r.map((l,n)=>e.jsx("li",{className:"py-3 px-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ze,{className:"h-5 w-5 text-primary-500 mr-2"}),e.jsx("span",{className:"text-sm text-neutral-700",children:l})]})},n))}):e.jsx("ul",{className:"divide-y divide-neutral-200",children:i.map((l,n)=>e.jsx("li",{className:"py-3 px-2",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ze,{className:"h-5 w-5 text-primary-500 mr-2"}),e.jsx("span",{className:"text-sm text-neutral-700",children:l})]})},n))})})]})}function zl({mealPlan:s,isMealPlanLoading:t,mealPlanError:a,fetchMealPlan:r,goal:i,daysOfWeek:l,medicalCondition:n}){return e.jsxs(g,{className:"card-gradient glass-effect rounded-xl border border-border",children:[e.jsx(b,{children:e.jsx(w,{children:"AI Meal Plan Generator"})}),e.jsxs(y,{children:[e.jsxs("div",{className:"mb-4 flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsxs("div",{className:"text-primary-500 text-base font-semibold",children:["Personalized for: ",e.jsx("span",{className:"font-bold",children:i.replace(/-/g," ").replace(/\b\w/g,d=>d.toUpperCase())}),n&&n!=="none"&&e.jsxs("span",{className:"ml-2 px-2 py-0.5 rounded bg-primary-800 text-primary-100 text-xs font-semibold",children:[n.charAt(0).toUpperCase()+n.slice(1)," Mode"]})]}),e.jsx("button",{className:"ml-auto bg-primary-600 hover:bg-primary-500 text-primary-50 font-semibold px-4 py-1.5 rounded shadow transition-colors duration-150 text-sm","aria-label":"Regenerate meal plan",onClick:r,disabled:t,children:t?"Generating...":"Regenerate Plan"})]}),e.jsxs("div",{className:"mb-4 text-xs text-primary-600",children:[e.jsx("span",{className:"font-bold",children:"How it works:"})," This plan adapts each week based on your tracked meals, calories, and goals. Over- or under-eating, skipped meals, and preferences are all factored in for next week’s plan. ",e.jsx("span",{className:"text-primary-700",children:"Give feedback to improve your plan!"})]}),a&&e.jsx("div",{className:"text-red-400 mb-4",children:a}),t?e.jsx("div",{className:"text-primary-500 py-8 text-center",children:"Generating meal plan..."}):s&&s.meals?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.meals.map((d,u)=>e.jsxs("div",{className:"bg-primary-800/40 rounded-lg p-4 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-primary-200 font-bold",children:d.day||l[u]}),d.adaptation&&e.jsx("span",{className:"ml-2 text-xs text-accent-300 bg-accent-900/60 rounded px-2 py-0.5",children:d.adaptation})]}),e.jsx("ul",{className:"list-none text-primary-100 text-sm mb-2",children:["breakfast","lunch","snack","dinner","snacks"].map(p=>{const o=d[p]||(Array.isArray(d.snacks)&&p==="snacks"?null:void 0);return o?p==="snacks"&&Array.isArray(d.snacks)?d.snacks.map((h,j)=>e.jsxs("li",{className:"mb-1 flex flex-col md:flex-row md:items-center md:gap-2",children:[e.jsx("span",{className:"font-medium w-24 inline-block",children:"Snack:"}),e.jsx("span",{children:h.name}),e.jsxs("span",{className:"ml-auto text-xs text-primary-300",children:[h.calories," kcal"]}),e.jsxs("span",{className:"ml-2 text-xs text-primary-400",children:["P:",h.protein,"g C:",h.carbs,"g F:",h.fat,"g"]})]},`snack-${j}`)):e.jsxs("li",{className:"mb-1 flex flex-col md:flex-row md:items-center md:gap-2",children:[e.jsxs("span",{className:"font-medium w-24 inline-block",children:[p.charAt(0).toUpperCase()+p.slice(1),":"]}),e.jsx("span",{children:o.name}),e.jsxs("span",{className:"ml-auto text-xs text-primary-300",children:[o.calories," kcal"]}),e.jsxs("span",{className:"ml-2 text-xs text-primary-400",children:["P:",o.protein,"g C:",o.carbs,"g F:",o.fat,"g"]})]},p):null})}),e.jsxs("div",{className:"flex justify-between text-xs text-primary-200 border-t border-primary-700 pt-2 mt-2",children:[e.jsxs("span",{children:["Total: ",e.jsxs("span",{className:"font-bold",children:[d.totalCalories||""," kcal"]})]}),e.jsxs("span",{children:["P:",d.totalProtein||"","g C:",d.totalCarbs||"","g F:",d.totalFat||"","g"]})]})]},d.day||u))}):e.jsx("div",{className:"text-primary-600 py-8 text-center",children:"No meal plan available."})]})]})}function _l(){const[s,t]=x.useState(""),[a,r]=x.useState(!1),[i,l]=x.useState(null),{toast:n}=ve(),{data:d,isLoading:u,error:p,refetch:o}=W({queryKey:["/api/meal-plan"],queryFn:cs({on401:"returnNull"})}),h=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],j=async()=>{if(!s){n({title:"Please select a goal",variant:"destructive"});return}r(!0);try{const f=await ke("POST","/api/meal-plan",{goal:s});if(!f.ok)throw new Error("Failed to generate meal plan");const k=await f.json();l(k)}catch{n({title:"Error generating meal plan",description:"Please try again later",variant:"destructive"})}finally{r(!1)}};return e.jsxs("div",{className:"container py-8 max-w-7xl",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"AI Meal Planner"}),e.jsx("div",{className:"mb-8",children:e.jsx($l,{})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(g,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Generate New Plan"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select your goal"}),e.jsxs(Z,{value:s,onValueChange:t,children:[e.jsx("option",{value:"",children:"Select your goal"}),e.jsx("option",{value:"weight-loss",children:"Weight Loss"}),e.jsx("option",{value:"muscle-gain",children:"Muscle Gain"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"keto",children:"Keto Diet"}),e.jsx("option",{value:"vegan",children:"Vegan"})]})]}),e.jsx(v,{onClick:j,disabled:a,className:"w-full",children:a?"Generating...":"Generate Meal Plan"})]})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx(zl,{mealPlan:d,isMealPlanLoading:u,mealPlanError:p?p.message:null,fetchMealPlan:o,goal:s,daysOfWeek:h,medicalCondition:"none"})})]}),i&&e.jsxs(g,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Generated Meal Plan"}),e.jsx("div",{className:"grid gap-6",children:i.meals.map((f,k)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:f.day}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Breakfast"}),e.jsx("p",{children:f.breakfast.name}),e.jsxs("p",{className:"text-sm text-neutral-600",children:[f.breakfast.calories," cal | ",f.breakfast.protein,"g protein"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Lunch"}),e.jsx("p",{children:f.lunch.name}),e.jsxs("p",{className:"text-sm text-neutral-600",children:[f.lunch.calories," cal | ",f.lunch.protein,"g protein"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Dinner"}),e.jsx("p",{children:f.dinner.name}),e.jsxs("p",{className:"text-sm text-neutral-600",children:[f.dinner.calories," cal | ",f.dinner.protein,"g protein"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Snacks"}),f.snacks.map((c,R)=>e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{children:c.name}),e.jsxs("p",{className:"text-sm text-neutral-600",children:[c.calories," cal | ",c.protein,"g protein"]})]},R))]})]})]},k))})]})]})}function yr({className:s,classNames:t,showOutsideDays:a=!0,...r}){return e.jsx(hi,{showOutsideDays:a,className:L("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:L(Yt({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:L(Yt({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({className:i,...l})=>e.jsx(ea,{className:L("h-4 w-4",i),...l}),IconRight:({className:i,...l})=>e.jsx(at,{className:L("h-4 w-4",i),...l})},...r})}yr.displayName="Calendar";function ql(){const[s,t]=x.useState(new Date),[a,r]=x.useState([]),[i,l]=x.useState(!1),{toast:n}=ve(),{user:d}=Le(),[u,p]=x.useState(!1),[o,h]=x.useState({}),[j,f]=x.useState(null),k=async A=>{l(!0);try{const _=A.getFullYear(),Q=A.getMonth(),ie=new Date(_,Q,1).toISOString(),ge=new Date(_,Q+1,0).toISOString(),ne=await fetch(`/api/planned-meals?startDate=${ie}&endDate=${ge}`);if(!ne.ok)throw new Error("Failed to fetch planned meals");const z=await ne.json();r(z)}catch(_){n({title:"Error fetching meals",description:_.message,variant:"destructive"})}finally{l(!1)}},c=async()=>{l(!0);try{const A=await fetch("/api/planned-meals/export/ical");if(!A.ok){const ge=await A.json().catch(()=>({message:"Failed to export calendar. Server returned an error."}));throw new Error(ge.message||"Failed to export calendar")}const _=await A.blob(),Q=window.URL.createObjectURL(_),ie=document.createElement("a");ie.href=Q,ie.download="meal_plan.ics",document.body.appendChild(ie),ie.click(),ie.remove(),window.URL.revokeObjectURL(Q),n({title:"Calendar Exported",description:"Your meal plan has been downloaded as an iCalendar file."})}catch(A){n({title:"Error Exporting Calendar",description:A.message,variant:"destructive"})}finally{l(!1)}},R=async A=>{const _=A.target.files?.[0];if(!_)return;l(!0);const Q=new FormData;Q.append("icalFile",_);try{const ie=kn(ra({})),ge=await fetch("/api/planned-meals/import/ical",{method:"POST",headers:ie,body:Q,credentials:"include"});if(!ge.ok){const z=await ge.json().catch(()=>({message:"Failed to import calendar. Server returned an error."}));throw new Error(z.message||"Failed to import calendar")}const ne=await ge.json();n({title:"Calendar Imported",description:ne.message||"Meal plan imported successfully."}),s&&k(s)}catch(ie){n({title:"Error Importing Calendar",description:ie.message,variant:"destructive"})}finally{l(!1),A.target.value=""}};x.useEffect(()=>{s&&k(s)},[s]);const D=A=>{t(A)},S=A=>{A?(f(A),h({id:A.id,date:A.date,mealType:A.mealType,mealName:A.mealName,calories:A.calories,protein:A.protein,carbs:A.carbs,fat:A.fat,recipe:A.recipe||"",notes:A.notes||""})):(f(null),h({date:s})),p(!0)},q=()=>{p(!1),h({}),f(null)},T=A=>{const{name:_,value:Q}=A.target;h(ie=>({...ie,[_]:_==="calories"||_==="protein"||_==="carbs"||_==="fat"?parseInt(Q,10):Q}))},m=async()=>{if(!o.mealName||!o.mealType||!s){n({title:"Missing required fields",variant:"destructive"});return}const A={date:s,userId:d?.id||0,mealType:o.mealType,mealName:o.mealName,calories:o.calories||0,protein:o.protein||0,carbs:o.carbs||0,fat:o.fat||0,recipe:o.recipe,notes:o.notes};try{let _;if(j&&j.id?_=await ke("PUT",`/api/planned-meals/${j.id}`,A):_=await ke("POST","/api/planned-meals",A),!_.ok){const Q=await _.json();throw new Error(Q.error||"Failed to save meal")}n({title:`Meal ${j?"updated":"added"} successfully`}),q(),s&&k(s)}catch(_){n({title:"Error saving meal",description:_.message,variant:"destructive"})}},N=async A=>{if(confirm("Are you sure you want to delete this meal?"))try{const _=await ke("DELETE",`/api/planned-meals/${A}`);if(!_.ok&&_.status!==204){const Q=await _.json();throw new Error(Q.error||"Failed to delete meal")}n({title:"Meal deleted successfully"}),s&&k(s)}catch(_){n({title:"Error deleting meal",description:_.message,variant:"destructive"})}},F=a.filter(A=>s&&new Date(A.date).toDateString()===s.toDateString()).sort((A,_)=>{const Q={breakfast:1,lunch:2,dinner:3,snack:4},ie=typeof A.mealType=="string"&&Q[A.mealType.toLowerCase()]?A.mealType.toLowerCase():"snack",ge=typeof _.mealType=="string"&&Q[_.mealType.toLowerCase()]?_.mealType.toLowerCase():"snack";return(Q[ie]||5)-(Q[ge]||5)});return e.jsxs("div",{className:"container py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Meal Planning Calendar"}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[e.jsx("div",{className:"md:col-span-1",children:e.jsx(yr,{mode:"single",selected:s,onSelect:D,className:"rounded-md border shadow"})}),e.jsxs("div",{className:"md:col-span-2",children:[i&&e.jsx("p",{children:"Loading meals..."}),!i&&F.length===0&&e.jsx("p",{children:"No meals planned for this day."}),!i&&F.length>0&&e.jsx("ul",{className:"space-y-4",children:F.map(A=>e.jsx("li",{className:"p-4 border rounded-md shadow-sm",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-lg",children:[A.mealName," (",A.mealType,")"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[A.calories," kcal | P: ",A.protein,"g | C: ",A.carbs,"g | F: ",A.fat,"g"]}),A.recipe&&e.jsxs("p",{className:"text-xs mt-1",children:["Recipe: ",A.recipe]}),A.notes&&e.jsxs("p",{className:"text-xs mt-1",children:["Notes: ",A.notes]})]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>S(A),children:"Edit"}),e.jsx(v,{variant:"destructive",size:"sm",onClick:()=>N(A.id),children:"Delete"})]})]})},A.id))}),e.jsxs("h2",{className:"text-xl font-semibold mb-4",children:["Meals for ",s?s.toLocaleDateString():"selected date"]}),e.jsx(v,{onClick:()=>S(),className:"mt-4",children:"Add Meal to this Date"}),e.jsxs("div",{className:"mt-6 pt-6 border-t",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Calendar Integrations"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(v,{variant:"outline",onClick:c,children:"Export Calendar (iCal)"}),e.jsx(v,{variant:"outline",onClick:()=>document.getElementById("ical-import-input")?.click(),children:"Import Calendar (iCal)"}),e.jsx("input",{type:"file",id:"ical-import-input",accept:".ics",onChange:R,style:{display:"none"}})]})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-md",children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-4",children:[j?"Edit":"Add"," Meal"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mealName",className:"block text-sm font-medium text-gray-700",children:"Meal Name"}),e.jsx("input",{type:"text",name:"mealName",id:"mealName",value:o.mealName||"",onChange:T,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mealType",className:"block text-sm font-medium text-gray-700",children:"Meal Type"}),e.jsxs("select",{name:"mealType",id:"mealType",value:o.mealType||"",onChange:T,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2",children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"breakfast",children:"Breakfast"}),e.jsx("option",{value:"lunch",children:"Lunch"}),e.jsx("option",{value:"dinner",children:"Dinner"}),e.jsx("option",{value:"snack",children:"Snack"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"calories",className:"block text-sm font-medium text-gray-700",children:"Calories"}),e.jsx("input",{type:"number",name:"calories",id:"calories",value:o.calories||"",onChange:T,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"protein",className:"block text-sm font-medium text-gray-700",children:"Protein (g)"}),e.jsx("input",{type:"number",name:"protein",id:"protein",value:o.protein||"",onChange:T,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"carbs",className:"block text-sm font-medium text-gray-700",children:"Carbs (g)"}),e.jsx("input",{type:"number",name:"carbs",id:"carbs",value:o.carbs||"",onChange:T,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"fat",className:"block text-sm font-medium text-gray-700",children:"Fat (g)"}),e.jsx("input",{type:"number",name:"fat",id:"fat",value:o.fat||"",onChange:T,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"recipe",className:"block text-sm font-medium text-gray-700",children:"Recipe (optional)"}),e.jsx("textarea",{name:"recipe",id:"recipe",value:o.recipe||"",onChange:T,rows:3,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700",children:"Notes (optional)"}),e.jsx("textarea",{name:"notes",id:"notes",value:o.notes||"",onChange:T,rows:3,className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx(v,{variant:"outline",onClick:q,children:"Cancel"}),e.jsxs(v,{onClick:m,children:[j?"Update":"Add"," Meal"]})]})]})})]})]})]})}function Bl(){const[s,t]=x.useState(""),[a,r]=x.useState(null),[i,l]=x.useState([]),[n,d]=x.useState(!1),[u,p]=x.useState(!1),[o,h]=x.useState(null),[j,f]=x.useState(null),{toast:k}=ve(),c=async()=>{p(!0);try{const O=await ke("GET","/api/imported-recipes");if(!O.ok)throw new Error("Failed to fetch imported recipes");const X=await O.json();l(X)}catch(O){k({title:"Error",description:O.message,variant:"destructive"})}p(!1)};x.useEffect(()=>{c()},[]);const R=async()=>{if(!s){k({title:"Error",description:"Please enter a URL",variant:"destructive"});return}d(!0);try{const O=await ke("POST","/api/imported-recipes/from-url",{url:s});if(!O.ok){const X=await O.json();throw new Error(X.error||"Failed to import from URL")}k({title:"Success",description:"Recipe imported successfully from URL!"}),t(""),c()}catch(O){k({title:"Import Error",description:O.message,variant:"destructive"})}d(!1)},D=O=>{O.target.files&&O.target.files[0]&&r(O.target.files[0])},S=async()=>{if(!a){k({title:"Error",description:"Please select an image file",variant:"destructive"});return}d(!0);const O=new FileReader;O.readAsDataURL(a),O.onload=async()=>{try{const X=O.result,Ae=await ke("POST","/api/imported-recipes/from-image",{imageData:X});if(!Ae.ok){const le=await Ae.json();throw new Error(le.error||"Failed to import from image")}k({title:"Success",description:"Recipe imported successfully from image!"}),r(null),document.getElementById("image-upload")&&(document.getElementById("image-upload").value=""),c()}catch(X){k({title:"Import Error",description:X.message,variant:"destructive"})}d(!1)},O.onerror=()=>{k({title:"Error",description:"Failed to read file.",variant:"destructive"}),d(!1)}},q=async O=>{if(confirm("Are you sure you want to delete this imported recipe?"))try{const X=await ke("DELETE",`/api/imported-recipes/${O}`);if(!X.ok&&X.status!==204)throw new Error("Failed to delete recipe");k({title:"Success",description:"Recipe deleted successfully."}),c()}catch(X){k({title:"Error",description:X.message,variant:"destructive"})}},[T,m]=x.useState(!1),[N,F]=x.useState(!1),[A,_]=x.useState({}),Q=O=>{f(O),m(!0)},ie=()=>{m(!1),f(null)},ge=O=>{h(O),_({id:O.id,recipeName:O.recipeName,ingredients:O.ingredients,instructions:O.instructions,parsedNutrition:O.parsedNutrition,notes:O.notes,sourceUrl:O.sourceUrl}),F(!0)},ne=()=>{F(!1),h(null),_({})},z=O=>{const{name:X,value:Ae}=O.target;_(le=>({...le,[X]:Ae}))},M=(O,X)=>{try{const Ae=JSON.parse(X);_(le=>({...le,[O]:Ae}))}catch{k({title:"Invalid JSON",description:`Error parsing ${O}. Please ensure it's valid JSON.`,variant:"destructive"})}},xe=async()=>{if(!(!o||!o.id)){d(!0);try{const O=await ke("PUT",`/api/imported-recipes/${o.id}`,{recipeName:A.recipeName,ingredients:A.ingredients,instructions:A.instructions,parsedNutrition:A.parsedNutrition,notes:A.notes,sourceUrl:A.sourceUrl});if(!O.ok){const X=await O.json();throw new Error(X.error||"Failed to update recipe")}k({title:"Success",description:"Recipe updated successfully!"}),ne(),c()}catch(O){k({title:"Update Error",description:O.message,variant:"destructive"})}d(!1)}},Ke=O=>{if(!O||typeof O!="object")return null;const X=O,le=[{key:"calories",label:"Calories",unit:""},{key:"protein",label:"Protein",unit:"g"},{key:"carbs",label:"Carbs",unit:"g"},{key:"fat",label:"Fat",unit:"g"},{key:"fiber",label:"Fiber",unit:"g"},{key:"sugar",label:"Sugar",unit:"g"},{key:"sodium",label:"Sodium",unit:"mg"}].filter(ss=>typeof X[ss.key]=="number"&&X[ss.key]!==void 0);return le.length===0?null:e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsx("div",{className:"font-medium text-gray-700",children:"Nutrition (per serving):"}),le.map(ss=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[ss.label,":"]}),e.jsxs("span",{children:[X[ss.key],ss.unit]})]},ss.key))]})};return e.jsxs("div",{className:"container py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Import & Manage Recipes"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 mb-8",children:[e.jsxs(g,{children:[e.jsxs(b,{children:[e.jsxs(w,{className:"flex items-center",children:[e.jsx(ui,{className:"mr-2 h-5 w-5"})," Import from URL"]}),e.jsx(ds,{children:"Paste a URL to a recipe page to import it."})]}),e.jsx(y,{children:e.jsx(I,{type:"url",placeholder:"https://www.example.com/your-favorite-recipe",value:s,onChange:O=>t(O.target.value),className:"mb-4"})}),e.jsx(Ts,{children:e.jsxs(v,{onClick:R,disabled:n||!s,children:[n?e.jsx(Ue,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Import from URL"]})})]}),e.jsxs(g,{children:[e.jsxs(b,{children:[e.jsxs(w,{className:"flex items-center",children:[e.jsx(ji,{className:"mr-2 h-5 w-5"})," Import from Image"]}),e.jsx(ds,{children:"Upload an image of a recipe (e.g., from a cookbook)."})]}),e.jsxs(y,{children:[e.jsx(I,{id:"image-upload",type:"file",accept:"image/*",onChange:D,className:"mb-4"}),a&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Selected: ",a.name]})]}),e.jsx(Ts,{children:e.jsxs(v,{onClick:S,disabled:n||!a,children:[n?e.jsx(Ue,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Import from Image"]})})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6",children:"Your Imported Recipes"}),u?e.jsx("div",{className:"flex justify-center items-center py-8",children:e.jsx(Ue,{className:"h-8 w-8 animate-spin text-primary"})}):i.length===0?e.jsx("p",{children:"You haven't imported any recipes yet."}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:i.map(O=>e.jsxs(g,{children:[e.jsxs(b,{children:[e.jsx(w,{className:"truncate",children:O.recipeName}),O.sourceUrl&&e.jsx(ds,{className:"text-xs truncate",children:e.jsx("a",{href:O.sourceUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"Source URL"})}),O.sourceImageUrl&&e.jsx(ds,{className:"text-xs truncate",children:e.jsx("a",{href:O.sourceImageUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"Source Image"})}),!O.sourceUrl&&!O.sourceImageUrl&&O.rawImageData&&e.jsx(ds,{className:"text-xs",children:"Image Upload"})]}),e.jsxs(y,{className:"text-sm",children:[Ke(O.parsedNutrition),e.jsx("p",{className:"mt-2 text-gray-600 truncate h-10",children:O.instructions||"No instructions available."})]}),e.jsxs(Ts,{className:"flex justify-end space-x-2",children:[e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>Q(O),children:[e.jsx(Os,{className:"mr-1 h-4 w-4"})," View"]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>ge(O),children:[e.jsx(Ua,{className:"mr-1 h-4 w-4"})," Edit"]}),e.jsxs(v,{variant:"destructive",size:"sm",onClick:()=>q(O.id),children:[e.jsx(Ws,{className:"mr-1 h-4 w-4"})," Delete"]})]})]},O.id))})]}),T&&j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50 overflow-y-auto",children:e.jsxs(g,{className:"w-full max-w-2xl max-h-[90vh] flex flex-col",children:[e.jsxs(b,{children:[e.jsx(w,{children:j.recipeName}),j.sourceUrl&&e.jsx(ds,{children:e.jsx("a",{href:j.sourceUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"Source URL"})})]}),e.jsxs(y,{className:"flex-grow overflow-y-auto",children:[e.jsx("h3",{className:"font-semibold mt-2 mb-1",children:"Ingredients:"}),Array.isArray(j.ingredients)?e.jsx("ul",{className:"list-disc pl-5 text-sm",children:j.ingredients.map((O,X)=>e.jsx("li",{children:`${O.quantity||""} ${O.unit||""} ${O.name}`},X))}):e.jsx("p",{className:"text-sm",children:typeof j.ingredients=="string"?j.ingredients:"Not available"}),e.jsx("h3",{className:"font-semibold mt-4 mb-1",children:"Instructions:"}),e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:j.instructions||"Not available"}),e.jsx("h3",{className:"font-semibold mt-4 mb-1",children:"Parsed Nutrition:"}),j.parsedNutrition&&typeof j.parsedNutrition=="object"?e.jsx("pre",{className:"text-sm bg-gray-100 p-2 rounded overflow-x-auto",children:JSON.stringify(j.parsedNutrition,null,2)}):e.jsx("p",{className:"text-sm",children:"Not available"}),j.notes&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"font-semibold mt-4 mb-1",children:"Notes:"}),e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:j.notes})]})]}),e.jsx(Ts,{children:e.jsx(v,{onClick:ie,children:"Close"})})]})}),N&&o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50 overflow-y-auto",children:e.jsxs(g,{className:"w-full max-w-2xl max-h-[90vh] flex flex-col",children:[e.jsx(b,{children:e.jsxs(w,{children:["Edit: ",o.recipeName]})}),e.jsxs(y,{className:"flex-grow overflow-y-auto space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-recipeName",className:"block text-sm font-medium",children:"Recipe Name"}),e.jsx(I,{id:"edit-recipeName",name:"recipeName",value:A.recipeName||"",onChange:z})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-sourceUrl",className:"block text-sm font-medium",children:"Source URL (optional)"}),e.jsx(I,{id:"edit-sourceUrl",name:"sourceUrl",value:A.sourceUrl||"",onChange:z})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-ingredients",className:"block text-sm font-medium",children:"Ingredients (JSON format)"}),e.jsx($e,{id:"edit-ingredients",name:"ingredients",value:typeof A.ingredients=="string"?A.ingredients:JSON.stringify(A.ingredients,null,2),onChange:O=>M("ingredients",O.target.value),rows:5})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-instructions",className:"block text-sm font-medium",children:"Instructions"}),e.jsx($e,{id:"edit-instructions",name:"instructions",value:A.instructions||"",onChange:z,rows:5})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-parsedNutrition",className:"block text-sm font-medium",children:"Parsed Nutrition (JSON format)"}),e.jsx($e,{id:"edit-parsedNutrition",name:"parsedNutrition",value:typeof A.parsedNutrition=="string"?A.parsedNutrition:JSON.stringify(A.parsedNutrition,null,2),onChange:O=>M("parsedNutrition",O.target.value),rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-notes",className:"block text-sm font-medium",children:"Notes"}),e.jsx($e,{id:"edit-notes",name:"notes",value:A.notes||"",onChange:z,rows:3})]})]}),e.jsxs(Ts,{className:"flex justify-end space-x-2",children:[e.jsx(v,{variant:"outline",onClick:ne,children:"Cancel"}),e.jsxs(v,{onClick:xe,disabled:n,children:[n?e.jsx(Ue,{className:"mr-2 h-4 w-4 animate-spin"}):null," Update Recipe"]})]})]})})]})}function Vl({onStepCompleted:s,onNext:t}){return x.useEffect(()=>{s()},[s]),e.jsxs("div",{className:"max-w-2xl mx-auto text-center space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"relative",children:[e.jsx(ns,{className:"h-16 w-16 text-primary-600"}),e.jsx(js,{className:"h-6 w-6 text-primary-400 absolute -top-1 -right-1"})]})}),e.jsx("h1",{className:"text-4xl font-bold text-neutral-900",children:"Welcome to NutriScan"}),e.jsx("p",{className:"text-xl text-primary-600 font-medium",children:"Track smarter, eat better with AI."})]}),e.jsx(g,{className:"bg-gradient-to-br from-primary-50 to-white border-primary-200",children:e.jsxs(y,{className:"p-8 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-primary-600 font-semibold",children:"1"})}),e.jsx("p",{className:"text-left text-neutral-700",children:"Set up your personal profile for AI-powered nutrition recommendations"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-primary-600 font-semibold",children:"2"})}),e.jsx("p",{className:"text-left text-neutral-700",children:"Choose your health goals and dietary preferences"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-primary-600 font-semibold",children:"3"})}),e.jsx("p",{className:"text-left text-neutral-700",children:"Get personalized meal suggestions and nutrition insights"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs(v,{onClick:t,size:"lg",className:"w-full flex items-center justify-center gap-2",children:["Get Started",e.jsx(zs,{className:"h-5 w-5"})]})})]})}),e.jsx("p",{className:"text-sm text-neutral-500",children:"This will only take 2-3 minutes to complete"})]})}const Hl=Cs({firstName:ae().min(1,"First name is required"),lastName:ae().min(1,"Last name is required"),email:ae().email("Please enter a valid email address"),username:ae().min(3,"Username must be at least 3 characters"),password:ae().min(6,"Password must be at least 6 characters"),confirmPassword:ae().min(6,"Please confirm your password"),referralCode:ae().optional()}).refine(s=>s.password===s.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]});function Kl({data:s,updateData:t,onStepCompleted:a,onNext:r,isCompleted:i}){const{registerMutation:l,user:n}=Le(),[d,u]=x.useState("social");if(n)return x.useEffect(()=>{a(),r()},[a,r]),e.jsx("div",{className:"max-w-md mx-auto space-y-6",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"Account Already Created"}),e.jsx("p",{className:"text-neutral-600",children:"You're already logged in. Redirecting to next step..."})]})});const p=Hs({resolver:Gs(Hl),defaultValues:{firstName:s.name?.split(" ")[0]||"",lastName:s.name?.split(" ")[1]||"",email:"",username:"",password:"",confirmPassword:"",referralCode:""}}),o=async j=>{try{await l.mutateAsync({firstName:j.firstName,lastName:j.lastName,username:j.username,password:j.password,confirmPassword:j.password,email:j.email}),t({name:`${j.firstName} ${j.lastName}`}),a(),r()}catch(f){console.error("Registration failed:",f),f instanceof Error&&f.message.includes("401")&&alert("Authentication failed. Please try again.")}},h=j=>{};return e.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"Create Your Account"}),e.jsx("p",{className:"text-neutral-600",children:"Choose how you'd like to sign up"})]}),e.jsxs(g,{children:[e.jsx(b,{className:"pb-4",children:e.jsxs("div",{className:"flex rounded-lg bg-neutral-100 p-1",children:[e.jsx("button",{onClick:()=>u("social"),className:`flex-1 text-sm font-medium py-2 px-3 rounded-md transition-colors ${d==="social"?"bg-white text-neutral-900 shadow-sm":"text-neutral-600 hover:text-neutral-900"}`,children:"Social Sign Up"}),e.jsx("button",{onClick:()=>u("email"),className:`flex-1 text-sm font-medium py-2 px-3 rounded-md transition-colors ${d==="email"?"bg-white text-neutral-900 shadow-sm":"text-neutral-600 hover:text-neutral-900"}`,children:"Email Sign Up"})]})}),e.jsx(y,{className:"space-y-4",children:d==="social"?e.jsxs("div",{className:"space-y-3",children:[e.jsxs(v,{variant:"outline",onClick:()=>h(),className:"w-full flex items-center justify-center gap-3 h-11",disabled:!0,children:[e.jsx(vs,{className:"h-5 w-5 text-red-500"}),"Continue with Google",e.jsx("span",{className:"text-xs text-neutral-400 ml-2",children:"(Coming Soon)"})]}),e.jsxs(v,{variant:"outline",onClick:()=>h(),className:"w-full flex items-center justify-center gap-3 h-11",disabled:!0,children:[e.jsx(Xt,{className:"h-5 w-5"}),"Continue with Apple",e.jsx("span",{className:"text-xs text-neutral-400 ml-2",children:"(Coming Soon)"})]}),e.jsxs("div",{className:"relative my-6",children:[e.jsx(ts,{}),e.jsx("span",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-white px-2 text-xs text-neutral-500",children:"or sign up with email"})]}),e.jsxs(v,{variant:"ghost",onClick:()=>u("email"),className:"w-full flex items-center justify-center gap-2",children:[e.jsx(vs,{className:"h-4 w-4"}),"Use Email Instead"]})]}):e.jsx(Ys,{...p,children:e.jsxs("form",{onSubmit:p.handleSubmit(o),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(he,{control:p.control,name:"firstName",render:({field:j})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"First Name"}),e.jsx(de,{children:e.jsx(I,{placeholder:"John",...j})}),e.jsx(me,{})]})}),e.jsx(he,{control:p.control,name:"lastName",render:({field:j})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Last Name"}),e.jsx(de,{children:e.jsx(I,{placeholder:"Doe",...j})}),e.jsx(me,{})]})})]}),e.jsx(he,{control:p.control,name:"email",render:({field:j})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Email"}),e.jsx(de,{children:e.jsx(I,{type:"email",placeholder:"john@example.com",...j})}),e.jsx(me,{})]})}),e.jsx(he,{control:p.control,name:"username",render:({field:j})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Username"}),e.jsx(de,{children:e.jsx(I,{placeholder:"johndoe",...j})}),e.jsx(me,{})]})}),e.jsx(he,{control:p.control,name:"password",render:({field:j})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Password"}),e.jsx(de,{children:e.jsx(I,{type:"password",placeholder:"Create a password",...j})}),e.jsx(me,{})]})}),e.jsx(he,{control:p.control,name:"confirmPassword",render:({field:j})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Confirm Password"}),e.jsx(de,{children:e.jsx(I,{type:"password",placeholder:"Confirm your password",...j})}),e.jsx(me,{})]})}),e.jsx(he,{control:p.control,name:"referralCode",render:({field:j})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Referral Code (optional)"}),e.jsx(de,{children:e.jsx(I,{placeholder:"Enter referral code if you have one",...j})}),e.jsx(me,{})]})}),e.jsx(v,{type:"submit",className:"w-full",disabled:l.isPending,children:l.isPending?"Creating Account...":"Create Account"})]})})})]}),e.jsx("p",{className:"text-xs text-neutral-500 text-center",children:"By creating an account, you agree to our Terms of Service and Privacy Policy"})]})}const Wl=Cs({name:ae().min(1,"Name is required"),age:bt().min(13,"You must be at least 13 years old").max(120,"Please enter a valid age"),gender:ae().min(1,"Please select your gender"),height:bt().min(100,"Height must be at least 100cm").max(250,"Please enter a valid height"),weight:bt().min(30,"Weight must be at least 30kg").max(300,"Please enter a valid weight")});function Gl({data:s,updateData:t,onStepCompleted:a,onNext:r,isCompleted:i}){const l=Hs({resolver:Gs(Wl),defaultValues:{name:s.name||"",age:s.age||void 0,gender:s.gender||"",height:s.height||void 0,weight:s.weight||void 0}}),n=d=>{t({name:d.name,age:d.age,gender:d.gender,height:d.height,weight:d.weight}),a(),r()};return e.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(Ns,{className:"h-6 w-6 text-primary-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"Tell Us About You"}),e.jsx("p",{className:"text-neutral-600",children:"This helps us personalize your nutrition recommendations"})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{className:"text-lg",children:"Personal Information"})}),e.jsx(y,{children:e.jsx(Ys,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(n),className:"space-y-4",children:[e.jsx(he,{control:l.control,name:"name",render:({field:d})=>e.jsxs(ce,{children:[e.jsxs(oe,{className:"flex items-center gap-2",children:[e.jsx(Ns,{className:"h-4 w-4 text-primary-600"}),"Full Name"]}),e.jsx(de,{children:e.jsx(I,{placeholder:"Enter your full name",...d})}),e.jsx(me,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(he,{control:l.control,name:"age",render:({field:d})=>e.jsxs(ce,{children:[e.jsxs(oe,{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-4 w-4 text-primary-600"}),"Age"]}),e.jsx(de,{children:e.jsx(I,{type:"number",placeholder:"25",...d,onChange:u=>d.onChange(u.target.value?Number(u.target.value):void 0)})}),e.jsx(me,{})]})}),e.jsx(he,{control:l.control,name:"gender",render:({field:d})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Gender"}),e.jsxs(Z,{onValueChange:d.onChange,defaultValue:d.value,children:[e.jsx(de,{children:e.jsx(ee,{children:e.jsx(re,{placeholder:"Select"})})}),e.jsxs(se,{children:[e.jsx(E,{value:"male",children:"Male"}),e.jsx(E,{value:"female",children:"Female"}),e.jsx(E,{value:"other",children:"Other"}),e.jsx(E,{value:"prefer-not-to-say",children:"Prefer not to say"})]})]}),e.jsx(me,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(he,{control:l.control,name:"height",render:({field:d})=>e.jsxs(ce,{children:[e.jsxs(oe,{className:"flex items-center gap-2",children:[e.jsx(pi,{className:"h-4 w-4 text-primary-600"}),"Height (cm)"]}),e.jsx(de,{children:e.jsx(I,{type:"number",placeholder:"170",...d,onChange:u=>d.onChange(u.target.value?Number(u.target.value):void 0)})}),e.jsx(me,{})]})}),e.jsx(he,{control:l.control,name:"weight",render:({field:d})=>e.jsxs(ce,{children:[e.jsxs(oe,{className:"flex items-center gap-2",children:[e.jsx(fi,{className:"h-4 w-4 text-primary-600"}),"Weight (kg)"]}),e.jsx(de,{children:e.jsx(I,{type:"number",placeholder:"70",...d,onChange:u=>d.onChange(u.target.value?Number(u.target.value):void 0)})}),e.jsx(me,{})]})})]}),e.jsx(v,{type:"submit",className:"w-full",children:"Continue"})]})})})]}),e.jsxs("div",{className:"text-xs text-neutral-500 text-center space-y-1",children:[e.jsx("p",{children:"Your personal information is kept private and secure."}),e.jsx("p",{children:"We use this data only to provide personalized recommendations."})]})]})}const Yl=[{id:"sedentary",title:"Sedentary",description:"Little to no exercise, desk job",details:"Office work, mostly sitting, minimal physical activity",icon:Me,multiplier:1.2},{id:"light",title:"Lightly Active",description:"Light exercise 1-3 times per week",details:"Light workouts, walking, occasional sports",icon:be,multiplier:1.375},{id:"moderate",title:"Moderately Active",description:"Moderate exercise 3-5 times per week",details:"Regular gym sessions, consistent exercise routine",icon:Ze,multiplier:1.55},{id:"active",title:"Very Active",description:"Hard exercise 6-7 times per week",details:"Daily workouts, sports, physically demanding job",icon:gi,multiplier:1.725},{id:"extra-active",title:"Extremely Active",description:"Very hard exercise, physical job",details:"Professional athlete, manual labor, multiple daily workouts",icon:yi,multiplier:1.9}];function Jl({data:s,updateData:t,onStepCompleted:a,onNext:r,isCompleted:i}){const[l,n]=x.useState(s.activityLevel||""),d=p=>{n(p),t({activityLevel:p})},u=()=>{l&&(a(),r())};return e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(be,{className:"h-6 w-6 text-primary-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"What's Your Activity Level?"}),e.jsx("p",{className:"text-neutral-600",children:"This helps us calculate your daily calorie needs"})]}),e.jsx("div",{className:"grid gap-3",children:Yl.map(p=>{const o=p.icon,h=l===p.id;return e.jsx(g,{className:L("cursor-pointer transition-all duration-200 hover:shadow-md",h?"ring-2 ring-primary-500 bg-primary-50 border-primary-200":"hover:border-primary-200"),onClick:()=>d(p.id),children:e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:L("w-10 h-10 rounded-full flex items-center justify-center",h?"bg-primary-500":"bg-neutral-100"),children:e.jsx(o,{className:L("h-5 w-5",h?"text-white":"text-neutral-600")})}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-neutral-900",children:p.title}),e.jsxs("span",{className:"text-xs text-neutral-500 font-medium",children:[p.multiplier,"x"]})]}),e.jsx("p",{className:"text-neutral-600 text-sm",children:p.description}),e.jsx("p",{className:"text-neutral-500 text-xs",children:p.details})]}),e.jsx("div",{className:L("w-5 h-5 rounded-full border-2 flex items-center justify-center",h?"border-primary-500 bg-primary-500":"border-neutral-300"),children:h&&e.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})]})})},p.id)})}),e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx(v,{onClick:u,disabled:!l,className:"px-8",children:"Continue"})}),e.jsx("div",{className:"text-center text-xs text-neutral-500",children:e.jsx("p",{children:"Don't worry, you can change this later in your settings"})})]})}const Ql=[{id:"lose-weight",title:"Lose Weight",description:"Reduce body weight and body fat",icon:Tt,color:"text-red-500",bgColor:"bg-red-50",borderColor:"border-red-200",ringColor:"ring-red-500"},{id:"maintain-weight",title:"Maintain Weight",description:"Keep current weight stable",icon:Ni,color:"text-blue-500",bgColor:"bg-blue-50",borderColor:"border-blue-200",ringColor:"ring-blue-500"},{id:"gain-muscle",title:"Gain Muscle",description:"Build lean muscle mass",icon:ye,color:"text-green-500",bgColor:"bg-green-50",borderColor:"border-green-200",ringColor:"ring-green-500"}],Xl=Cs({targetWeight:bt().min(30,"Please enter a valid target weight").max(300,"Please enter a valid target weight").optional(),timeline:ae().optional()});function Zl({data:s,updateData:t,onStepCompleted:a,onNext:r,isCompleted:i}){const[l,n]=x.useState(s.primaryGoal||""),[d,u]=x.useState(!1),p=Hs({resolver:Gs(Xl),defaultValues:{targetWeight:s.targetWeight||void 0,timeline:s.timeline||""}}),o=f=>{n(f),t({primaryGoal:f}),f==="lose-weight"||f==="gain-muscle"?u(!0):(u(!1),h())},h=()=>{l&&(a(),r())},j=f=>{t({targetWeight:f.targetWeight,timeline:f.timeline}),h()};return e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(Mt,{className:"h-6 w-6 text-primary-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"What's Your Primary Goal?"}),e.jsx("p",{className:"text-neutral-600",children:"We'll customize your nutrition plan to help you achieve it"})]}),e.jsx("div",{className:"grid gap-4",children:Ql.map(f=>{const k=f.icon,c=l===f.id;return e.jsx(g,{className:L("cursor-pointer transition-all duration-200 hover:shadow-md",c?`ring-2 ${f.ringColor} ${f.bgColor} ${f.borderColor}`:"hover:border-primary-200"),onClick:()=>o(f.id),children:e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:L("w-12 h-12 rounded-full flex items-center justify-center",c?"bg-white":f.bgColor),children:e.jsx(k,{className:L("h-6 w-6",f.color)})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-neutral-900 text-lg",children:f.title}),e.jsx("p",{className:"text-neutral-600",children:f.description})]}),e.jsx("div",{className:L("w-6 h-6 rounded-full border-2 flex items-center justify-center",c?"border-primary-500 bg-primary-500":"border-neutral-300"),children:c&&e.jsx("div",{className:"w-2.5 h-2.5 bg-white rounded-full"})})]})})},f.id)})}),d&&l&&(l==="lose-weight"||l==="gain-muscle")&&e.jsx(g,{className:"bg-neutral-50 border-primary-200",children:e.jsxs(y,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ze,{className:"h-5 w-5 text-primary-600"}),e.jsx("h3",{className:"font-semibold text-neutral-900",children:"Additional Details (Optional)"})]}),e.jsx(Ys,{...p,children:e.jsxs("form",{onSubmit:p.handleSubmit(j),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(he,{control:p.control,name:"targetWeight",render:({field:f})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Target Weight (kg)"}),e.jsx(de,{children:e.jsx(I,{type:"number",placeholder:l==="lose-weight"?"65":"75",...f,onChange:k=>f.onChange(k.target.value?Number(k.target.value):void 0)})}),e.jsx(me,{})]})}),e.jsx(he,{control:p.control,name:"timeline",render:({field:f})=>e.jsxs(ce,{children:[e.jsx(oe,{children:"Timeline"}),e.jsxs(Z,{onValueChange:f.onChange,defaultValue:f.value,children:[e.jsx(de,{children:e.jsx(ee,{children:e.jsx(re,{placeholder:"Select timeline"})})}),e.jsxs(se,{children:[e.jsx(E,{value:"1-3 months",children:"1-3 Months"}),e.jsx(E,{value:"3-6 months",children:"3-6 Months"}),e.jsx(E,{value:"6-12 months",children:"6-12 Months"}),e.jsx(E,{value:"1+ years",children:"1+ Years"})]})]}),e.jsx(me,{})]})})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2",children:[e.jsx(v,{type:"button",variant:"ghost",onClick:h,children:"Skip Details"}),e.jsx(v,{type:"submit",children:"Continue"})]})]})})]})}),l==="maintain-weight"&&e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-sm text-neutral-600 mb-4",children:"Great! We'll help you maintain your current weight with balanced nutrition."})}),e.jsx("div",{className:"text-center text-xs text-neutral-500",children:e.jsx("p",{children:"Your goals can be adjusted anytime in your profile settings"})})]})}const ec=ft("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function P({className:s,variant:t,...a}){return e.jsx("div",{className:L(ec({variant:t}),s),...a})}const sc=[{id:"no-preference",title:"No Preference",description:"I eat everything",icon:ot,color:"text-neutral-600"},{id:"vegetarian",title:"Vegetarian",description:"No meat, but dairy and eggs are okay",icon:ns,color:"text-green-600"},{id:"vegan",title:"Vegan",description:"No animal products at all",icon:ns,color:"text-green-700"},{id:"pescatarian",title:"Pescatarian",description:"Fish is okay, but no other meat",icon:vi,color:"text-blue-600"},{id:"keto",title:"Keto",description:"Low-carb, high-fat diet",icon:Ft,color:"text-red-600"},{id:"paleo",title:"Paleo",description:"Whole foods, no processed items",icon:Ee,color:"text-orange-600"},{id:"gluten-free",title:"Gluten-Free",description:"No wheat, barley, or rye",icon:$a,color:"text-yellow-600"},{id:"halal",title:"Halal",description:"Following Islamic dietary laws",icon:Ee,color:"text-purple-600"}],tc=["Nuts","Peanuts","Shellfish","Fish","Eggs","Dairy","Soy","Wheat","Sesame"];function ac({data:s,updateData:t,onStepCompleted:a,onNext:r,isCompleted:i}){const[l,n]=x.useState(s.dietaryPreferences||[]),[d,u]=x.useState(s.allergies||[]),p=f=>{n(k=>{const c=k.includes(f)?k.filter(R=>R!==f):[...k,f];return t({dietaryPreferences:c}),c})},o=f=>{u(k=>{const c=k.includes(f)?k.filter(R=>R!==f):[...k,f];return t({allergies:c}),c})},h=()=>{a(),r()},j=()=>{t({dietaryPreferences:[],allergies:[]}),r()};return e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(ns,{className:"h-6 w-6 text-primary-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"Dietary Preferences"}),e.jsx("p",{className:"text-neutral-600",children:"Help us suggest meals that fit your lifestyle"})]}),e.jsx(g,{children:e.jsxs(y,{className:"p-6 space-y-4",children:[e.jsx("h3",{className:"font-semibold text-neutral-900",children:"Diet Type (Select all that apply)"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:sc.map(f=>{const k=f.icon,c=l.includes(f.id);return e.jsx(g,{className:L("cursor-pointer transition-all duration-200 hover:shadow-sm",c?"ring-2 ring-primary-500 bg-primary-50 border-primary-200":"hover:border-primary-200"),onClick:()=>p(f.id),children:e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(k,{className:L("h-5 w-5",f.color)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-neutral-900 text-sm",children:f.title}),e.jsx("p",{className:"text-neutral-600 text-xs truncate",children:f.description})]}),e.jsx("div",{className:L("w-4 h-4 rounded border-2 flex items-center justify-center",c?"border-primary-500 bg-primary-500":"border-neutral-300"),children:c&&e.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full"})})]})})},f.id)})})]})}),e.jsx(ts,{}),e.jsx(g,{children:e.jsxs(y,{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-neutral-900",children:"Food Allergies (Optional)"}),e.jsx("p",{className:"text-sm text-neutral-600",children:"We'll avoid suggesting foods with these ingredients"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:tc.map(f=>{const k=d.includes(f);return e.jsx(P,{variant:k?"default":"outline",className:L("cursor-pointer transition-colors",k?"bg-primary-500 hover:bg-primary-600":"hover:bg-primary-50 hover:border-primary-300"),onClick:()=>o(f),children:f},f)})}),d.length>0&&e.jsxs("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-orange-800",children:[e.jsx("strong",{children:"Selected allergies:"})," ",d.join(", ")]}),e.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"We'll exclude these ingredients from all meal suggestions."})]})]})}),e.jsxs("div",{className:"flex justify-between items-center pt-4",children:[e.jsx(v,{variant:"ghost",onClick:j,className:"text-neutral-500",children:"Skip This Step"}),e.jsx(v,{onClick:h,children:"Continue"})]}),e.jsx("div",{className:"text-center text-xs text-neutral-500",children:e.jsx("p",{children:"You can modify these preferences anytime in your settings"})})]})}const rc=["NutriBot","ChefAI","HealthyHelper","WellnessWiz","FitFriend","NutritionNinja"];function ic({data:s,updateData:t,onStepCompleted:a,onNext:r,isCompleted:i}){const[l,n]=x.useState(s.aiMealSuggestions!==void 0?s.aiMealSuggestions:!0),[d,u]=x.useState(s.aiChatAssistantName||""),p=f=>{n(f),t({aiMealSuggestions:f})},o=f=>{u(f),t({aiChatAssistantName:f})},h=()=>{a(),r()},j=()=>{t({aiMealSuggestions:!0,aiChatAssistantName:"NutriBot"}),r()};return e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-100 to-primary-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(js,{className:"h-6 w-6 text-primary-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"AI-Powered Features"}),e.jsx("p",{className:"text-neutral-600",children:"Customize how AI helps you reach your goals"})]}),e.jsx(g,{className:"bg-gradient-to-br from-purple-50 to-primary-50 border-primary-200",children:e.jsxs(y,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(es,{className:"h-6 w-6 text-primary-600"}),e.jsx("h3",{className:"font-semibold text-neutral-900",children:"How AI Helps You"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(bi,{className:"h-5 w-5 text-primary-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-neutral-900",children:"Smart Meal Suggestions"}),e.jsx("p",{className:"text-xs text-neutral-600",children:"Get personalized recipes based on your goals and preferences"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(wi,{className:"h-5 w-5 text-primary-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-neutral-900",children:"Nutrition Chat Assistant"}),e.jsx("p",{className:"text-xs text-neutral-600",children:"Ask questions about nutrition and get instant expert advice"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ki,{className:"h-5 w-5 text-primary-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-neutral-900",children:"Intelligent Insights"}),e.jsx("p",{className:"text-xs text-neutral-600",children:"Discover patterns in your eating habits and get improvement tips"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ye,{className:"h-5 w-5 text-primary-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-neutral-900",children:"Progress Optimization"}),e.jsx("p",{className:"text-xs text-neutral-600",children:"AI adjusts recommendations as you progress toward your goals"})]})]})]})]})}),e.jsx(g,{children:e.jsxs(y,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(C,{htmlFor:"ai-meals",className:"text-base font-medium",children:"AI Meal Suggestions"}),e.jsx("p",{className:"text-sm text-neutral-600",children:"Get daily personalized meal recommendations based on your goals"})]}),e.jsx(G,{id:"ai-meals",checked:l,onCheckedChange:p})]}),l&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-green-800",children:"✨ Great! You'll receive 3 personalized meal suggestions every day."})})]})}),e.jsx(g,{children:e.jsxs(y,{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"AI Chat Assistant Name (Optional)"}),e.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:"Give your AI nutrition assistant a friendly name"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(I,{placeholder:"Enter a custom name or choose from suggestions",value:d,onChange:f=>o(f.target.value),className:"w-full"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("p",{className:"text-xs text-neutral-500 w-full mb-1",children:"Quick suggestions:"}),rc.map(f=>e.jsx(v,{variant:"outline",size:"sm",onClick:()=>o(f),className:"text-xs h-7",children:f},f))]})]}),d&&e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:["👋 Hi! I'm ",e.jsx("strong",{children:d}),", your personal nutrition assistant."]})})]})}),e.jsxs("div",{className:"flex justify-between items-center pt-4",children:[e.jsx(v,{variant:"ghost",onClick:j,className:"text-neutral-500",children:"Use Defaults"}),e.jsx(v,{onClick:h,children:"Continue"})]}),e.jsx("div",{className:"text-center text-xs text-neutral-500",children:e.jsx("p",{children:"All AI features can be customized later in your settings"})})]})}function nc({data:s,updateData:t,onStepCompleted:a,onNext:r,isCompleted:i}){const[l,n]=x.useState(s.notificationsEnabled!==void 0?s.notificationsEnabled:!0),[d,u]=x.useState("default"),p=f=>{n(f),t({notificationsEnabled:f})},o=async()=>{if("Notification"in window)try{const f=await Notification.requestPermission();u(f),f==="granted"?(n(!0),t({notificationsEnabled:!0})):(n(!1),t({notificationsEnabled:!1}))}catch(f){console.error("Error requesting notification permission:",f),u("denied")}},h=()=>{a(),r()},j=()=>{t({notificationsEnabled:!1}),r()};return e.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(bs,{className:"h-6 w-6 text-primary-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"Stay on Track"}),e.jsx("p",{className:"text-neutral-600",children:"Get helpful reminders to maintain your nutrition goals"})]}),e.jsx(g,{className:"bg-gradient-to-br from-primary-50 to-white border-primary-200",children:e.jsxs(y,{className:"p-6 space-y-4",children:[e.jsxs("h3",{className:"font-semibold text-neutral-900 flex items-center gap-2",children:[e.jsx(bs,{className:"h-5 w-5 text-primary-600"}),"What you'll get"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Ve,{className:"h-5 w-5 text-primary-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-neutral-900",children:"Daily Meal Reminders"}),e.jsx("p",{className:"text-xs text-neutral-600",children:"Gentle nudges to log your meals and stay consistent"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ye,{className:"h-5 w-5 text-primary-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-neutral-900",children:"Progress Updates"}),e.jsx("p",{className:"text-xs text-neutral-600",children:"Weekly summaries of your nutrition achievements"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Zt,{className:"h-5 w-5 text-primary-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-neutral-900",children:"Smart Meal Suggestions"}),e.jsx("p",{className:"text-xs text-neutral-600",children:"AI-powered meal ideas delivered at the right time"})]})]})]})]})}),e.jsx(g,{children:e.jsxs(y,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(C,{htmlFor:"notifications",className:"text-base font-medium",children:"Enable Notifications"}),e.jsx("p",{className:"text-sm text-neutral-600",children:"Allow NutriScan to send you helpful reminders"})]}),e.jsx(G,{id:"notifications",checked:l,onCheckedChange:p})]}),l&&d==="default"&&e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("p",{className:"text-sm text-blue-800 mb-2",children:"🔔 To receive notifications, we need your browser's permission."}),e.jsx(v,{onClick:o,size:"sm",className:"w-full",children:"Allow Notifications"})]})}),d==="granted"&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-green-800",children:"✅ Perfect! You'll receive helpful reminders to stay on track."})}),d==="denied"&&e.jsx("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-orange-800",children:"ℹ️ Notifications are blocked. You can enable them later in your browser settings."})})]})}),e.jsx(g,{className:"bg-neutral-50",children:e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Ee,{className:"h-5 w-5 text-neutral-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm text-neutral-900",children:"Your Privacy"}),e.jsx("p",{className:"text-xs text-neutral-600",children:"We'll only send helpful, relevant notifications. No spam, ever. You can adjust or disable these anytime in your settings."})]})]})})}),e.jsxs("div",{className:"flex justify-between items-center pt-4",children:[e.jsx(v,{variant:"ghost",onClick:j,className:"text-neutral-500",children:"Skip for Now"}),e.jsx(v,{onClick:h,children:"Continue"})]})]})}function lc({data:s,onStepCompleted:t,isCompleted:a}){const[r,i]=x.useState(!1),[,l]=gt(),{user:n}=Le(),d=async()=>{i(!0);try{const h=["age","gender","height","weight","activityLevel","primaryGoal"].filter(R=>!s[R]);if(h.length>0)throw new Error(`Missing required fields: ${h.join(", ")}`);if(s.age&&(s.age<13||s.age>120))throw new Error("Age must be between 13 and 120");if(s.height&&(s.height<100||s.height>250))throw new Error("Height must be between 100cm and 250cm");if(s.weight&&(s.weight<30||s.weight>300))throw new Error("Weight must be between 30kg and 300kg");const j=["sedentary","light","moderate","active","extra-active"],f=["lose-weight","maintain-weight","gain-muscle"];if(!j.includes(s.activityLevel||""))throw new Error("Invalid activity level selected");if(!f.includes(s.primaryGoal||""))throw new Error("Invalid primary goal selected");const k=await ke("POST","/api/onboarding/complete",s),c=await k.json();if(k.ok)t(),setTimeout(()=>{l("/dashboard")},2e3);else{let R="Failed to complete onboarding";throw c.error&&(R=c.error),new Error(R)}}catch(o){console.error("Error completing onboarding:",o),o instanceof Error&&o.message.includes("401")?(alert("Authentication failed. Please log in again."),Je(),l("/login")):alert(`Error: ${o instanceof Error?o.message:"Unknown error occurred"}`),i(!1)}},u=o=>({sedentary:"Sedentary",light:"Lightly Active",moderate:"Moderately Active",active:"Very Active","extra-active":"Extremely Active"})[o]||o,p=o=>({"lose-weight":"Lose Weight","maintain-weight":"Maintain Weight","gain-muscle":"Gain Muscle"})[o]||o;return e.jsx("div",{className:"max-w-2xl mx-auto space-y-6",children:r?e.jsxs("div",{className:"text-center space-y-6 py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(Ue,{className:"h-8 w-8 text-primary-600 animate-spin"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"Setting Up Your Experience"}),e.jsx("p",{className:"text-neutral-600 mt-2",children:"We're personalizing your dashboard and preparing your AI recommendations..."})]}),e.jsx("div",{className:"max-w-xs mx-auto",children:e.jsx("div",{className:"h-2 bg-neutral-200 rounded-full",children:e.jsx("div",{className:"h-2 bg-primary-600 rounded-full animate-pulse",style:{width:"70%"}})})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-green-100 to-primary-100 rounded-full flex items-center justify-center mx-auto",children:e.jsx(fe,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-neutral-900",children:"You're All Set!"}),e.jsx("p",{className:"text-lg text-neutral-600 mt-2",children:"Here's a summary of your personalized nutrition profile"})]})]}),e.jsx(g,{className:"bg-gradient-to-br from-primary-50 to-white border-primary-200",children:e.jsxs(y,{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ns,{className:"h-5 w-5 text-primary-600"}),e.jsx("h3",{className:"font-semibold text-neutral-900",children:"Personal Information"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"Name:"}),e.jsx("p",{className:"font-medium",children:s.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"Age:"}),e.jsxs("p",{className:"font-medium",children:[s.age," years"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"Height:"}),e.jsxs("p",{className:"font-medium",children:[s.height," cm"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600",children:"Weight:"}),e.jsxs("p",{className:"font-medium",children:[s.weight," kg"]})]})]})]}),e.jsx(ts,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Mt,{className:"h-5 w-5 text-primary-600"}),e.jsx("h3",{className:"font-semibold text-neutral-900",children:"Goals & Activity"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-neutral-600 text-sm",children:"Primary Goal:"}),e.jsx(P,{variant:"default",children:p(s.primaryGoal||"")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-neutral-600 text-sm",children:"Activity Level:"}),e.jsx(P,{variant:"outline",children:u(s.activityLevel||"")})]}),s.targetWeight&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-neutral-600 text-sm",children:"Target Weight:"}),e.jsxs("span",{className:"font-medium",children:[s.targetWeight," kg"]})]}),s.timeline&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-neutral-600 text-sm",children:"Timeline:"}),e.jsx("span",{className:"font-medium",children:s.timeline})]})]})]}),e.jsx(ts,{}),(s.dietaryPreferences?.length||s.allergies?.length)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Zt,{className:"h-5 w-5 text-primary-600"}),e.jsx("h3",{className:"font-semibold text-neutral-900",children:"Dietary Preferences"})]}),e.jsxs("div",{className:"space-y-2",children:[s.dietaryPreferences&&s.dietaryPreferences.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600 text-sm",children:"Diet Types:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s.dietaryPreferences.map(o=>e.jsx(P,{variant:"outline",className:"text-xs",children:o.replace("-"," ")},o))})]}),s.allergies&&s.allergies.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-neutral-600 text-sm",children:"Allergies:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s.allergies.map(o=>e.jsx(P,{variant:"destructive",className:"text-xs",children:o},o))})]})]})]}),e.jsx(ts,{})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(js,{className:"h-5 w-5 text-primary-600"}),e.jsx("h3",{className:"font-semibold text-neutral-900",children:"AI Features"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-neutral-600 text-sm",children:"Meal Suggestions:"}),e.jsx(P,{variant:s.aiMealSuggestions?"default":"outline",children:s.aiMealSuggestions?"Enabled":"Disabled"})]}),s.aiChatAssistantName&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-neutral-600 text-sm",children:"AI Assistant:"}),e.jsx("span",{className:"font-medium",children:s.aiChatAssistantName})]})]})]}),e.jsx(ts,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"h-5 w-5 text-primary-600"}),e.jsx("h3",{className:"font-semibold text-neutral-900",children:"Notifications"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-neutral-600 text-sm",children:"Reminders:"}),e.jsx(P,{variant:s.notificationsEnabled?"default":"outline",children:s.notificationsEnabled?"Enabled":"Disabled"})]})]})]})}),e.jsx(g,{className:"bg-gradient-to-r from-primary-600 to-primary-700 text-white",children:e.jsxs(y,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold text-lg mb-3",children:"What's Next?"}),e.jsxs("div",{className:"space-y-2 text-sm text-primary-100",children:[e.jsx("p",{children:"• Your personalized dashboard is being prepared"}),e.jsx("p",{children:"• AI meal recommendations are being generated"}),e.jsx("p",{children:"• Daily nutrition goals are being calculated"}),e.jsx("p",{children:"• Your nutrition coach is getting ready to assist you"})]})]})}),e.jsx("div",{className:"text-center pt-4",children:e.jsx(v,{onClick:d,size:"lg",className:"px-8",children:"Start Tracking"})})]})})}const Na=[{id:"welcome",title:"Welcome",component:Vl,required:!0},{id:"account",title:"Account",component:Kl,required:!0},{id:"personal",title:"Personal Info",component:Gl,required:!0},{id:"activity",title:"Activity Level",component:Jl,required:!0},{id:"goals",title:"Goals",component:Zl,required:!0},{id:"diet",title:"Diet Preferences",component:ac,required:!1},{id:"ai",title:"AI Features",component:ic,required:!1},{id:"notifications",title:"Notifications",component:nc,required:!1},{id:"summary",title:"Summary",component:lc,required:!0}],cc=s=>s?Na.filter(t=>t.id!=="account"):Na;function oc(){const{user:s}=Le(),t=cc(!!s),a=0,[r,i]=x.useState(a),[l,n]=x.useState({}),[d,u]=x.useState(new Set);if(s?.onboardingCompleted)return e.jsx(aa,{to:"/dashboard"});const p=S=>{n(q=>({...q,...S}))},o=S=>{u(q=>new Set([...Array.from(q),S]))},h=()=>t[r].required?d.has(r):!0,j=()=>{r<t.length-1&&i(r+1)},f=()=>{r>0&&i(r-1)},k=()=>{t[r].required||j()},c=(r+1)/t.length*100,R=x.useCallback(()=>{o(r)},[r]),D=t[r].component;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-white",children:[e.jsx("div",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-sm border-b border-primary-100",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h1",{className:"text-sm font-medium text-primary-600",children:["Step ",r+1," of ",t.length]}),e.jsx("span",{className:"text-sm text-neutral-500",children:t[r].title})]}),e.jsx(we,{value:c,className:"h-2"})]})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 py-8",children:e.jsx(rn,{mode:"wait",children:e.jsx(nn.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"min-h-[calc(100vh-200px)]",children:e.jsx(D,{data:l,updateData:p,onStepCompleted:R,onNext:j,isCompleted:d.has(r)})},r)})}),e.jsx("div",{className:"sticky bottom-0 bg-white border-t border-primary-100 px-4 py-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[e.jsxs(v,{variant:"outline",onClick:f,disabled:r===0,className:"flex items-center gap-2",children:[e.jsx(ea,{className:"h-4 w-4"}),"Back"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[!t[r].required&&r!==0&&r!==t.length-1&&e.jsx(v,{variant:"ghost",onClick:k,className:"text-neutral-500 hover:text-neutral-700",children:"Skip"}),e.jsxs(v,{onClick:j,disabled:!h()||r===t.length-1,className:"flex items-center gap-2",children:[r===t.length-1?"Complete":"Next",e.jsx(at,{className:"h-4 w-4"})]})]})]})})]})}const fs=x.forwardRef(({className:s,...t},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:L("w-full caption-bottom text-sm",s),...t})}));fs.displayName="Table";const nt=x.forwardRef(({className:s,...t},a)=>e.jsx("thead",{ref:a,className:L("[&_tr]:border-b",s),...t}));nt.displayName="TableHeader";const gs=x.forwardRef(({className:s,...t},a)=>e.jsx("tbody",{ref:a,className:L("[&_tr:last-child]:border-0",s),...t}));gs.displayName="TableBody";const dc=x.forwardRef(({className:s,...t},a)=>e.jsx("tfoot",{ref:a,className:L("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...t}));dc.displayName="TableFooter";const Fe=x.forwardRef(({className:s,...t},a)=>e.jsx("tr",{ref:a,className:L("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...t}));Fe.displayName="TableRow";const te=x.forwardRef(({className:s,...t},a)=>e.jsx("th",{ref:a,className:L("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...t}));te.displayName="TableHead";const H=x.forwardRef(({className:s,...t},a)=>e.jsx("td",{ref:a,className:L("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...t}));H.displayName="TableCell";const mc=x.forwardRef(({className:s,...t},a)=>e.jsx("caption",{ref:a,className:L("mt-4 text-sm text-muted-foreground",s),...t}));mc.displayName="TableCaption";const Bs=Ei,xc=Si,Nr=x.forwardRef(({className:s,...t},a)=>e.jsx(za,{ref:a,className:L("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));Nr.displayName=za.displayName;const Ds=x.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(xc,{children:[e.jsx(Nr,{}),e.jsxs(_a,{ref:r,className:L("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a,children:[t,e.jsxs(Ci,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Qt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ds.displayName=_a.displayName;const Ms=({className:s,...t})=>e.jsx("div",{className:L("flex flex-col space-y-1.5 text-center sm:text-left",s),...t});Ms.displayName="DialogHeader";const yt=({className:s,...t})=>e.jsx("div",{className:L("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t});yt.displayName="DialogFooter";const Ls=x.forwardRef(({className:s,...t},a)=>e.jsx(qa,{ref:a,className:L("text-lg font-semibold leading-none tracking-tight",s),...t}));Ls.displayName=qa.displayName;const hc=x.forwardRef(({className:s,...t},a)=>e.jsx(Ba,{ref:a,className:L("text-sm text-muted-foreground",s),...t}));hc.displayName=Ba.displayName;async function pe(s,t={}){const a=Oe(),r=new Headers(t.headers);a&&r.set("Authorization",`Bearer ${a}`),t.body&&!r.has("Content-Type")&&(r.set("Content-Type","application/json"),typeof t.body=="object"&&t.body!==null&&(t.body=JSON.stringify(t.body)));const i={...t,headers:r};try{const l=await fetch(s,i);return l.status===401&&console.warn("API request failed with 401 - token might be expired"),l}catch(l){throw console.error("API request failed:",l),l}}async function Pt(s,t,a={}){return pe(s,{...a,method:"POST",body:t?JSON.stringify(t):void 0})}async function uc(s,t,a={}){return pe(s,{...a,method:"PUT",body:t?JSON.stringify(t):void 0})}async function jc(s,t={}){return pe(s,{...t,method:"DELETE"})}function pc(){const[s,t]=x.useState([]),[a,r]=x.useState("openai"),[i,l]=x.useState({}),n=Ss(),{toast:d}=ve(),{data:u,isLoading:p}=W({queryKey:["ai-configs"],queryFn:async()=>{const c=await pe("/api/admin/ai-config");if(!c.ok)throw new Error("Failed to fetch AI configurations");return c.json()}}),o=J({mutationFn:async({id:c,data:R})=>{const D=await pe(`/api/admin/ai-config/${c}`,{method:"PUT",body:R});if(!D.ok)throw new Error("Failed to update AI configuration");return D.json()},onSuccess:()=>{d({title:"Success",description:"AI configuration updated successfully"}),n.invalidateQueries({queryKey:["ai-configs"]})},onError:c=>{d({title:"Error",description:`Failed to update configuration: ${c instanceof Error?c.message:"Unknown error"}`,variant:"destructive"})}}),h=J({mutationFn:async c=>{const R=await pe(`/api/admin/ai-config/${c}/activate`,{method:"POST"});if(!R.ok)throw new Error("Failed to activate AI provider");return R.json()},onSuccess:()=>{d({title:"Success",description:"AI provider activated successfully"}),n.invalidateQueries({queryKey:["ai-configs"]})},onError:c=>{d({title:"Error",description:`Failed to activate provider: ${c instanceof Error?c.message:"Unknown error"}`,variant:"destructive"})}});x.useEffect(()=>{if(u){t(u);const c={};u.forEach(R=>{c[R.provider]={apiKey:"",modelName:R.modelName,temperature:R.temperature/100,maxTokens:R.maxTokens,promptTemplate:R.promptTemplate}}),l(c)}},[u]);const j=(c,R,D)=>{l(S=>({...S,[c]:{...S[c],[R]:D}}))},f=async c=>{const R=s.find(S=>S.provider===c);if(!R)return;const D={...i[c],temperature:Math.round(i[c].temperature*100)};D.apiKey&&D.apiKey.trim()?D.apiKey=D.apiKey.trim():delete D.apiKey,await o.mutateAsync({id:R.id,data:D})},k=async c=>{const R=s.find(D=>D.provider===c);R&&await h.mutateAsync(R.id)};return p?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(es,{className:"h-8 w-8 animate-spin mx-auto mb-2"}),e.jsx("p",{children:"Loading AI configurations..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-lg flex items-center justify-center",children:e.jsx(js,{className:"h-6 w-6 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"AI Configuration"}),e.jsx("p",{className:"text-neutral-600",children:"Manage AI providers for food image analysis"})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"h-5 w-5"}),"Current Status"]})}),e.jsx(y,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(c=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${c.isActive?"bg-green-500":"bg-gray-300"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium capitalize",children:c.provider}),e.jsx("p",{className:"text-sm text-neutral-600",children:c.modelName})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[c.hasApiKey?e.jsxs(P,{variant:"default",children:[e.jsx(Va,{className:"h-3 w-3 mr-1"}),"Configured"]}):e.jsxs(P,{variant:"outline",children:[e.jsx(as,{className:"h-3 w-3 mr-1"}),"No API Key"]}),c.isActive&&e.jsxs(P,{variant:"secondary",children:[e.jsx(fe,{className:"h-3 w-3 mr-1"}),"Active"]})]})]},c.id))})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Provider Configuration"})}),e.jsx(y,{children:e.jsxs(Te,{value:a,onValueChange:r,children:[e.jsxs(Se,{className:"grid w-full grid-cols-3",children:[e.jsx(U,{value:"openai",children:"OpenAI"}),e.jsx(U,{value:"gemini",children:"Google Gemini"}),e.jsx(U,{value:"testing",children:"AI Testing"})]}),e.jsx($,{value:"openai",className:"space-y-4 mt-6",children:i.openai&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"openai-api-key",children:"API Key"}),e.jsx(I,{id:"openai-api-key",type:"password",placeholder:"sk-...",value:i.openai.apiKey,onChange:c=>j("openai","apiKey",c.target.value)}),e.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"Leave empty to keep existing key"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"openai-model",children:"Model Name"}),e.jsx(I,{id:"openai-model",value:i.openai.modelName,onChange:c=>j("openai","modelName",c.target.value)})]}),e.jsxs("div",{children:[e.jsxs(C,{htmlFor:"openai-temperature",children:["Temperature (",i.openai.temperature,")"]}),e.jsx(I,{id:"openai-temperature",type:"range",min:"0",max:"1",step:"0.1",value:i.openai.temperature,onChange:c=>j("openai","temperature",parseFloat(c.target.value))})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"openai-tokens",children:"Max Tokens"}),e.jsx(I,{id:"openai-tokens",type:"number",value:i.openai.maxTokens,onChange:c=>j("openai","maxTokens",parseInt(c.target.value))})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"openai-prompt",children:"Prompt Template"}),e.jsx($e,{id:"openai-prompt",rows:4,value:i.openai.promptTemplate,onChange:c=>j("openai","promptTemplate",c.target.value)})]}),e.jsx(ts,{}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(v,{onClick:()=>f("openai"),disabled:o.isPending,children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Save Configuration"]}),e.jsx(v,{variant:"outline",onClick:()=>k("openai"),disabled:h.isPending,children:"Set as Active Provider"})]})]})}),e.jsx($,{value:"gemini",className:"space-y-4 mt-6",children:i.gemini&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"gemini-api-key",children:"API Key"}),e.jsx(I,{id:"gemini-api-key",type:"password",placeholder:"AI...",value:i.gemini.apiKey,onChange:c=>j("gemini","apiKey",c.target.value)}),e.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"Get your API key from Google AI Studio"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"gemini-model",children:"Model Name"}),e.jsx(I,{id:"gemini-model",value:i.gemini.modelName,onChange:c=>j("gemini","modelName",c.target.value)})]}),e.jsxs("div",{children:[e.jsxs(C,{htmlFor:"gemini-temperature",children:["Temperature (",i.gemini.temperature,")"]}),e.jsx(I,{id:"gemini-temperature",type:"range",min:"0",max:"1",step:"0.1",value:i.gemini.temperature,onChange:c=>j("gemini","temperature",parseFloat(c.target.value))})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"gemini-tokens",children:"Max Tokens"}),e.jsx(I,{id:"gemini-tokens",type:"number",value:i.gemini.maxTokens,onChange:c=>j("gemini","maxTokens",parseInt(c.target.value))})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"gemini-prompt",children:"Prompt Template"}),e.jsx($e,{id:"gemini-prompt",rows:4,value:i.gemini.promptTemplate,onChange:c=>j("gemini","promptTemplate",c.target.value)})]}),e.jsx(ts,{}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(v,{onClick:()=>f("gemini"),disabled:o.isPending,children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Save Configuration"]}),e.jsx(v,{variant:"outline",onClick:()=>k("gemini"),disabled:h.isPending,children:"Set as Active Provider"})]})]})}),e.jsx($,{value:"testing",className:"space-y-4 mt-6",children:e.jsx(fc,{configs:s})})]})})]})]})}function fc({configs:s}){const[t,a]=x.useState(""),[r,i]=x.useState(null),[l,n]=x.useState(!1),{toast:d}=ve(),u=h=>{const j=h.target.files?.[0];if(j){const f=new FileReader;f.onload=k=>{a(k.target?.result),i(null)},f.readAsDataURL(j)}},p=async()=>{if(!t){d({title:"Error",description:"Please upload an image first",variant:"destructive"});return}n(!0);try{const h=await fetch("/api/demo-analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageData:t})});if(!h.ok)throw new Error("AI analysis failed");const j=await h.json();i(j),d({title:"Success",description:"AI analysis completed successfully"})}catch(h){console.error("Error testing AI:",h),d({title:"Error",description:"AI analysis failed. Check your configuration.",variant:"destructive"})}finally{n(!1)}},o=s.find(h=>h.isActive);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(es,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-900",children:"AI Testing Panel"}),e.jsx("p",{className:"text-neutral-600",children:"Test your AI configuration with sample images"})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{className:"text-base",children:"Active Configuration"})}),e.jsx(y,{children:o?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:o.provider.toUpperCase()}),e.jsx("p",{className:"text-sm text-neutral-600",children:o.modelName})]}),e.jsxs(P,{variant:"default",children:[e.jsx(fe,{className:"h-3 w-3 mr-1"}),"Active"]})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(as,{className:"h-8 w-8 text-amber-500 mx-auto mb-2"}),e.jsx("p",{className:"text-neutral-600",children:"No AI provider is currently active"}),e.jsx("p",{className:"text-sm text-neutral-500",children:"Configure and activate a provider to test"})]})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{className:"text-base",children:"Upload Test Image"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsx(I,{type:"file",accept:"image/*",onChange:u,disabled:!o}),t&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"max-w-xs mx-auto",children:e.jsx("img",{src:t,alt:"Test food",className:"w-full h-auto rounded-lg border"})}),e.jsx(v,{onClick:p,disabled:l||!o,className:"w-full",children:l?e.jsxs(e.Fragment,{children:[e.jsx(es,{className:"h-4 w-4 mr-2 animate-spin"}),"Analyzing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(js,{className:"h-4 w-4 mr-2"}),"Test AI Analysis"]})})]})]})]}),r&&e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{className:"text-base",children:"Analysis Results"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Calories"}),e.jsx("p",{className:"text-xl font-bold text-green-800",children:r.calories})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Protein"}),e.jsxs("p",{className:"text-xl font-bold text-blue-800",children:[r.protein,"g"]})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Carbs"}),e.jsxs("p",{className:"text-xl font-bold text-orange-800",children:[r.carbs,"g"]})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"Fat"}),e.jsxs("p",{className:"text-xl font-bold text-purple-800",children:[r.fat,"g"]})]})]}),e.jsxs("div",{children:[e.jsx(C,{className:"font-medium",children:"Food Identified:"}),e.jsx("p",{className:"text-lg",children:r.foodName})]}),r.fiber&&e.jsxs("div",{children:[e.jsx(C,{className:"font-medium",children:"Fiber:"}),e.jsxs("p",{children:[r.fiber,"g"]})]})]})})]})]})}const gc=ft("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),vr=x.forwardRef(({className:s,variant:t,...a},r)=>e.jsx("div",{ref:r,role:"alert",className:L(gc({variant:t}),s),...a}));vr.displayName="Alert";const yc=x.forwardRef(({className:s,...t},a)=>e.jsx("h5",{ref:a,className:L("mb-1 font-medium leading-none tracking-tight",s),...t}));yc.displayName="AlertTitle";const br=x.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:L("text-sm [&_p]:leading-relaxed",s),...t}));br.displayName="AlertDescription";const ys=x.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(Ha,{ref:r,className:L("relative overflow-hidden",s),...a,children:[e.jsx(Ti,{className:"h-full w-full rounded-[inherit]",children:t}),e.jsx(wr,{}),e.jsx(Ai,{})]}));ys.displayName=Ha.displayName;const wr=x.forwardRef(({className:s,orientation:t="vertical",...a},r)=>e.jsx(Ka,{ref:r,orientation:t,className:L("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...a,children:e.jsx(Ri,{className:"relative flex-1 rounded-full bg-border"})}));wr.displayName=Ka.displayName;function Nc(){const[s,t]=x.useState("overview"),[a,r]=x.useState(!0),[i,l]=x.useState(5e3),[n,d]=x.useState({type:"all",severity:"all",resolved:"all"}),{toast:u}=ve(),p=Ss(),{data:o,isLoading:h}=W({queryKey:["system-metrics"],queryFn:async()=>{const N=await fetch("/api/admin/system/metrics/detailed");if(!N.ok)throw new Error("Failed to fetch system metrics");return N.json()},refetchInterval:a?i:!1,staleTime:1e3}),{data:j}=W({queryKey:["service-status"],queryFn:async()=>{const N=await fetch("/api/admin/system/services/status");if(!N.ok)throw new Error("Failed to fetch service status");return N.json()},refetchInterval:a?1e4:!1}),{data:f}=W({queryKey:["system-alerts",n],queryFn:async()=>{const N=new URLSearchParams(n),F=await fetch(`/api/admin/system/alerts?${N}`);if(!F.ok)throw new Error("Failed to fetch system alerts");return F.json()},refetchInterval:a?15e3:!1}),{data:k}=W({queryKey:["system-logs"],queryFn:async()=>{const N=await fetch("/api/admin/system/logs?limit=100");if(!N.ok)throw new Error("Failed to fetch system logs");return N.json()},refetchInterval:a?3e4:!1}),c=J({mutationFn:async N=>{const F=await pe(`/api/admin/system/services/${N}/restart`,{method:"POST"});if(!F.ok)throw new Error("Failed to restart service");return F.json()},onSuccess:(N,F)=>{u({title:`Service ${F} restarted successfully`}),p.invalidateQueries({queryKey:["service-status"]})},onError:(N,F)=>{u({title:`Failed to restart ${F}`,description:N.message,variant:"destructive"})}}),R=J({mutationFn:async N=>{const F=await pe(`/api/admin/system/alerts/${N}/resolve`,{method:"POST"});if(!F.ok)throw new Error("Failed to resolve alert");return F.json()},onSuccess:()=>{u({title:"Alert resolved successfully"}),p.invalidateQueries({queryKey:["system-alerts"]})},onError:N=>{u({title:"Failed to resolve alert",description:N.message,variant:"destructive"})}}),D=N=>({healthy:"text-green-600 bg-green-100",warning:"text-yellow-600 bg-yellow-100",critical:"text-red-600 bg-red-100",offline:"text-gray-600 bg-gray-100"})[N]||"text-gray-600 bg-gray-100",S=N=>({low:"border-l-green-500 bg-green-50",medium:"border-l-yellow-500 bg-yellow-50",high:"border-l-orange-500 bg-orange-50",critical:"border-l-red-500 bg-red-50"})[N]||"border-l-gray-500 bg-gray-50",q=N=>({debug:"text-gray-600",info:"text-blue-600",warn:"text-yellow-600",error:"text-red-600",fatal:"text-red-800 font-bold"})[N]||"text-gray-600",T=N=>{const F=["B","KB","MB","GB","TB"];let A=0,_=N;for(;_>=1024&&A<F.length-1;)_/=1024,A++;return`${_.toFixed(1)} ${F[A]}`},m=N=>{const F=Math.floor(N/86400),A=Math.floor(N%86400/3600),_=Math.floor(N%3600/60);return F>0?`${F}d ${A}h ${_}m`:A>0?`${A}h ${_}m`:`${_}m`};return h?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(be,{className:"h-8 w-8 animate-spin mx-auto mb-2"}),e.jsx("p",{children:"Loading system metrics..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Pi,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"Enhanced System Monitor"}),e.jsx("p",{className:"text-neutral-600",children:"Real-time system performance and health monitoring"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{htmlFor:"auto-refresh",children:"Auto Refresh"}),e.jsx(G,{id:"auto-refresh",checked:a,onCheckedChange:r})]}),a&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{htmlFor:"refresh-interval",children:"Interval (ms)"}),e.jsx(I,{id:"refresh-interval",type:"number",value:i,onChange:N=>l(Number(N.target.value)),className:"w-20",min:"1000",max:"60000",step:"1000"})]}),e.jsxs(v,{onClick:()=>p.invalidateQueries(),variant:"outline",size:"sm",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Refresh All"]})]})]}),(f?.filter(N=>N.severity==="critical"&&!N.resolved).length||0)>0&&e.jsxs(vr,{className:"border-red-200 bg-red-50",children:[e.jsx(rs,{className:"h-4 w-4"}),e.jsxs(br,{className:"text-red-800",children:[e.jsx("strong",{children:"Critical System Alerts:"})," ",(f||[]).filter(N=>N.severity==="critical"&&!N.resolved).length," critical issues require immediate attention."]})]}),e.jsxs(Te,{value:s,onValueChange:t,children:[e.jsxs(Se,{className:"grid grid-cols-6 w-full",children:[e.jsx(U,{value:"overview",children:"Overview"}),e.jsx(U,{value:"performance",children:"Performance"}),e.jsx(U,{value:"services",children:"Services"}),e.jsx(U,{value:"alerts",children:"Alerts"}),e.jsx(U,{value:"logs",children:"Logs"}),e.jsx(U,{value:"analytics",children:"Analytics"})]}),e.jsx($,{value:"overview",className:"space-y-6",children:o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"System Uptime"}),e.jsx(Ve,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:m(o.application.uptime)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[o.application.uptime>604800?"Excellent":"Good"," uptime"]})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Response Time"}),e.jsx(Ze,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[o.application.responseTime,"ms"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Average response time"})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Active Users"}),e.jsx(Me,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.application.userSessions}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Current active sessions"})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"AI Cost/Hour"}),e.jsx(es,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",o.ai.costPerHour.toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Current AI usage cost"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(Ii,{className:"h-5 w-5"}),"CPU & Memory Usage"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"CPU Usage"}),e.jsxs("span",{className:"font-medium",children:[o.cpu.usage,"%"]})]}),e.jsx(we,{value:o.cpu.usage,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{children:[o.cpu.cores," cores @ ",o.cpu.frequency,"GHz"]}),e.jsxs("span",{children:[o.cpu.temperature,"°C"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Memory Usage"}),e.jsxs("span",{className:"font-medium",children:[T(o.memory.used)," / ",T(o.memory.total)]})]}),e.jsx(we,{value:o.memory.used/o.memory.total*100,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{children:["Available: ",T(o.memory.available)]}),e.jsxs("span",{children:["Cached: ",T(o.memory.cached)]})]})]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(vt,{className:"h-5 w-5"}),"Storage & Network"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Disk Usage"}),e.jsxs("span",{className:"font-medium",children:[T(o.disk.used)," / ",T(o.disk.total)]})]}),e.jsx(we,{value:o.disk.used/o.disk.total*100,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{children:["Read: ",T(o.disk.readSpeed),"/s"]}),e.jsxs("span",{children:["Write: ",T(o.disk.writeSpeed),"/s"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Network Traffic"}),e.jsxs("span",{className:"font-medium",children:[o.network.connections," connections"]})]}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(_e,{className:"h-3 w-3 mr-1"}),T(o.network.bytesIn),"/s"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(ct,{className:"h-3 w-3 mr-1"}),T(o.network.bytesOut),"/s"]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(ms,{className:"h-5 w-5"}),"Database Performance"]})}),e.jsxs(y,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Active Connections"}),e.jsx("span",{className:"font-medium",children:o.database.connections})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Active Queries"}),e.jsx("span",{className:"font-medium",children:o.database.activeQueries})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Avg Query Time"}),e.jsxs("span",{className:"font-medium",children:[o.database.queryTime,"ms"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Cache Hit Rate"}),e.jsxs("span",{className:"font-medium",children:[o.database.cacheHitRate,"%"]})]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(es,{className:"h-5 w-5"}),"AI Service Performance"]})}),e.jsxs(y,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"API Calls (Last Hour)"}),e.jsx("span",{className:"font-medium",children:o.ai.apiCalls})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Success Rate"}),e.jsxs("span",{className:"font-medium",children:[o.ai.successRate,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Average Latency"}),e.jsxs("span",{className:"font-medium",children:[o.ai.averageLatency,"ms"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Queue Length"}),e.jsx("span",{className:"font-medium",children:o.ai.queueLength})]})]})]})]})]})}),e.jsx($,{value:"services",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"h-5 w-5"}),"Service Status"]})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-4",children:j?.map(N=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${N.status==="healthy"?"bg-green-500":N.status==="warning"?"bg-yellow-500":N.status==="critical"?"bg-red-500":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:N.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Uptime: ",m(N.uptime)," • Response: ",N.responseTime,"ms"]}),e.jsx("div",{className:"flex items-center space-x-2 mt-1",children:N.dependencies.map(F=>e.jsx(P,{variant:"outline",className:"text-xs",children:F},F))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:D(N.status),children:N.status}),N.status!=="healthy"&&e.jsx(v,{size:"sm",onClick:()=>c.mutate(N.name),disabled:c.isPending,children:"Restart"})]})]},N.name))})})]})}),e.jsx($,{value:"alerts",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-5 w-5"}),"System Alerts"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:n.severity,onChange:N=>d({...n,severity:N.target.value}),className:"text-sm border rounded px-2 py-1",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]}),e.jsxs("select",{value:n.resolved,onChange:N=>d({...n,resolved:N.target.value}),className:"text-sm border rounded px-2 py-1",children:[e.jsx("option",{value:"all",children:"All Alerts"}),e.jsx("option",{value:"false",children:"Unresolved"}),e.jsx("option",{value:"true",children:"Resolved"})]})]})]})}),e.jsx(y,{children:e.jsx(ys,{className:"h-96",children:e.jsxs("div",{className:"space-y-3",children:[f?.map(N=>e.jsx("div",{className:`p-4 rounded-lg border-l-4 ${S(N.severity)}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h3",{className:"font-medium",children:N.title}),e.jsx(P,{variant:N.severity==="critical"?"destructive":"secondary",children:N.severity}),N.resolved&&e.jsxs(P,{variant:"default",children:[e.jsx(fe,{className:"h-3 w-3 mr-1"}),"Resolved"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:N.message}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[new Date(N.timestamp).toLocaleString(),N.resolvedBy&&e.jsxs("span",{children:[" • Resolved by ",N.resolvedBy," at ",new Date(N.resolvedAt).toLocaleString()]})]})]}),!N.resolved&&e.jsx(v,{size:"sm",onClick:()=>R.mutate(N.id),disabled:R.isPending,children:"Resolve"})]})},N.id)),(!f||f.length===0)&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(fe,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No system alerts match the current filters."})]})]})})})]})}),e.jsx($,{value:"logs",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-5 w-5"}),"System Logs"]})}),e.jsx(y,{children:e.jsx(ys,{className:"h-96",children:e.jsx("div",{className:"space-y-2",children:k?.map(N=>e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{variant:"outline",className:q(N.level),children:N.level.toUpperCase()}),e.jsx("span",{className:"text-sm font-medium",children:N.service}),e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(N.timestamp).toLocaleString()})]})}),e.jsx("p",{className:"text-sm mt-1",children:N.message}),N.metadata&&e.jsx("pre",{className:"text-xs bg-gray-100 p-2 rounded mt-2 overflow-auto",children:JSON.stringify(N.metadata,null,2)})]},N.id))})})})]})}),e.jsx($,{value:"analytics",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(It,{className:"h-5 w-5"}),"Performance Trends"]})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Response Time Trend"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ye,{className:"h-4 w-4 text-green-500 mr-1"}),e.jsx("span",{className:"text-sm text-green-600",children:"Improving"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Error Rate Trend"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Tt,{className:"h-4 w-4 text-green-500 mr-1"}),e.jsx("span",{className:"text-sm text-green-600",children:"Decreasing"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Memory Usage Trend"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ye,{className:"h-4 w-4 text-yellow-500 mr-1"}),e.jsx("span",{className:"text-sm text-yellow-600",children:"Increasing"})]})]})]})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(Dt,{className:"h-5 w-5"}),"Resource Distribution"]})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"CPU Usage"}),e.jsxs("span",{className:"font-medium",children:[o?.cpu.usage,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Memory Usage"}),e.jsxs("span",{className:"font-medium",children:[o?Math.round(o.memory.used/o.memory.total*100):0,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Disk Usage"}),e.jsxs("span",{className:"font-medium",children:[o?Math.round(o.disk.used/o.disk.total*100):0,"%"]})]})]})})]})]})})]})]})}function vc(){const[s,t]=x.useState(""),[a,r]=x.useState("all"),[i,l]=x.useState("all"),[n,d]=x.useState(null),[u,p]=x.useState(null),[o,h]=x.useState(!1),[j,f]=x.useState(!1),[k,c]=x.useState([]),[R,D]=x.useState("overview"),{toast:S}=ve();Ss();const{data:q=[],isLoading:T,refetch:m}=W({queryKey:["admin-users",s,a,i],queryFn:async()=>{const z=new URLSearchParams;s&&z.append("search",s),a!=="all"&&z.append("role",a),i!=="all"&&z.append("premium",i);const M=await pe(`/api/admin/users/advanced?${z}`);if(!M.ok)throw new Error("Failed to fetch users");return M.json()}}),{data:N}=W({queryKey:["admin-user-stats"],queryFn:async()=>{const z=await pe("/api/admin/users/stats");if(!z.ok)throw new Error("Failed to fetch user stats");return z.json()}}),F=J({mutationFn:async z=>{const M=await pe("/api/admin/users",{method:"POST",body:z});if(!M.ok)throw new Error("Failed to create user");return M.json()},onSuccess:()=>{S({title:"User created successfully"}),h(!1),m()},onError:z=>{S({title:"Error creating user",description:z.message,variant:"destructive"})}}),A=J({mutationFn:async({id:z,data:M})=>{const xe=await pe(`/api/admin/users/${z}`,{method:"PUT",body:M});if(!xe.ok)throw new Error("Failed to update user");return xe.json()},onSuccess:()=>{S({title:"User updated successfully"}),p(null),m()},onError:z=>{S({title:"Error updating user",description:z.message,variant:"destructive"})}}),_=J({mutationFn:async({operation:z,userIds:M,data:xe})=>{const Ke=await pe("/api/admin/users/bulk",{method:"POST",body:{operation:z,userIds:M,data:xe}});if(!Ke.ok)throw new Error("Failed to perform bulk operation");return Ke.json()},onSuccess:()=>{S({title:"Bulk operation completed successfully"}),c([]),m()},onError:z=>{S({title:"Error performing bulk operation",description:z.message,variant:"destructive"})}}),Q=(z,M)=>{c(M?[...k,z]:k.filter(xe=>xe!==z))},ie=z=>{c(z?q.map(M=>M.id):[])},ge=()=>{const z=[["ID","Username","Email","Role","Premium","Registration Date"],...q.map(O=>[O.id,O.username,O.email||"",O.role,O.isPremium?"Yes":"No",new Date(O.stats?.registrationDate||"").toLocaleDateString()])].map(O=>O.join(",")).join(`
`),M=new Blob([z],{type:"text/csv"}),xe=window.URL.createObjectURL(M),Ke=document.createElement("a");Ke.href=xe,Ke.download="users-export.csv",Ke.click(),window.URL.revokeObjectURL(xe)},ne=q.filter(z=>z.username.toLowerCase().includes(s.toLowerCase())||(z.email||"").toLowerCase().includes(s.toLowerCase()));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Me,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"Advanced User Management"}),e.jsx("p",{className:"text-neutral-600",children:"Comprehensive user administration and analytics"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(v,{onClick:ge,variant:"outline",children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Export"]}),e.jsxs(v,{onClick:()=>h(!0),children:[e.jsx(Fi,{className:"h-4 w-4 mr-2"}),"Add User"]})]})]}),e.jsxs(Te,{value:R,onValueChange:D,children:[e.jsxs(Se,{children:[e.jsx(U,{value:"overview",children:"Overview"}),e.jsx(U,{value:"users",children:"User Management"}),e.jsx(U,{value:"analytics",children:"Analytics"}),e.jsx(U,{value:"bulk",children:"Bulk Operations"})]}),e.jsx($,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(Me,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:N?.totalUsers||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["+",N?.newUsersThisWeek||0," this week"]})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Premium Users"}),e.jsx(qs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:N?.premiumUsers||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[((N?.premiumUsers||0)/(N?.totalUsers||1)*100).toFixed(1),"% conversion"]})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Active Today"}),e.jsx(be,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:N?.activeToday||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[((N?.activeToday||0)/(N?.totalUsers||1)*100).toFixed(1),"% engagement"]})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Avg. Revenue"}),e.jsx(qs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",N?.avgRevenue||0]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Per premium user"})]})]})]})}),e.jsxs($,{value:"users",className:"space-y-6",children:[e.jsx(g,{children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(mt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(I,{placeholder:"Search users by username or email...",value:s,onChange:z=>t(z.target.value),className:"pl-10"})]})}),e.jsxs(Z,{value:a,onValueChange:r,children:[e.jsx(ee,{className:"w-48",children:e.jsx(re,{placeholder:"Filter by role"})}),e.jsxs(se,{children:[e.jsx(E,{value:"all",children:"All Roles"}),e.jsx(E,{value:"user",children:"User"}),e.jsx(E,{value:"admin",children:"Admin"})]})]}),e.jsxs(Z,{value:i,onValueChange:l,children:[e.jsx(ee,{className:"w-48",children:e.jsx(re,{placeholder:"Filter by subscription"})}),e.jsxs(se,{children:[e.jsx(E,{value:"all",children:"All Users"}),e.jsx(E,{value:"premium",children:"Premium Only"}),e.jsx(E,{value:"free",children:"Free Only"})]})]})]})})}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(w,{children:["Users (",ne.length,")"]}),k.length>0&&e.jsxs(v,{variant:"outline",onClick:()=>f(!0),children:["Bulk Actions (",k.length,")"]})]})}),e.jsx(y,{children:e.jsx(ys,{className:"h-96",children:e.jsxs(fs,{children:[e.jsx(nt,{children:e.jsxs(Fe,{children:[e.jsx(te,{className:"w-12",children:e.jsx("input",{type:"checkbox",checked:k.length===ne.length&&ne.length>0,onChange:z=>ie(z.target.checked)})}),e.jsx(te,{children:"User"}),e.jsx(te,{children:"Email"}),e.jsx(te,{children:"Role"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Last Active"}),e.jsx(te,{children:"Actions"})]})}),e.jsx(gs,{children:ne.map(z=>e.jsxs(Fe,{children:[e.jsx(H,{children:e.jsx("input",{type:"checkbox",checked:k.includes(z.id),onChange:M=>Q(z.id,M.target.checked)})}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-sm font-medium",children:z.username.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:z.username}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ID: ",z.id]})]})]})}),e.jsx(H,{children:z.email||"N/A"}),e.jsx(H,{children:e.jsx(P,{variant:z.role==="admin"?"default":"secondary",children:z.role})}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[z.isPremium&&e.jsxs(P,{variant:"default",children:[e.jsx(qs,{className:"h-3 w-3 mr-1"}),"Premium"]}),z.onboardingCompleted&&e.jsx(P,{variant:"outline",children:"Onboarded"})]})}),e.jsx(H,{children:e.jsx("p",{className:"text-sm",children:z.stats?.lastLoginAt?new Date(z.stats.lastLoginAt).toLocaleDateString():"Never"})}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>d(z),children:"View"}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>p(z),children:e.jsx(Ua,{className:"h-3 w-3"})})]})})]},z.id))})]})})})]})]}),e.jsx($,{value:"analytics",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"User Growth"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"This Month"}),e.jsxs(P,{variant:"default",children:["+",N?.newUsersThisMonth||0]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Last Month"}),e.jsxs(P,{variant:"outline",children:["+",N?.newUsersLastMonth||0]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Growth Rate"}),e.jsx(P,{variant:"secondary",children:N?.growthRate?`${N.growthRate}%`:"N/A"})]})]})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Engagement Metrics"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Daily Active Users"}),e.jsx(P,{variant:"default",children:N?.dailyActiveUsers||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Weekly Active Users"}),e.jsx(P,{variant:"default",children:N?.weeklyActiveUsers||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Avg. Session Duration"}),e.jsx(P,{variant:"outline",children:N?.avgSessionDuration||"N/A"})]})]})})]})]})}),e.jsx($,{value:"bulk",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Bulk Operations"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Select users from the Users tab to perform bulk operations."}),k.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"font-medium",children:[k.length," users selected"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(v,{variant:"outline",onClick:()=>_.mutate({operation:"make_premium",userIds:k}),disabled:_.isPending,children:"Make Premium"}),e.jsx(v,{variant:"outline",onClick:()=>_.mutate({operation:"remove_premium",userIds:k}),disabled:_.isPending,children:"Remove Premium"}),e.jsxs(v,{variant:"outline",onClick:()=>_.mutate({operation:"send_email",userIds:k,data:{subject:"System Notification",message:"Important update..."}}),disabled:_.isPending,children:[e.jsx(vs,{className:"h-4 w-4 mr-2"}),"Send Email"]})]})]}):e.jsx("p",{className:"text-muted-foreground",children:"No users selected for bulk operations."})]})]})})]}),e.jsx(Bs,{open:!!n,onOpenChange:()=>d(null),children:e.jsxs(Ds,{className:"max-w-2xl",children:[e.jsx(Ms,{children:e.jsx(Ls,{children:"User Details"})}),n&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Username"}),e.jsx("p",{className:"text-sm",children:n.username})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Email"}),e.jsx("p",{className:"text-sm",children:n.email||"N/A"})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Role"}),e.jsx("p",{className:"text-sm",children:n.role})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Status"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[n.isPremium&&e.jsx(P,{children:"Premium"}),e.jsx(P,{variant:"outline",children:n.onboardingCompleted?"Onboarded":"Pending"})]})]})]}),n.stats&&e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Meals"}),e.jsx("p",{className:"text-sm font-medium",children:n.stats.totalMeals})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Last Login"}),e.jsx("p",{className:"text-sm font-medium",children:new Date(n.stats.lastLoginAt).toLocaleDateString()})]})]})]})]})]})}),e.jsx(Bs,{open:!!u,onOpenChange:()=>p(null),children:e.jsxs(Ds,{children:[e.jsx(Ms,{children:e.jsx(Ls,{children:"Edit User"})}),u&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"edit-username",children:"Username"}),e.jsx(I,{id:"edit-username",value:u.username,onChange:z=>p({...u,username:z.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"edit-email",children:"Email"}),e.jsx(I,{id:"edit-email",value:u.email||"",onChange:z=>p({...u,email:z.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"edit-role",children:"Role"}),e.jsxs(Z,{value:u.role||"user",onValueChange:z=>p({...u,role:z}),children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"user",children:"User"}),e.jsx(E,{value:"admin",children:"Admin"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{checked:!!u.isPremium,onCheckedChange:z=>p({...u,isPremium:z})}),e.jsx(C,{children:"Premium User"})]})]}),e.jsxs(yt,{children:[e.jsx(v,{variant:"outline",onClick:()=>p(null),children:"Cancel"}),e.jsx(v,{onClick:()=>u&&A.mutate({id:u.id,data:u}),disabled:A.isPending,children:"Save Changes"})]})]})}),e.jsx(Bs,{open:o,onOpenChange:h,children:e.jsxs(Ds,{children:[e.jsx(Ms,{children:e.jsx(Ls,{children:"Create New User"})}),e.jsx(bc,{onSubmit:z=>F.mutate(z)})]})})]})}function bc({onSubmit:s}){const[t,a]=x.useState({username:"",email:"",password:"",firstName:"",lastName:"",role:"user",isPremium:!1}),r=i=>{i.preventDefault(),s(t)};return e.jsxs("form",{onSubmit:r,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"firstName",children:"First Name"}),e.jsx(I,{id:"firstName",value:t.firstName,onChange:i=>a({...t,firstName:i.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"lastName",children:"Last Name"}),e.jsx(I,{id:"lastName",value:t.lastName,onChange:i=>a({...t,lastName:i.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"username",children:"Username"}),e.jsx(I,{id:"username",value:t.username,onChange:i=>a({...t,username:i.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"email",children:"Email"}),e.jsx(I,{id:"email",type:"email",value:t.email,onChange:i=>a({...t,email:i.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"password",children:"Password"}),e.jsx(I,{id:"password",type:"password",value:t.password,onChange:i=>a({...t,password:i.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"role",children:"Role"}),e.jsxs(Z,{value:t.role,onValueChange:i=>a({...t,role:i}),children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"user",children:"User"}),e.jsx(E,{value:"admin",children:"Admin"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{checked:t.isPremium,onCheckedChange:i=>a({...t,isPremium:i})}),e.jsx(C,{children:"Premium User"})]}),e.jsx(yt,{children:e.jsx(v,{type:"submit",children:"Create User"})})]})}const Us=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"];function wc(){const[s,t]=x.useState("30d"),[a,r]=x.useState("overview"),{data:i,isLoading:l,refetch:n}=W({queryKey:["admin-analytics",s],queryFn:async()=>{const u=await fetch(`/api/admin/analytics?timeRange=${s}`);if(!u.ok)throw new Error("Failed to fetch analytics");return u.json()},refetchInterval:300*1e3}),d=()=>{const u=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),p=window.URL.createObjectURL(u),o=document.createElement("a");o.href=p,o.download=`analytics-${s}-${new Date().toISOString().split("T")[0]}.json`,o.click(),window.URL.revokeObjectURL(p)};return l?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(be,{className:"h-8 w-8 animate-spin mx-auto mb-2"}),e.jsx("p",{children:"Loading analytics..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(wt,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"Analytics Dashboard"}),e.jsx("p",{className:"text-neutral-600",children:"Comprehensive business insights and metrics"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(Z,{value:s,onValueChange:t,children:[e.jsx(ee,{className:"w-32",children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"7d",children:"7 Days"}),e.jsx(E,{value:"30d",children:"30 Days"}),e.jsx(E,{value:"90d",children:"90 Days"}),e.jsx(E,{value:"1y",children:"1 Year"})]})]}),e.jsxs(v,{onClick:()=>n(),variant:"outline",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(v,{onClick:d,variant:"outline",children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Export"]})]})]}),e.jsxs(Te,{value:a,onValueChange:r,children:[e.jsxs(Se,{children:[e.jsx(U,{value:"overview",children:"Overview"}),e.jsx(U,{value:"users",children:"User Analytics"}),e.jsx(U,{value:"revenue",children:"Revenue"}),e.jsx(U,{value:"features",children:"Feature Usage"}),e.jsx(U,{value:"ai",children:"AI Performance"})]}),e.jsxs($,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(Me,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i?.userGrowth?.slice(-1)[0]?.users||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx(ye,{className:"inline h-3 w-3 mr-1"}),"+12% from last month"]})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"AI Analyses"}),e.jsx(Ze,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i?.mealAnalytics?.reduce((u,p)=>u+p.analyses,0)||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx(ye,{className:"inline h-3 w-3 mr-1"}),"+23% from last month"]})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Revenue"}),e.jsx(ws,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",i?.revenueData?.reduce((u,p)=>u+p.revenue,0)||0]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx(ye,{className:"inline h-3 w-3 mr-1"}),"+18% from last month"]})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Premium Users"}),e.jsx(be,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i?.userGrowth?.slice(-1)[0]?.premium||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx(ye,{className:"inline h-3 w-3 mr-1"}),"+8% conversion rate"]})]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"User Growth Trend"})}),e.jsx(y,{children:e.jsx(Ce,{width:"100%",height:300,children:e.jsxs(xa,{data:i?.userGrowth||[],children:[e.jsx(os,{strokeDasharray:"3 3"}),e.jsx(Pe,{dataKey:"date"}),e.jsx(Ie,{}),e.jsx(Re,{}),e.jsx($t,{type:"monotone",dataKey:"users",stackId:"1",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.6}),e.jsx($t,{type:"monotone",dataKey:"premium",stackId:"1",stroke:"#82ca9d",fill:"#82ca9d",fillOpacity:.8})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Daily AI Analyses"})}),e.jsx(y,{children:e.jsx(Ce,{width:"100%",height:250,children:e.jsxs(is,{data:i?.mealAnalytics||[],children:[e.jsx(os,{strokeDasharray:"3 3"}),e.jsx(Pe,{dataKey:"date"}),e.jsx(Ie,{}),e.jsx(Re,{}),e.jsx(je,{type:"monotone",dataKey:"analyses",stroke:"#8884d8",strokeWidth:2})]})})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Top Analyzed Foods"})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-3",children:i?.topFoods?.slice(0,5).map((u,p)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-sm font-medium",children:p+1}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:u.food}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[u.calories," avg calories"]})]})]}),e.jsxs(P,{variant:"outline",children:[u.count," times"]})]},u.food))})})]})]})]}),e.jsx($,{value:"users",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"User Registration Trend"})}),e.jsx(y,{children:e.jsx(Ce,{width:"100%",height:300,children:e.jsxs(wt,{data:i?.userGrowth||[],children:[e.jsx(os,{strokeDasharray:"3 3"}),e.jsx(Pe,{dataKey:"date"}),e.jsx(Ie,{}),e.jsx(Re,{}),e.jsx(Es,{dataKey:"users",fill:"#8884d8"})]})})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"User Retention by Cohort"})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-4",children:i?.userRetention?.map((u,p)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:u.cohort}),e.jsxs(P,{variant:"outline",children:[u.retention[0],"% Day 1"]})]}),e.jsx("div",{className:"flex space-x-1",children:u.retention.map((o,h)=>e.jsx("div",{className:"h-2 flex-1 rounded",style:{backgroundColor:`rgba(34, 197, 94, ${o/100})`},title:`Day ${h+1}: ${o}%`},h))})]},u.cohort))})})]})]})}),e.jsxs($,{value:"revenue",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Revenue Trend"})}),e.jsx(y,{children:e.jsx(Ce,{width:"100%",height:300,children:e.jsxs(is,{data:i?.revenueData||[],children:[e.jsx(os,{strokeDasharray:"3 3"}),e.jsx(Pe,{dataKey:"date"}),e.jsx(Ie,{}),e.jsx(Re,{}),e.jsx(je,{type:"monotone",dataKey:"revenue",stroke:"#22c55e",strokeWidth:3})]})})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Subscription Growth"})}),e.jsx(y,{children:e.jsx(Ce,{width:"100%",height:300,children:e.jsxs(xa,{data:i?.revenueData||[],children:[e.jsx(os,{strokeDasharray:"3 3"}),e.jsx(Pe,{dataKey:"date"}),e.jsx(Ie,{}),e.jsx(Re,{}),e.jsx($t,{type:"monotone",dataKey:"subscriptions",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.6})]})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{className:"text-base",children:"Monthly Recurring Revenue"})}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",i?.revenueData?.slice(-1)[0]?.revenue||0]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx(ye,{className:"inline h-3 w-3 mr-1"}),"+15% from last month"]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{className:"text-base",children:"Average Revenue Per User"})}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"$12.50"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx(ye,{className:"inline h-3 w-3 mr-1"}),"+5% from last month"]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{className:"text-base",children:"Customer Lifetime Value"})}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"$89.40"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Based on 7.2 months avg"})]})]})]})]}),e.jsx($,{value:"features",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Feature Usage Distribution"})}),e.jsx(y,{children:e.jsx(Ce,{width:"100%",height:300,children:e.jsxs(Ji,{children:[e.jsx(Qi,{data:i?.featureUsage||[],cx:"50%",cy:"50%",labelLine:!1,label:({name:u,percentage:p})=>`${u} ${p}%`,outerRadius:80,fill:"#8884d8",dataKey:"usage",children:i?.featureUsage?.map((u,p)=>e.jsx(Xi,{fill:Us[p%Us.length]},`cell-${p}`))}),e.jsx(Re,{})]})})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Feature Usage Statistics"})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-4",children:i?.featureUsage?.map((u,p)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:u.feature}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(P,{variant:"outline",children:[u.usage," uses"]}),e.jsxs(P,{style:{backgroundColor:Us[p%Us.length]},children:[u.percentage,"%"]})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"h-2 rounded-full transition-all duration-300",style:{width:`${u.percentage}%`,backgroundColor:Us[p%Us.length]}})})]},u.feature))})})]})]})}),e.jsxs($,{value:"ai",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"AI Provider Usage"})}),e.jsx(y,{children:e.jsx(Ce,{width:"100%",height:300,children:e.jsxs(wt,{data:i?.aiProviderStats||[],children:[e.jsx(os,{strokeDasharray:"3 3"}),e.jsx(Pe,{dataKey:"provider"}),e.jsx(Ie,{}),e.jsx(Re,{}),e.jsx(Es,{dataKey:"usage",fill:"#8884d8"})]})})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"AI Usage Costs"})}),e.jsxs(y,{children:[e.jsx("div",{className:"space-y-4",children:i?.aiProviderStats?.map(u=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium capitalize",children:u.provider}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[u.usage," analyses"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold",children:["$",u.cost]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["$",(u.cost/u.usage).toFixed(3)," per analysis"]})]})]},u.provider))}),e.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Total AI Costs"}),e.jsxs("span",{className:"text-lg font-bold",children:["$",i?.aiProviderStats?.reduce((u,p)=>u+p.cost,0)||0]})]})})]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"AI Performance Metrics"})}),e.jsx(y,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold",children:"95.8%"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Accuracy Rate"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold",children:"2.3s"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Response Time"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold",children:"99.2%"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Uptime"})]})]})})]})]})]})]})}function kc(){const[s,t]=x.useState("overview"),[a,r]=x.useState(""),[i,l]=x.useState("all"),[n,d]=x.useState(null),[u,p]=x.useState(!1),[o,h]=x.useState(""),[j,f]=x.useState(""),{toast:k}=ve(),c=Ss(),[R,D]=x.useState({commission_percent:0,is_recurring:!1}),{data:S,isLoading:q}=W({queryKey:["admin-revenue-metrics"],queryFn:async()=>{const M=await fetch("/api/admin/payments/metrics");if(!M.ok)throw new Error("Failed to fetch revenue metrics");return M.json()},refetchInterval:300*1e3}),{data:T,isLoading:m,refetch:N}=W({queryKey:["admin-subscriptions",a,i],queryFn:async()=>{const M=new URLSearchParams;a&&M.append("search",a),i!=="all"&&M.append("status",i);const xe=await fetch(`/api/admin/payments/subscriptions?${M}`);if(!xe.ok)throw new Error("Failed to fetch subscriptions");return xe.json()}}),{data:F,isLoading:A}=W({queryKey:["admin-transactions"],queryFn:async()=>{const M=await fetch("/api/admin/payments/transactions");if(!M.ok)throw new Error("Failed to fetch transactions");return M.json()}}),{data:_}=W({queryKey:["admin-payment-methods"],queryFn:async()=>{const M=await fetch("/api/admin/payments/methods");if(!M.ok)throw new Error("Failed to fetch payment methods");return M.json()}}),Q=J({mutationFn:async M=>{const xe=await pe(`/api/admin/payments/subscriptions/${M}/cancel`,{method:"POST"});if(!xe.ok)throw new Error("Failed to cancel subscription");return xe.json()},onSuccess:()=>{k({title:"Subscription canceled successfully"}),N()},onError:M=>{k({title:"Error canceling subscription",description:M.message,variant:"destructive"})}}),ie=J({mutationFn:async M=>{const xe=await pe("/api/admin/payments/refund",{method:"POST",body:JSON.stringify(M)});if(!xe.ok)throw new Error("Failed to process refund");return xe.json()},onSuccess:()=>{k({title:"Refund processed successfully"}),p(!1),h(""),f(""),c.invalidateQueries({queryKey:["admin-transactions"]})},onError:M=>{k({title:"Error processing refund",description:M.message,variant:"destructive"})}}),ge=J({mutationFn:async M=>{const xe=await pe("/api/admin/referral-settings",{method:"PUT",body:JSON.stringify(M)});if(!xe.ok)throw new Error("Failed to update referral settings");return xe.json()},onSuccess:()=>{k({title:"Referral settings updated successfully"}),c.invalidateQueries({queryKey:["admin-referral-settings"]})},onError:M=>{k({title:"Error updating referral settings",description:M.message,variant:"destructive"})}}),ne=M=>{switch(M){case"active":return e.jsxs(P,{variant:"default",children:[e.jsx(fe,{className:"h-3 w-3 mr-1"}),"Active"]});case"canceled":return e.jsxs(P,{variant:"destructive",children:[e.jsx(xt,{className:"h-3 w-3 mr-1"}),"Canceled"]});case"past_due":return e.jsxs(P,{variant:"secondary",children:[e.jsx(as,{className:"h-3 w-3 mr-1"}),"Past Due"]});case"incomplete":return e.jsxs(P,{variant:"outline",children:[e.jsx(as,{className:"h-3 w-3 mr-1"}),"Incomplete"]});case"succeeded":return e.jsxs(P,{variant:"default",children:[e.jsx(fe,{className:"h-3 w-3 mr-1"}),"Succeeded"]});case"pending":return e.jsx(P,{variant:"secondary",children:"Pending"});case"failed":return e.jsxs(P,{variant:"destructive",children:[e.jsx(xt,{className:"h-3 w-3 mr-1"}),"Failed"]});default:return e.jsx(P,{variant:"outline",children:M})}},z=M=>{const Ke=[M==="subscriptions"?["ID","User","Email","Plan","Status","Amount","Created"]:["ID","User","Amount","Status","Description","Created"],...((M==="subscriptions"?T:F)||[]).map(le=>M==="subscriptions"?[le.id,le.username,le.email,le.planName,le.status,le.amount,new Date(le.createdAt).toLocaleDateString()]:[le.id,le.username,le.amount,le.status,le.description,new Date(le.createdAt).toLocaleDateString()])].map(le=>le.join(",")).join(`
`),O=new Blob([Ke],{type:"text/csv"}),X=window.URL.createObjectURL(O),Ae=document.createElement("a");Ae.href=X,Ae.download=`${M}-${new Date().toISOString().split("T")[0]}.csv`,Ae.click(),window.URL.revokeObjectURL(X)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(ws,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"Payment Management"}),e.jsx("p",{className:"text-neutral-600",children:"Manage subscriptions, transactions, and revenue"})]})]}),e.jsxs(v,{onClick:()=>c.invalidateQueries(),variant:"outline",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Refresh All"]})]}),e.jsxs(Te,{value:s,onValueChange:t,children:[e.jsxs(Se,{children:[e.jsx(U,{value:"overview",children:"Overview"}),e.jsx(U,{value:"subscriptions",children:"Subscriptions"}),e.jsx(U,{value:"transactions",children:"Transactions"}),e.jsx(U,{value:"methods",children:"Payment Methods"}),e.jsx(U,{value:"settings",children:"Settings"})]}),e.jsxs($,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Total Revenue"}),e.jsx(ws,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",S?.totalRevenue||0]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All time"})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Monthly Revenue"}),e.jsx(ye,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",S?.monthlyRevenue||0]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Active Subscriptions"}),e.jsx(Me,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:S?.activeSubscriptions||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[S?.canceledSubscriptions||0," canceled"]})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Churn Rate"}),e.jsx(as,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[S?.churnRate||0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This month"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Revenue Breakdown"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Monthly Subscriptions"}),e.jsxs("span",{className:"font-medium",children:["$",S?.monthlyRevenue||0]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Yearly Subscriptions"}),e.jsxs("span",{className:"font-medium",children:["$",S?.yearlyRevenue||0]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Average Revenue Per User"}),e.jsxs("span",{className:"font-medium",children:["$",S?.averageRevenuePerUser||0]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Customer Lifetime Value"}),e.jsxs("span",{className:"font-medium",children:["$",S?.lifetimeValue||0]})]})]})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Subscription Status"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Active"}),e.jsx(P,{variant:"default",children:S?.activeSubscriptions||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Canceled"}),e.jsx(P,{variant:"destructive",children:S?.canceledSubscriptions||0})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Total"}),e.jsx(P,{variant:"outline",children:S?.totalSubscriptions||0})]})]})})]})]})]}),e.jsxs($,{value:"subscriptions",className:"space-y-6",children:[e.jsx(g,{children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(mt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(I,{placeholder:"Search by username or email...",value:a,onChange:M=>r(M.target.value),className:"pl-10"})]})}),e.jsxs(Z,{value:i,onValueChange:l,children:[e.jsx(ee,{className:"w-48",children:e.jsx(re,{placeholder:"Filter by status"})}),e.jsxs(se,{children:[e.jsx(E,{value:"all",children:"All Status"}),e.jsx(E,{value:"active",children:"Active"}),e.jsx(E,{value:"canceled",children:"Canceled"}),e.jsx(E,{value:"past_due",children:"Past Due"}),e.jsx(E,{value:"incomplete",children:"Incomplete"})]})]}),e.jsxs(v,{onClick:()=>z("subscriptions"),variant:"outline",children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Export"]})]})})}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{children:["Subscriptions (",T?.length||0,")"]})}),e.jsx(y,{children:e.jsx(ys,{className:"h-96",children:e.jsxs(fs,{children:[e.jsx(nt,{children:e.jsxs(Fe,{children:[e.jsx(te,{children:"User"}),e.jsx(te,{children:"Plan"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Amount"}),e.jsx(te,{children:"Next Billing"}),e.jsx(te,{children:"Actions"})]})}),e.jsx(gs,{children:T?.map(M=>e.jsxs(Fe,{children:[e.jsx(H,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:M.username}),e.jsx("p",{className:"text-sm text-muted-foreground",children:M.email})]})}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{className:"h-4 w-4 text-yellow-500"}),e.jsx("span",{children:M.planName}),e.jsx(P,{variant:"outline",children:M.interval})]})}),e.jsx(H,{children:ne(M.status)}),e.jsxs(H,{children:["$",M.amount," ",M.currency.toUpperCase()]}),e.jsx(H,{children:M.status==="active"?e.jsxs("div",{children:[e.jsx("p",{className:"text-sm",children:new Date(M.currentPeriodEnd).toLocaleDateString()}),M.cancelAt&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Cancels: ",new Date(M.cancelAt).toLocaleDateString()]})]}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>d(M),children:"View"}),M.status==="active"&&e.jsx(v,{variant:"destructive",size:"sm",onClick:()=>Q.mutate(M.id),disabled:Q.isPending,children:"Cancel"})]})})]},M.id))})]})})})]})]}),e.jsx($,{value:"transactions",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{children:"Recent Transactions"}),e.jsxs(v,{onClick:()=>z("transactions"),variant:"outline",children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Export"]})]})}),e.jsx(y,{children:e.jsx(ys,{className:"h-96",children:e.jsxs(fs,{children:[e.jsx(nt,{children:e.jsxs(Fe,{children:[e.jsx(te,{children:"Transaction ID"}),e.jsx(te,{children:"User"}),e.jsx(te,{children:"Amount"}),e.jsx(te,{children:"Status"}),e.jsx(te,{children:"Description"}),e.jsx(te,{children:"Date"}),e.jsx(te,{children:"Actions"})]})}),e.jsx(gs,{children:F?.map(M=>e.jsxs(Fe,{children:[e.jsxs(H,{className:"font-mono text-sm",children:[M.id.slice(0,8),"..."]}),e.jsx(H,{children:e.jsx("p",{className:"font-medium",children:M.username})}),e.jsxs(H,{children:["$",M.amount," ",M.currency.toUpperCase()]}),e.jsx(H,{children:ne(M.status)}),e.jsx(H,{className:"max-w-xs truncate",children:M.description}),e.jsx(H,{children:new Date(M.createdAt).toLocaleDateString()}),e.jsx(H,{children:M.status==="succeeded"&&e.jsx(v,{variant:"outline",size:"sm",onClick:()=>{d(null),p(!0),h(M.amount.toString())},children:"Refund"})})]},M.id))})]})})})]})}),e.jsx($,{value:"methods",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Payment Methods"})}),e.jsx(y,{children:e.jsx(ys,{className:"h-96",children:e.jsxs(fs,{children:[e.jsx(nt,{children:e.jsxs(Fe,{children:[e.jsx(te,{children:"User ID"}),e.jsx(te,{children:"Type"}),e.jsx(te,{children:"Card"}),e.jsx(te,{children:"Expires"}),e.jsx(te,{children:"Default"}),e.jsx(te,{children:"Actions"})]})}),e.jsx(gs,{children:_?.map(M=>e.jsxs(Fe,{children:[e.jsx(H,{children:M.userId}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(sa,{className:"h-4 w-4"}),e.jsx("span",{className:"capitalize",children:M.type})]})}),e.jsxs(H,{children:[e.jsx("span",{className:"capitalize",children:M.brand})," •••• ",M.last4]}),e.jsxs(H,{children:[M.expMonth.toString().padStart(2,"0"),"/",M.expYear]}),e.jsx(H,{children:M.isDefault&&e.jsx(P,{variant:"default",children:"Default"})}),e.jsx(H,{children:e.jsx(v,{variant:"outline",size:"sm",children:"View"})})]},M.id))})]})})})]})}),e.jsx($,{value:"settings",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Payment Settings"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Stripe Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Publishable Key"}),e.jsx(I,{placeholder:"pk_...",disabled:!0})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Webhook Endpoint"}),e.jsx(I,{value:"/api/webhooks/stripe",disabled:!0})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Plan Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Monthly Plan"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"$9.99/month"})]}),e.jsxs(v,{variant:"outline",size:"sm",children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Configure"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Yearly Plan"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"$99.99/year"})]}),e.jsxs(v,{variant:"outline",size:"sm",children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Configure"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Referral Program"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Commission Percentage"}),e.jsx(I,{type:"number",value:R.commission_percent,onChange:M=>D({...R,commission_percent:parseFloat(M.target.value)}),min:"0",max:"100",step:"0.01"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{id:"recurring-commissions",checked:R.is_recurring,onCheckedChange:M=>D({...R,is_recurring:M})}),e.jsx(C,{htmlFor:"recurring-commissions",children:"Recurring Commissions"})]}),e.jsx(v,{onClick:()=>ge.mutate(R),disabled:ge.isPending,children:"Save Referral Settings"})]})]})]})})]})})]}),e.jsx(Bs,{open:!!n,onOpenChange:()=>d(null),children:e.jsxs(Ds,{className:"max-w-2xl",children:[e.jsx(Ms,{children:e.jsx(Ls,{children:"Subscription Details"})}),n&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Subscription ID"}),e.jsx("p",{className:"text-sm font-mono",children:n.id})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"User"}),e.jsx("p",{className:"text-sm",children:n.username})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Status"}),e.jsx("div",{className:"mt-1",children:ne(n.status)})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Plan"}),e.jsx("p",{className:"text-sm",children:n.planName})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Amount"}),e.jsxs("p",{className:"text-sm",children:["$",n.amount," ",n.currency.toUpperCase()]})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Billing Cycle"}),e.jsx("p",{className:"text-sm capitalize",children:n.interval})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Current Period"}),e.jsxs("p",{className:"text-sm",children:[new Date(n.currentPeriodStart).toLocaleDateString()," - "," ",new Date(n.currentPeriodEnd).toLocaleDateString()]})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Created"}),e.jsx("p",{className:"text-sm",children:new Date(n.createdAt).toLocaleDateString()})]})]})})]})}),e.jsx(Bs,{open:u,onOpenChange:p,children:e.jsxs(Ds,{children:[e.jsx(Ms,{children:e.jsx(Ls,{children:"Process Refund"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"refund-amount",children:"Refund Amount"}),e.jsx(I,{id:"refund-amount",type:"number",value:o,onChange:M=>h(M.target.value),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"refund-reason",children:"Reason"}),e.jsxs(Z,{value:j,onValueChange:f,children:[e.jsx(ee,{children:e.jsx(re,{placeholder:"Select reason"})}),e.jsxs(se,{children:[e.jsx(E,{value:"requested_by_customer",children:"Requested by customer"}),e.jsx(E,{value:"duplicate",children:"Duplicate charge"}),e.jsx(E,{value:"fraudulent",children:"Fraudulent"}),e.jsx(E,{value:"subscription_cancellation",children:"Subscription cancellation"}),e.jsx(E,{value:"other",children:"Other"})]})]})]})]}),e.jsxs(yt,{children:[e.jsx(v,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),e.jsx(v,{onClick:()=>ie.mutate({transactionId:"tx_123",amount:parseFloat(o),reason:j}),disabled:ie.isPending||!o||!j,children:"Process Refund"})]})]})})]})}function Sc(){const[s,t]=x.useState("general"),[a,r]=x.useState(null),[i,l]=x.useState(!1),{toast:n}=ve(),d=Ss(),{data:u,isLoading:p}=W({queryKey:["admin-settings"],queryFn:async()=>{const c=await pe("/api/admin/settings");if(!c.ok)throw new Error("Failed to fetch settings");return c.json()}}),o=J({mutationFn:async c=>{const R=await pe(`/api/admin/settings/${c.section}`,{method:"PUT",body:c.settings});if(!R.ok)throw new Error("Failed to update settings");return R.json()},onSuccess:()=>{n({title:"Settings updated successfully"}),l(!1),d.invalidateQueries({queryKey:["admin-settings"]})},onError:c=>{n({title:"Error updating settings",description:c.message,variant:"destructive"})}}),h=J({mutationFn:async()=>{const c=await pe("/api/admin/settings/test-email",{method:"POST"});if(!c.ok)throw new Error("Failed to send test email");return c.json()},onSuccess:()=>{n({title:"Test email sent successfully"})},onError:c=>{n({title:"Error sending test email",description:c.message,variant:"destructive"})}});x.useEffect(()=>{u&&r(u)},[u]);const j=(c,R,D)=>{a&&(r(S=>({...S,[c]:{...S[c],[R]:D}})),l(!0))},f=async c=>{a&&await o.mutateAsync({section:c,settings:a[c]})},k=async()=>{await h.mutateAsync()};return p||!a?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ls,{className:"h-8 w-8 animate-spin mx-auto mb-2"}),e.jsx("p",{children:"Loading settings..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ls,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"System Settings"}),e.jsx("p",{className:"text-neutral-600",children:"Configure application settings and preferences"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[i&&e.jsxs(P,{variant:"outline",className:"text-orange-600",children:[e.jsx(as,{className:"h-3 w-3 mr-1"}),"Unsaved Changes"]}),e.jsxs(v,{onClick:()=>d.invalidateQueries({queryKey:["admin-settings"]}),variant:"outline",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),e.jsxs(Te,{value:s,onValueChange:t,children:[e.jsxs(Se,{className:"grid grid-cols-4 lg:grid-cols-8",children:[e.jsx(U,{value:"general",children:"General"}),e.jsx(U,{value:"ai",children:"AI Config"}),e.jsx(U,{value:"payment",children:"Payment"}),e.jsx(U,{value:"email",children:"Email"}),e.jsx(U,{value:"security",children:"Security"}),e.jsx(U,{value:"notifications",children:"Notifications"}),e.jsx(U,{value:"storage",children:"Storage"}),e.jsx(U,{value:"performance",children:"Performance"})]}),e.jsx($,{value:"general",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"h-5 w-5"}),"General Settings"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"site-name",children:"Site Name"}),e.jsx(I,{id:"site-name",value:a.general.siteName,onChange:c=>j("general","siteName",c.target.value)})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"support-email",children:"Support Email"}),e.jsx(I,{id:"support-email",type:"email",value:a.general.supportEmail,onChange:c=>j("general","supportEmail",c.target.value)})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"site-description",children:"Site Description"}),e.jsx($e,{id:"site-description",value:a.general.siteDescription,onChange:c=>j("general","siteDescription",c.target.value)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Maintenance Mode"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Temporarily disable the application"})]}),e.jsx(G,{checked:a.general.maintenanceMode,onCheckedChange:c=>j("general","maintenanceMode",c)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Registration Enabled"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow new user registrations"})]}),e.jsx(G,{checked:a.general.registrationEnabled,onCheckedChange:c=>j("general","registrationEnabled",c)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Email Verification Required"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Require email verification for new accounts"})]}),e.jsx(G,{checked:a.general.emailVerificationRequired,onCheckedChange:c=>j("general","emailVerificationRequired",c)})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(v,{onClick:()=>f("general"),disabled:o.isPending,children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Save General Settings"]})})]})]})}),e.jsx($,{value:"ai",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(Di,{className:"h-5 w-5"}),"AI Configuration"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"default-provider",children:"Default AI Provider"}),e.jsxs(Z,{value:a.ai.defaultProvider,onValueChange:c=>j("ai","defaultProvider",c),children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"openai",children:"OpenAI"}),e.jsx(E,{value:"gemini",children:"Google Gemini"}),e.jsx(E,{value:"testing",children:"Testing Mode"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"max-analyses",children:"Max Analyses Per Day (Free Users)"}),e.jsx(I,{id:"max-analyses",type:"number",value:a.ai.maxAnalysesPerDay,onChange:c=>j("ai","maxAnalysesPerDay",parseInt(c.target.value))})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"analysis-timeout",children:"Analysis Timeout (seconds)"}),e.jsx(I,{id:"analysis-timeout",type:"number",value:a.ai.analysisTimeout,onChange:c=>j("ai","analysisTimeout",parseInt(c.target.value))})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Auto Analysis"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically analyze uploaded images"})]}),e.jsx(G,{checked:a.ai.enableAutoAnalysis,onCheckedChange:c=>j("ai","enableAutoAnalysis",c)})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(v,{onClick:()=>f("ai"),disabled:o.isPending,children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Save AI Settings"]})})]})]})}),e.jsx($,{value:"payment",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-5 w-5"}),"Payment Configuration"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Stripe Enabled"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable Stripe payment processing"})]}),e.jsx(G,{checked:a.payment.stripeEnabled,onCheckedChange:c=>j("payment","stripeEnabled",c)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"monthly-price",children:"Monthly Price"}),e.jsx(I,{id:"monthly-price",type:"number",step:"0.01",value:a.payment.monthlyPrice,onChange:c=>j("payment","monthlyPrice",parseFloat(c.target.value))})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"yearly-price",children:"Yearly Price"}),e.jsx(I,{id:"yearly-price",type:"number",step:"0.01",value:a.payment.yearlyPrice,onChange:c=>j("payment","yearlyPrice",parseFloat(c.target.value))})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"trial-days",children:"Trial Days"}),e.jsx(I,{id:"trial-days",type:"number",value:a.payment.trialDays,onChange:c=>j("payment","trialDays",parseInt(c.target.value))})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"currency",children:"Currency"}),e.jsxs(Z,{value:a.payment.currency,onValueChange:c=>j("payment","currency",c),children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"usd",children:"USD"}),e.jsx(E,{value:"eur",children:"EUR"}),e.jsx(E,{value:"gbp",children:"GBP"}),e.jsx(E,{value:"cad",children:"CAD"})]})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(v,{onClick:()=>f("payment"),disabled:o.isPending,children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Save Payment Settings"]})})]})]})}),e.jsx($,{value:"email",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(vs,{className:"h-5 w-5"}),"Email Configuration"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"email-provider",children:"Email Provider"}),e.jsxs(Z,{value:a.email.provider,onValueChange:c=>j("email","provider",c),children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"smtp",children:"SMTP"}),e.jsx(E,{value:"sendgrid",children:"SendGrid"}),e.jsx(E,{value:"mailgun",children:"Mailgun"}),e.jsx(E,{value:"ses",children:"Amazon SES"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"smtp-host",children:"SMTP Host"}),e.jsx(I,{id:"smtp-host",value:a.email.smtpHost,onChange:c=>j("email","smtpHost",c.target.value)})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"smtp-port",children:"SMTP Port"}),e.jsx(I,{id:"smtp-port",type:"number",value:a.email.smtpPort,onChange:c=>j("email","smtpPort",parseInt(c.target.value))})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"smtp-username",children:"SMTP Username"}),e.jsx(I,{id:"smtp-username",value:a.email.smtpUsername,onChange:c=>j("email","smtpUsername",c.target.value)})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"smtp-password",children:"SMTP Password"}),e.jsx(I,{id:"smtp-password",type:"password",value:a.email.smtpPassword,onChange:c=>j("email","smtpPassword",c.target.value)})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"from-address",children:"From Address"}),e.jsx(I,{id:"from-address",type:"email",value:a.email.fromAddress,onChange:c=>j("email","fromAddress",c.target.value)})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"from-name",children:"From Name"}),e.jsx(I,{id:"from-name",value:a.email.fromName,onChange:c=>j("email","fromName",c.target.value)})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(v,{onClick:k,variant:"outline",disabled:h.isPending,children:[e.jsx(vs,{className:"h-4 w-4 mr-2"}),"Send Test Email"]}),e.jsxs(v,{onClick:()=>f("email"),disabled:o.isPending,children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Save Email Settings"]})]})]})]})}),e.jsx($,{value:"security",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(Mi,{className:"h-5 w-5"}),"Security Settings"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"password-min-length",children:"Password Min Length"}),e.jsx(I,{id:"password-min-length",type:"number",value:a.security.passwordMinLength,onChange:c=>j("security","passwordMinLength",parseInt(c.target.value))})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"session-timeout",children:"Session Timeout (minutes)"}),e.jsx(I,{id:"session-timeout",type:"number",value:a.security.sessionTimeout,onChange:c=>j("security","sessionTimeout",parseInt(c.target.value))})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"max-login-attempts",children:"Max Login Attempts"}),e.jsx(I,{id:"max-login-attempts",type:"number",value:a.security.maxLoginAttempts,onChange:c=>j("security","maxLoginAttempts",parseInt(c.target.value))})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"lockout-duration",children:"Lockout Duration (minutes)"}),e.jsx(I,{id:"lockout-duration",type:"number",value:a.security.lockoutDuration,onChange:c=>j("security","lockoutDuration",parseInt(c.target.value))})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Two-Factor Authentication"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable 2FA for admin accounts"})]}),e.jsx(G,{checked:a.security.twoFactorEnabled,onCheckedChange:c=>j("security","twoFactorEnabled",c)})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(v,{onClick:()=>f("security"),disabled:o.isPending,children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Save Security Settings"]})})]})]})}),e.jsx($,{value:"notifications",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"h-5 w-5"}),"Notification Settings"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Send email notifications to admins"})]}),e.jsx(G,{checked:a.notifications.emailEnabled,onCheckedChange:c=>j("notifications","emailEnabled",c)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Push Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Send push notifications"})]}),e.jsx(G,{checked:a.notifications.pushEnabled,onCheckedChange:c=>j("notifications","pushEnabled",c)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"slack-webhook",children:"Slack Webhook URL"}),e.jsx(I,{id:"slack-webhook",type:"url",placeholder:"https://hooks.slack.com/...",value:a.notifications.slackWebhook,onChange:c=>j("notifications","slackWebhook",c.target.value)})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"discord-webhook",children:"Discord Webhook URL"}),e.jsx(I,{id:"discord-webhook",type:"url",placeholder:"https://discord.com/api/webhooks/...",value:a.notifications.discordWebhook,onChange:c=>j("notifications","discordWebhook",c.target.value)})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(v,{onClick:()=>f("notifications"),disabled:o.isPending,children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Save Notification Settings"]})})]})]})}),e.jsx($,{value:"storage",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(ms,{className:"h-5 w-5"}),"Storage Settings"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"storage-provider",children:"Storage Provider"}),e.jsxs(Z,{value:a.storage.provider,onValueChange:c=>j("storage","provider",c),children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"local",children:"Local Storage"}),e.jsx(E,{value:"s3",children:"Amazon S3"}),e.jsx(E,{value:"gcs",children:"Google Cloud Storage"}),e.jsx(E,{value:"azure",children:"Azure Blob Storage"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"max-file-size",children:"Max File Size (MB)"}),e.jsx(I,{id:"max-file-size",type:"number",value:a.storage.maxFileSize,onChange:c=>j("storage","maxFileSize",parseInt(c.target.value))})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"retention-days",children:"Retention Days"}),e.jsx(I,{id:"retention-days",type:"number",value:a.storage.retentionDays,onChange:c=>j("storage","retentionDays",parseInt(c.target.value))})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"allowed-types",children:"Allowed File Types (comma-separated)"}),e.jsx(I,{id:"allowed-types",value:a.storage.allowedTypes.join(", "),onChange:c=>j("storage","allowedTypes",c.target.value.split(", "))})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(v,{onClick:()=>f("storage"),disabled:o.isPending,children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Save Storage Settings"]})})]})]})}),e.jsx($,{value:"performance",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(dt,{className:"h-5 w-5"}),"Performance Settings"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Enable Caching"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Cache frequently accessed data"})]}),e.jsx(G,{checked:a.performance.cacheEnabled,onCheckedChange:c=>j("performance","cacheEnabled",c)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Enable Compression"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Compress API responses"})]}),e.jsx(G,{checked:a.performance.compressionEnabled,onCheckedChange:c=>j("performance","compressionEnabled",c)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Enable Rate Limiting"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Limit API requests per user"})]}),e.jsx(G,{checked:a.performance.rateLimitEnabled,onCheckedChange:c=>j("performance","rateLimitEnabled",c)})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"cache-ttl",children:"Cache TTL (seconds)"}),e.jsx(I,{id:"cache-ttl",type:"number",value:a.performance.cacheTtl,onChange:c=>j("performance","cacheTtl",parseInt(c.target.value))})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(v,{onClick:()=>f("performance"),disabled:o.isPending,children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Save Performance Settings"]})})]})]})})]})]})}function Cc(){const[s,t]=x.useState("backups"),[a,r]=x.useState("full"),[i,l]=x.useState(""),[n,d]=x.useState(0),[u,p]=x.useState(!1),{toast:o}=ve(),{data:h}=W({queryKey:["admin-backup-stats"],queryFn:async()=>{const m=await fetch("/api/admin/backup/stats");if(!m.ok)throw new Error("Failed to fetch backup stats");return m.json()}}),{data:j,refetch:f}=W({queryKey:["admin-backups"],queryFn:async()=>{const m=await fetch("/api/admin/backup");if(!m.ok)throw new Error("Failed to fetch backups");return m.json()}}),k=J({mutationFn:async m=>{const N=await Pt("/api/admin/backup/create",m);if(!N.ok)throw new Error("Failed to create backup");return N.json()},onSuccess:()=>{o({title:"Backup created successfully"}),f(),l(""),p(!1)},onError:m=>{o({title:"Error creating backup",description:m.message,variant:"destructive"}),p(!1)}}),c=J({mutationFn:async m=>{const N=await jc(`/api/admin/backup/${m}`);if(!N.ok)throw new Error("Failed to delete backup");return N.json()},onSuccess:()=>{o({title:"Backup deleted successfully"}),f()},onError:m=>{o({title:"Error deleting backup",description:m.message,variant:"destructive"})}}),R=J({mutationFn:async m=>{const N=await Pt(`/api/admin/backup/${m}/restore`);if(!N.ok)throw new Error("Failed to restore backup");return N.json()},onSuccess:()=>{o({title:"Backup restored successfully"})},onError:m=>{o({title:"Error restoring backup",description:m.message,variant:"destructive"})}}),D=async()=>{if(!i.trim()){o({title:"Please enter a backup name",variant:"destructive"});return}p(!0),await k.mutateAsync({type:a,name:i.trim()})},S=m=>{m.downloadUrl&&window.open(m.downloadUrl,"_blank")},q=m=>{switch(m){case"completed":return e.jsxs(P,{variant:"default",children:[e.jsx(fe,{className:"h-3 w-3 mr-1"}),"Completed"]});case"failed":return e.jsxs(P,{variant:"destructive",children:[e.jsx(as,{className:"h-3 w-3 mr-1"}),"Failed"]});case"in_progress":return e.jsxs(P,{variant:"secondary",children:[e.jsx(De,{className:"h-3 w-3 mr-1 animate-spin"}),"In Progress"]});default:return e.jsx(P,{variant:"outline",children:m})}},T=m=>({full:e.jsx(P,{className:"bg-blue-100 text-blue-800",children:"Full Backup"}),settings:e.jsx(P,{className:"bg-green-100 text-green-800",children:"Settings"}),data:e.jsx(P,{className:"bg-purple-100 text-purple-800",children:"Data Only"}),logs:e.jsx(P,{className:"bg-gray-100 text-gray-800",children:"Logs"})})[m]||e.jsx(P,{variant:"outline",children:m});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center",children:e.jsx(ms,{className:"h-6 w-6 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"Backup & Restore"}),e.jsx("p",{className:"text-neutral-600",children:"Manage system backups and data exports"})]})]}),e.jsxs(v,{onClick:()=>f(),variant:"outline",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),h&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Total Backups"}),e.jsx(ms,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-2xl font-bold",children:h.totalBackups})})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Total Size"}),e.jsx(vt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-2xl font-bold",children:h.totalSize})})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Last Backup"}),e.jsx(Ve,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-sm font-medium",children:h.lastBackup?new Date(h.lastBackup).toLocaleDateString():"Never"})})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Storage Used"}),e.jsx(dt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-sm font-medium",children:[Math.round(h.storageUsed/h.storageLimit*100),"%"]}),e.jsx(we,{value:h.storageUsed/h.storageLimit*100,className:"mt-2"})]})]})]}),e.jsxs(Te,{value:s,onValueChange:t,children:[e.jsxs(Se,{children:[e.jsx(U,{value:"backups",children:"Backups"}),e.jsx(U,{value:"create",children:"Create Backup"}),e.jsx(U,{value:"schedule",children:"Schedule"}),e.jsx(U,{value:"import",children:"Import/Export"})]}),e.jsx($,{value:"backups",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Backup History"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[j?.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h3",{className:"font-medium",children:m.name}),T(m.type),q(m.status)]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(ze,{className:"h-3 w-3 mr-1"}),new Date(m.createdAt).toLocaleString()]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(vt,{className:"h-3 w-3 mr-1"}),m.size]})]})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[m.status==="completed"&&e.jsxs(e.Fragment,{children:[e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>S(m),children:[e.jsx(_e,{className:"h-4 w-4 mr-1"}),"Download"]}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>R.mutate(m.id),disabled:R.isPending,children:[e.jsx(ht,{className:"h-4 w-4 mr-1"}),"Restore"]})]}),e.jsx(v,{variant:"destructive",size:"sm",onClick:()=>c.mutate(m.id),disabled:c.isPending,children:e.jsx(Ws,{className:"h-4 w-4"})})]})]},m.id)),(!j||j.length===0)&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ms,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No backups found. Create your first backup to get started."})]})]})})]})}),e.jsx($,{value:"create",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Create New Backup"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"backup-name",children:"Backup Name"}),e.jsx(I,{id:"backup-name",placeholder:"Enter backup name...",value:i,onChange:m=>l(m.target.value),disabled:u})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"backup-type",children:"Backup Type"}),e.jsxs(Z,{value:a,onValueChange:r,disabled:u,children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"full",children:"Full Backup (All data)"}),e.jsx(E,{value:"settings",children:"Settings Only"}),e.jsx(E,{value:"data",children:"User Data Only"}),e.jsx(E,{value:"logs",children:"Logs Only"})]})]})]}),u&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Creating Backup..."}),e.jsx(we,{value:n})]}),e.jsx("div",{className:"flex justify-end space-x-2",children:e.jsxs(v,{onClick:D,disabled:u||k.isPending,children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),u?"Creating...":"Create Backup"]})})]})]})}),e.jsx($,{value:"schedule",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Backup Schedule"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"schedule-frequency",children:"Frequency"}),e.jsxs(Z,{defaultValue:"weekly",children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"daily",children:"Daily"}),e.jsx(E,{value:"weekly",children:"Weekly"}),e.jsx(E,{value:"monthly",children:"Monthly"}),e.jsx(E,{value:"disabled",children:"Disabled"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"schedule-time",children:"Time"}),e.jsx(I,{type:"time",defaultValue:"02:00"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"retention-days",children:"Retention (days)"}),e.jsx(I,{type:"number",defaultValue:"30"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"max-backups",children:"Max Backups"}),e.jsx(I,{type:"number",defaultValue:"10"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Auto-cleanup Old Backups"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically delete backups older than retention period"})]}),e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(v,{children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"Save Schedule"]})})]})]})}),e.jsx($,{value:"import",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(ct,{className:"h-5 w-5"}),"Import Backup"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"import-file",children:"Select Backup File"}),e.jsx(I,{type:"file",accept:".zip,.tar.gz,.backup"})]}),e.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(as,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-yellow-800",children:"Warning"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Importing a backup will overwrite existing data. This action cannot be undone."})]})]})}),e.jsxs(v,{className:"w-full",children:[e.jsx(ct,{className:"h-4 w-4 mr-2"}),"Import Backup"]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"h-5 w-5"}),"Quick Export"]})}),e.jsx(y,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(v,{variant:"outline",className:"w-full justify-start",children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"Export All Settings"]}),e.jsxs(v,{variant:"outline",className:"w-full justify-start",children:[e.jsx(vt,{className:"h-4 w-4 mr-2"}),"Export User Data"]}),e.jsxs(v,{variant:"outline",className:"w-full justify-start",children:[e.jsx(dt,{className:"h-4 w-4 mr-2"}),"Export System Logs"]}),e.jsxs(v,{variant:"outline",className:"w-full justify-start",children:[e.jsx(ht,{className:"h-4 w-4 mr-2"}),"Export AI Configurations"]})]})})]})]})})]})]})}function Ec(){const[s,t]=x.useState("overview"),[a,r]=x.useState("all"),[i,l]=x.useState("24h"),{toast:n}=ve();Ss();const{data:d}=W({queryKey:["admin-security-metrics"],queryFn:async()=>{const S=await fetch("/api/admin/security/metrics");if(!S.ok)throw new Error("Failed to fetch security metrics");return S.json()}}),{data:u,refetch:p}=W({queryKey:["admin-security-events",a,i],queryFn:async()=>{const S=new URLSearchParams({severity:a,timeRange:i}),q=await fetch(`/api/admin/security/events?${S}`);if(!q.ok)throw new Error("Failed to fetch security events");return q.json()}}),{data:o,refetch:h}=W({queryKey:["admin-security-blocked-ips"],queryFn:async()=>{const S=await fetch("/api/admin/security/blocked-ips");if(!S.ok)throw new Error("Failed to fetch blocked IPs");return S.json()}}),j=J({mutationFn:async S=>{const q=await pe("/api/admin/security/block-ip",{method:"POST",body:JSON.stringify(S)});if(!q.ok)throw new Error("Failed to block IP");return q.json()},onSuccess:()=>{n({title:"IP address blocked successfully"}),h()},onError:S=>{n({title:"Error blocking IP",description:S.message,variant:"destructive"})}}),f=J({mutationFn:async S=>{const q=await pe(`/api/admin/security/unblock-ip/${S}`,{method:"DELETE"});if(!q.ok)throw new Error("Failed to unblock IP");return q.json()},onSuccess:()=>{n({title:"IP address unblocked successfully"}),h()},onError:S=>{n({title:"Error unblocking IP",description:S.message,variant:"destructive"})}}),k=J({mutationFn:async S=>{const q=await pe(`/api/admin/security/events/${S}/resolve`,{method:"POST"});if(!q.ok)throw new Error("Failed to resolve event");return q.json()},onSuccess:()=>{n({title:"Security event resolved"}),p()},onError:S=>{n({title:"Error resolving event",description:S.message,variant:"destructive"})}}),c=S=>({low:e.jsx(P,{variant:"secondary",children:"Low"}),medium:e.jsx(P,{variant:"outline",children:"Medium"}),high:e.jsx(P,{className:"bg-orange-100 text-orange-800",children:"High"}),critical:e.jsx(P,{variant:"destructive",children:"Critical"})})[S]||e.jsx(P,{children:S}),R=S=>({resolved:e.jsxs(P,{variant:"default",children:[e.jsx(fe,{className:"h-3 w-3 mr-1"}),"Resolved"]}),investigating:e.jsxs(P,{variant:"secondary",children:[e.jsx(Os,{className:"h-3 w-3 mr-1"}),"Investigating"]}),blocked:e.jsxs(P,{variant:"destructive",children:[e.jsx(Ut,{className:"h-3 w-3 mr-1"}),"Blocked"]}),pending:e.jsxs(P,{variant:"outline",children:[e.jsx(Ve,{className:"h-3 w-3 mr-1"}),"Pending"]})})[S]||e.jsx(P,{children:S}),D=S=>{const T={login_attempt:be,failed_login:xt,suspicious_activity:rs,password_change:Va,admin_action:Ee,api_abuse:ot}[S]||be;return e.jsx(T,{className:"h-4 w-4"})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(Ee,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"Security Center"}),e.jsx("p",{className:"text-neutral-600",children:"Monitor and manage system security"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(v,{onClick:()=>p(),variant:"outline",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(v,{variant:"outline",children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Export Report"]})]})]}),d&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Total Events"}),e.jsx(be,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-2xl font-bold",children:d.totalEvents})})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Critical Events"}),e.jsx(rs,{className:"h-4 w-4 text-red-500"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-2xl font-bold text-red-600",children:d.criticalEvents})})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Blocked IPs"}),e.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-2xl font-bold",children:d.blockedIPs})})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Failed Logins"}),e.jsx(xt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-2xl font-bold",children:d.failedLogins})})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Suspicious Activities"}),e.jsx(Os,{className:"h-4 w-4 text-orange-500"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:d.suspiciousActivities})})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Active Threats"}),e.jsx(ye,{className:"h-4 w-4 text-red-500"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-2xl font-bold text-red-600",children:d.activeThreats})})]})]}),e.jsxs(Te,{value:s,onValueChange:t,children:[e.jsxs(Se,{children:[e.jsx(U,{value:"overview",children:"Overview"}),e.jsx(U,{value:"events",children:"Security Events"}),e.jsx(U,{value:"blocked-ips",children:"Blocked IPs"}),e.jsx(U,{value:"settings",children:"Security Settings"})]}),e.jsx($,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-5 w-5 text-orange-500"}),"Recent Critical Events"]})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-3",children:u?.filter(S=>S.severity==="critical").slice(0,5).map(S=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[D(S.type),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:S.details}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[e.jsx("span",{children:S.user.email}),e.jsx("span",{children:"•"}),e.jsx("span",{children:new Date(S.timestamp).toLocaleString()})]})]})]}),c(S.severity)]},S.id))})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(Ut,{className:"h-5 w-5 text-red-500"}),"Recent Blocked IPs"]})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-3",children:o?.filter(S=>S.isActive).slice(0,5).map(S=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:S.ipAddress}),e.jsx("p",{className:"text-xs text-muted-foreground",children:S.reason}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[S.attempts," attempts • Blocked ",new Date(S.blockedAt).toLocaleString()]})]}),e.jsx(v,{variant:"outline",size:"sm",onClick:()=>f.mutate(S.id),children:"Unblock"})]},S.id))})})]})]})}),e.jsx($,{value:"events",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{children:"Security Events"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(Z,{value:a,onValueChange:r,children:[e.jsx(ee,{className:"w-32",children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"all",children:"All Severity"}),e.jsx(E,{value:"critical",children:"Critical"}),e.jsx(E,{value:"high",children:"High"}),e.jsx(E,{value:"medium",children:"Medium"}),e.jsx(E,{value:"low",children:"Low"})]})]}),e.jsxs(Z,{value:i,onValueChange:l,children:[e.jsx(ee,{className:"w-32",children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"1h",children:"Last Hour"}),e.jsx(E,{value:"24h",children:"Last 24h"}),e.jsx(E,{value:"7d",children:"Last 7 days"}),e.jsx(E,{value:"30d",children:"Last 30 days"})]})]})]})]})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-3",children:[u?.map(S=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[D(S.type),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("p",{className:"font-medium",children:S.details}),c(S.severity),R(S.status)]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(Li,{className:"h-3 w-3 mr-1"}),S.user.email]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(ot,{className:"h-3 w-3 mr-1"}),S.ipAddress]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(Ve,{className:"h-3 w-3 mr-1"}),new Date(S.timestamp).toLocaleString()]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[S.location," • ",S.userAgent.substring(0,50),"..."]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[S.status!=="resolved"&&e.jsx(v,{variant:"outline",size:"sm",onClick:()=>k.mutate(S.id),children:"Resolve"}),e.jsx(v,{variant:"destructive",size:"sm",onClick:()=>j.mutate({ipAddress:S.ipAddress,reason:`Security event: ${S.details}`}),children:"Block IP"})]})]},S.id)),(!u||u.length===0)&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Ee,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No security events found for the selected criteria."})]})]})})]})}),e.jsx($,{value:"blocked-ips",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Blocked IP Addresses"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{placeholder:"Enter IP address to block...",className:"flex-1"}),e.jsx(I,{placeholder:"Reason...",className:"flex-1"}),e.jsx(v,{children:"Block IP"})]}),e.jsx("div",{className:"space-y-3",children:o?.map(S=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("p",{className:"font-medium",children:S.ipAddress}),e.jsx(P,{variant:S.isActive?"destructive":"secondary",children:S.isActive?"Active":"Inactive"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:S.reason}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[e.jsxs("span",{children:[S.attempts," attempts"]}),e.jsxs("span",{children:["Blocked by ",S.blockedBy]}),e.jsx("span",{children:new Date(S.blockedAt).toLocaleString()})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:S.isActive?e.jsx(v,{variant:"outline",size:"sm",onClick:()=>f.mutate(S.id),children:"Unblock"}):e.jsx(v,{variant:"destructive",size:"sm",onClick:()=>j.mutate({ipAddress:S.ipAddress,reason:S.reason}),children:"Reactivate"})})]},S.id))})]})})]})}),e.jsx($,{value:"settings",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Security Policies"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Auto-block Suspicious IPs"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically block IPs with suspicious activity"})]}),e.jsx(G,{defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Rate Limiting"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable API rate limiting"})]}),e.jsx(G,{defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Failed Login Monitoring"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Monitor and alert on failed login attempts"})]}),e.jsx(G,{defaultChecked:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Max Login Attempts"}),e.jsx(I,{type:"number",defaultValue:"5"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Lockout Duration (minutes)"}),e.jsx(I,{type:"number",defaultValue:"15"})]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Notification Settings"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Email Alerts"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Send email alerts for security events"})]}),e.jsx(G,{defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Slack Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Send alerts to Slack channel"})]}),e.jsx(G,{})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Alert Threshold"}),e.jsxs(Z,{defaultValue:"medium",children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"low",children:"Low and above"}),e.jsx(E,{value:"medium",children:"Medium and above"}),e.jsx(E,{value:"high",children:"High and above"}),e.jsx(E,{value:"critical",children:"Critical only"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Admin Email"}),e.jsx(I,{type:"email",placeholder:"admin@example.com"})]})]})]})]})})]})]})}const hs=x.forwardRef(({className:s,...t},a)=>e.jsx(Wa,{ref:a,className:L("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...t,children:e.jsx(Oi,{className:L("flex items-center justify-center text-current"),children:e.jsx(pt,{className:"h-4 w-4"})})}));hs.displayName=Wa.displayName;function Tc(){const[s,t]=x.useState("notifications"),[a,r]=x.useState("all"),[i,l]=x.useState("all"),[n,d]=x.useState(!1),[u,p]=x.useState({title:"",message:"",type:"info",priority:"medium",channels:[],recipients:{type:"all",count:0}}),{toast:o}=ve();Ss();const{data:h}=W({queryKey:["admin-notification-stats"],queryFn:async()=>{const m=await fetch("/api/admin/notifications/stats");if(!m.ok)throw new Error("Failed to fetch notification stats");return m.json()}}),{data:j,refetch:f}=W({queryKey:["admin-notifications",a,i],queryFn:async()=>{const m=new URLSearchParams({type:a,status:i}),N=await fetch(`/api/admin/notifications?${m}`);if(!N.ok)throw new Error("Failed to fetch notifications");return N.json()}}),{data:k}=W({queryKey:["admin-notification-templates"],queryFn:async()=>{const m=await fetch("/api/admin/notifications/templates");if(!m.ok)throw new Error("Failed to fetch templates");return m.json()}}),c=J({mutationFn:async m=>{const N=await pe("/api/admin/notifications",{method:"POST",body:m});if(!N.ok)throw new Error("Failed to create notification");return N.json()},onSuccess:()=>{o({title:"Notification created successfully"}),f(),d(!1),p({title:"",message:"",type:"info",priority:"medium",channels:[],recipients:{type:"all",count:0}})},onError:m=>{o({title:"Error creating notification",description:m.message,variant:"destructive"})}}),R=J({mutationFn:async m=>{const N=await pe(`/api/admin/notifications/${m}/send`,{method:"POST"});if(!N.ok)throw new Error("Failed to send notification");return N.json()},onSuccess:()=>{o({title:"Notification sent successfully"}),f()},onError:m=>{o({title:"Error sending notification",description:m.message,variant:"destructive"})}}),D=m=>({info:e.jsx(P,{variant:"secondary",children:"Info"}),warning:e.jsx(P,{className:"bg-yellow-100 text-yellow-800",children:"Warning"}),error:e.jsx(P,{variant:"destructive",children:"Error"}),success:e.jsx(P,{variant:"default",children:"Success"})})[m]||e.jsx(P,{children:m}),S=m=>({low:e.jsx(P,{variant:"outline",children:"Low"}),medium:e.jsx(P,{variant:"secondary",children:"Medium"}),high:e.jsx(P,{className:"bg-orange-100 text-orange-800",children:"High"}),urgent:e.jsx(P,{variant:"destructive",children:"Urgent"})})[m]||e.jsx(P,{children:m}),q=m=>({draft:e.jsx(P,{variant:"outline",children:"Draft"}),scheduled:e.jsx(P,{className:"bg-blue-100 text-blue-800",children:"Scheduled"}),sent:e.jsx(P,{variant:"default",children:"Sent"}),failed:e.jsx(P,{variant:"destructive",children:"Failed"})})[m]||e.jsx(P,{children:m}),T=async()=>{if(!u.title||!u.message){o({title:"Please fill in all required fields",variant:"destructive"});return}await c.mutateAsync(u)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(bs,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"Notification Center"}),e.jsx("p",{className:"text-neutral-600",children:"Manage system notifications and alerts"})]})]}),e.jsxs(v,{onClick:()=>d(!0),children:[e.jsx(la,{className:"h-4 w-4 mr-2"}),"Create Notification"]})]}),h&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Total Sent"}),e.jsx(Et,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-2xl font-bold",children:h.totalSent})})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Scheduled"}),e.jsx(Ve,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-2xl font-bold",children:h.totalScheduled})})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Open Rate"}),e.jsx(Os,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:e.jsxs("div",{className:"text-2xl font-bold",children:[h.averageOpenRate,"%"]})})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Click Rate"}),e.jsx(fe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:e.jsxs("div",{className:"text-2xl font-bold",children:[h.averageClickRate,"%"]})})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Failed"}),e.jsx(as,{className:"h-4 w-4 text-red-500"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-2xl font-bold text-red-600",children:h.failedDeliveries})})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Subscribers"}),e.jsx(Me,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(y,{children:e.jsx("div",{className:"text-2xl font-bold",children:h.activeSubscribers})})]})]}),e.jsxs(Te,{value:s,onValueChange:t,children:[e.jsxs(Se,{children:[e.jsx(U,{value:"notifications",children:"Notifications"}),e.jsx(U,{value:"templates",children:"Templates"}),e.jsx(U,{value:"settings",children:"Settings"}),e.jsx(U,{value:"analytics",children:"Analytics"})]}),e.jsx($,{value:"notifications",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{children:"Notifications"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(Z,{value:a,onValueChange:r,children:[e.jsx(ee,{className:"w-32",children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"all",children:"All Types"}),e.jsx(E,{value:"info",children:"Info"}),e.jsx(E,{value:"warning",children:"Warning"}),e.jsx(E,{value:"error",children:"Error"}),e.jsx(E,{value:"success",children:"Success"})]})]}),e.jsxs(Z,{value:i,onValueChange:l,children:[e.jsx(ee,{className:"w-32",children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"all",children:"All Status"}),e.jsx(E,{value:"draft",children:"Draft"}),e.jsx(E,{value:"scheduled",children:"Scheduled"}),e.jsx(E,{value:"sent",children:"Sent"}),e.jsx(E,{value:"failed",children:"Failed"})]})]})]})]})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[j?.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h3",{className:"font-medium",children:m.title}),D(m.type),S(m.priority),q(m.status)]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:m.message}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(Me,{className:"h-3 w-3 mr-1"}),m.recipients.count," recipients"]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(ze,{className:"h-3 w-3 mr-1"}),new Date(m.createdAt).toLocaleString()]}),m.openRate&&e.jsxs("span",{className:"flex items-center",children:[e.jsx(Os,{className:"h-3 w-3 mr-1"}),m.openRate,"% open rate"]})]}),e.jsx("div",{className:"flex items-center space-x-2 mt-2",children:m.channels.map(N=>e.jsx(P,{variant:"outline",className:"text-xs",children:N},N))})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[m.status==="draft"&&e.jsxs(v,{variant:"default",size:"sm",onClick:()=>R.mutate(m.id),children:[e.jsx(Et,{className:"h-4 w-4 mr-1"}),"Send"]}),e.jsx(v,{variant:"outline",size:"sm",children:e.jsx(Ct,{className:"h-4 w-4"})}),e.jsx(v,{variant:"outline",size:"sm",children:e.jsx(ht,{className:"h-4 w-4"})}),e.jsx(v,{variant:"destructive",size:"sm",children:e.jsx(Ws,{className:"h-4 w-4"})})]})]},m.id)),(!j||j.length===0)&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(bs,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No notifications found for the selected criteria."})]})]})})]})}),e.jsx($,{value:"templates",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{children:"Notification Templates"}),e.jsxs(v,{children:[e.jsx(la,{className:"h-4 w-4 mr-2"}),"Create Template"]})]})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-4",children:k?.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h3",{className:"font-medium",children:m.name}),e.jsx(P,{variant:"outline",children:m.type}),e.jsx(P,{variant:m.isActive?"default":"secondary",children:m.isActive?"Active":"Inactive"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m.subject}),e.jsx("div",{className:"flex items-center space-x-2 mt-2",children:m.variables.map(N=>e.jsx(P,{variant:"outline",className:"text-xs",children:N},N))})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{variant:"outline",size:"sm",children:e.jsx(Ct,{className:"h-4 w-4"})}),e.jsx(v,{variant:"outline",size:"sm",children:e.jsx(ht,{className:"h-4 w-4"})}),e.jsx(v,{variant:"destructive",size:"sm",children:e.jsx(Ws,{className:"h-4 w-4"})})]})]},m.id))})})]})}),e.jsx($,{value:"settings",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Notification Channels"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Send notifications via email"})]}),e.jsx(G,{defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Push Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Send browser push notifications"})]}),e.jsx(G,{defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"SMS Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Send SMS notifications"})]}),e.jsx(G,{})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Slack Integration"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Send notifications to Slack"})]}),e.jsx(G,{})]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Delivery Settings"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Default Send Time"}),e.jsx(I,{type:"time",defaultValue:"09:00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Max Daily Notifications"}),e.jsx(I,{type:"number",defaultValue:"5"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Retry Failed Deliveries"}),e.jsxs(Z,{defaultValue:"3",children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"1",children:"1 time"}),e.jsx(E,{value:"3",children:"3 times"}),e.jsx(E,{value:"5",children:"5 times"}),e.jsx(E,{value:"0",children:"Never"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-base font-medium",children:"Delivery Confirmation"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Track delivery status"})]}),e.jsx(G,{defaultChecked:!0})]})]})]})]})}),e.jsx($,{value:"analytics",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Delivery Analytics"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Email Delivery Rate"}),e.jsx("span",{className:"font-medium",children:"95.2%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Push Delivery Rate"}),e.jsx("span",{className:"font-medium",children:"87.8%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"SMS Delivery Rate"}),e.jsx("span",{className:"font-medium",children:"99.1%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Average Open Rate"}),e.jsx("span",{className:"font-medium",children:"24.3%"})]})]})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Engagement Metrics"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Click-through Rate"}),e.jsx("span",{className:"font-medium",children:"3.2%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Unsubscribe Rate"}),e.jsx("span",{className:"font-medium",children:"0.8%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Bounce Rate"}),e.jsx("span",{className:"font-medium",children:"2.1%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Complaint Rate"}),e.jsx("span",{className:"font-medium",children:"0.1%"})]})]})})]})]})})]}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Create New Notification"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"title",children:"Title"}),e.jsx(I,{id:"title",value:u.title,onChange:m=>p({...u,title:m.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"message",children:"Message"}),e.jsx($e,{id:"message",value:u.message,onChange:m=>p({...u,message:m.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Type"}),e.jsxs(Z,{value:u.type,onValueChange:m=>p({...u,type:m}),children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"info",children:"Info"}),e.jsx(E,{value:"warning",children:"Warning"}),e.jsx(E,{value:"error",children:"Error"}),e.jsx(E,{value:"success",children:"Success"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Priority"}),e.jsxs(Z,{value:u.priority,onValueChange:m=>p({...u,priority:m}),children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"low",children:"Low"}),e.jsx(E,{value:"medium",children:"Medium"}),e.jsx(E,{value:"high",children:"High"}),e.jsx(E,{value:"urgent",children:"Urgent"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Channels"}),e.jsx("div",{className:"flex items-center space-x-4 mt-2",children:["email","push","sms","slack"].map(m=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hs,{checked:u.channels.includes(m),onCheckedChange:N=>{p(N?{...u,channels:[...u.channels,m]}:{...u,channels:u.channels.filter(F=>F!==m)})}}),e.jsx(C,{className:"capitalize",children:m})]},m))})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[e.jsx(v,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(v,{onClick:T,disabled:c.isPending,children:"Create Notification"})]})]})})]})}function Ac(){const[s,t]=x.useState("overview"),[a,r]=x.useState(!0),{data:i,refetch:l}=W({queryKey:["admin-dashboard-stats"],queryFn:async()=>{const h=await fetch("/api/admin/dashboard/stats");if(!h.ok)throw new Error("Failed to fetch dashboard stats");return h.json()},refetchInterval:a?3e4:!1}),{data:n}=W({queryKey:["admin-dashboard-activity"],queryFn:async()=>{const h=await fetch("/api/admin/dashboard/activity");if(!h.ok)throw new Error("Failed to fetch recent activity");return h.json()},refetchInterval:a?15e3:!1}),{data:d}=W({queryKey:["admin-dashboard-alerts"],queryFn:async()=>{const h=await fetch("/api/admin/dashboard/alerts");if(!h.ok)throw new Error("Failed to fetch system alerts");return h.json()},refetchInterval:a?1e4:!1}),u=h=>{const f={user_registration:Me,premium_upgrade:ws,ai_analysis:es,system_alert:rs,security_event:Ee}[h]||be;return e.jsx(f,{className:"h-4 w-4"})},p=h=>({low:"text-green-600",medium:"text-yellow-600",high:"text-orange-600",critical:"text-red-600",info:"text-blue-600",warning:"text-yellow-600",error:"text-red-600"})[h]||"text-gray-600",o=h=>h>=90?"bg-red-500":h>=75?"bg-orange-500":h>=50?"bg-yellow-500":"bg-green-500";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"Dashboard Overview"}),e.jsx("p",{className:"text-neutral-600",children:"Real-time system monitoring and analytics"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(v,{variant:a?"default":"outline",size:"sm",onClick:()=>r(!a),children:[a?e.jsx(be,{className:"h-4 w-4 mr-2 animate-pulse"}):e.jsx(De,{className:"h-4 w-4 mr-2"}),a?"Live":"Manual"]}),e.jsxs(v,{onClick:()=>l(),variant:"outline",size:"sm",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),(d?.filter(h=>h.severity==="critical"&&!h.acknowledged).length||0)>0&&e.jsxs(g,{className:"border-red-200 bg-red-50",children:[e.jsx(b,{children:e.jsxs(w,{className:"text-red-800 flex items-center gap-2",children:[e.jsx(rs,{className:"h-5 w-5"}),"Critical Alerts Require Attention"]})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-2",children:(d||[]).filter(h=>h.severity==="critical"&&!h.acknowledged).map(h=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded border",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-red-900",children:h.title}),e.jsx("p",{className:"text-sm text-red-700",children:h.message})]}),e.jsx(v,{variant:"destructive",size:"sm",children:"Acknowledge"})]},h.id))})})]}),e.jsxs(Te,{value:s,onValueChange:t,children:[e.jsxs(Se,{children:[e.jsx(U,{value:"overview",children:"Overview"}),e.jsx(U,{value:"performance",children:"Performance"}),e.jsx(U,{value:"activity",children:"Activity"}),e.jsx(U,{value:"alerts",children:"Alerts"})]}),e.jsxs($,{value:"overview",className:"space-y-6",children:[i&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Total Users"}),e.jsx(Me,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i.users.total.toLocaleString()}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center",children:[i.users.growthRate>0?e.jsx(ye,{className:"h-3 w-3 text-green-600 mr-1"}):e.jsx(Tt,{className:"h-3 w-3 text-red-600 mr-1"}),e.jsxs("span",{className:i.users.growthRate>0?"text-green-600":"text-red-600",children:[Math.abs(i.users.growthRate),"%"]})]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[i.users.newToday," new today"]})]}),e.jsx("div",{className:"mt-2 space-y-1",children:e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("span",{children:["Premium: ",i.users.premium]}),e.jsxs("span",{children:["Active: ",i.users.active]})]})})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Revenue"}),e.jsx(ws,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",i.revenue.total.toLocaleString()]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center",children:[i.revenue.growthRate>0?e.jsx(ye,{className:"h-3 w-3 text-green-600 mr-1"}):e.jsx(Tt,{className:"h-3 w-3 text-red-600 mr-1"}),e.jsxs("span",{className:i.revenue.growthRate>0?"text-green-600":"text-red-600",children:[Math.abs(i.revenue.growthRate),"%"]})]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["$",i.revenue.daily," today"]})]}),e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Monthly: $",i.revenue.monthly.toLocaleString()]})})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"AI Analyses"}),e.jsx(es,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i.ai.totalAnalyses.toLocaleString()}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[e.jsx(fe,{className:"h-3 w-3 text-green-600"}),e.jsxs("span",{children:[i.ai.successRate,"% success rate"]})]}),e.jsx("div",{className:"mt-2 space-y-1",children:e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("span",{children:["Avg Response: ",i.ai.averageResponseTime,"ms"]}),e.jsxs("span",{children:["Cost Today: $",i.ai.costToday]})]})})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"System Health"}),e.jsx(ca,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[i.system.uptime,"%"]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{children:"System Online"})]}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("span",{children:["CPU: ",i.system.cpuUsage,"%"]}),e.jsxs("span",{children:["Memory: ",i.system.memoryUsage,"%"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[i.system.activeConnections," active connections"]})]})]})]})]}),i&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(ca,{className:"h-5 w-5"}),"System Resources"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"CPU Usage"}),e.jsxs("span",{children:[i.system.cpuUsage,"%"]})]}),e.jsx(we,{value:i.system.cpuUsage,className:`h-2 ${o(i.system.cpuUsage)}`})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Memory Usage"}),e.jsxs("span",{children:[i.system.memoryUsage,"%"]})]}),e.jsx(we,{value:i.system.memoryUsage,className:`h-2 ${o(i.system.memoryUsage)}`})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Disk Usage"}),e.jsxs("span",{children:[i.system.diskUsage,"%"]})]}),e.jsx(we,{value:i.system.diskUsage,className:`h-2 ${o(i.system.diskUsage)}`})]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-5 w-5"}),"Security Overview"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:i.security.threatsBlocked}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Threats Blocked"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:i.security.failedLogins}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Failed Logins"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Active Threats"}),e.jsx(P,{variant:i.security.activeThreats>0?"destructive":"default",children:i.security.activeThreats})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Last incident: ",i.security.lastIncident]})]})]})]})]}),e.jsx($,{value:"performance",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(ta,{className:"h-5 w-5"}),"AI Performance"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Success Rate"}),e.jsxs("span",{className:"font-medium",children:[i?.ai.successRate,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Avg Response Time"}),e.jsxs("span",{className:"font-medium",children:[i?.ai.averageResponseTime,"ms"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Daily Cost"}),e.jsxs("span",{className:"font-medium",children:["$",i?.ai.costToday]})]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(ms,{className:"h-5 w-5"}),"Database Performance"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Query Time"}),e.jsx("span",{className:"font-medium",children:"12ms avg"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Connections"}),e.jsx("span",{className:"font-medium",children:i?.system.activeConnections})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Cache Hit Rate"}),e.jsx("span",{className:"font-medium",children:"94.5%"})]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"h-5 w-5"}),"Network Performance"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Uptime"}),e.jsxs("span",{className:"font-medium",children:[i?.system.uptime,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Response Time"}),e.jsx("span",{className:"font-medium",children:"45ms avg"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Error Rate"}),e.jsx("span",{className:"font-medium",children:"0.02%"})]})]})]})]})}),e.jsx($,{value:"activity",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-5 w-5"}),"Recent Activity"]})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-3",children:n?.map(h=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[u(h.type),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:h.message}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[e.jsx(Ve,{className:"h-3 w-3"}),e.jsx("span",{children:new Date(h.timestamp).toLocaleString()}),h.user&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{children:h.user.name})]})]})]}),h.severity&&e.jsx(P,{variant:h.severity==="critical"?"destructive":"secondary",className:p(h.severity),children:h.severity})]},h.id))})})]})}),e.jsx($,{value:"alerts",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"h-5 w-5"}),"System Alerts"]})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-3",children:[d?.map(h=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(rs,{className:`h-4 w-4 ${p(h.severity)}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:h.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:h.message}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground mt-1",children:[e.jsx(Ve,{className:"h-3 w-3"}),e.jsx("span",{children:new Date(h.timestamp).toLocaleString()})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{variant:h.severity==="critical"?"destructive":"secondary",className:p(h.severity),children:h.severity}),!h.acknowledged&&e.jsx(v,{variant:"outline",size:"sm",children:"Acknowledge"})]})]},h.id)),(!d||d.length===0)&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(fe,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No active system alerts. All systems operating normally."})]})]})})]})})]})]})}function Rc(){const[s,t]=x.useState("logs"),[a,r]=x.useState({category:"all",severity:"all",success:"all",timeRange:"24h",userId:"",action:"",ipAddress:""}),[i,l]=x.useState(""),{toast:n}=ve(),{data:d}=W({queryKey:["admin-activity-stats"],queryFn:async()=>{const c=await fetch("/api/admin/activity/stats");if(!c.ok)throw new Error("Failed to fetch activity stats");return c.json()},refetchInterval:3e4}),{data:u,refetch:p}=W({queryKey:["admin-activity-logs",a,i],queryFn:async()=>{const c=new URLSearchParams({...a,search:i}),R=await fetch(`/api/admin/activity/logs?${c}`);if(!R.ok)throw new Error("Failed to fetch activity logs");return R.json()},refetchInterval:15e3}),o=J({mutationFn:async c=>{const R=new URLSearchParams({...a,search:i,format:c}),D=await fetch(`/api/admin/activity/export?${R}`);if(!D.ok)throw new Error("Failed to export logs");return D.blob()},onSuccess:(c,R)=>{const D=window.URL.createObjectURL(c),S=document.createElement("a");S.href=D,S.download=`activity-logs-${new Date().toISOString().split("T")[0]}.${R}`,document.body.appendChild(S),S.click(),window.URL.revokeObjectURL(D),document.body.removeChild(S),n({title:`Activity logs exported as ${R.toUpperCase()}`})},onError:c=>{n({title:"Export failed",description:c.message,variant:"destructive"})}}),h=c=>{const D={auth:Ee,user:Ns,admin:ls,system:dt,payment:sa,ai:es,security:Ee,data:ms}[c]||be;return e.jsx(D,{className:"h-4 w-4"})},j=c=>({auth:"bg-blue-100 text-blue-800",user:"bg-green-100 text-green-800",admin:"bg-purple-100 text-purple-800",system:"bg-gray-100 text-gray-800",payment:"bg-emerald-100 text-emerald-800",ai:"bg-orange-100 text-orange-800",security:"bg-red-100 text-red-800",data:"bg-indigo-100 text-indigo-800"})[c]||"bg-gray-100 text-gray-800",f=c=>({low:"text-green-600",medium:"text-yellow-600",high:"text-orange-600",critical:"text-red-600"})[c]||"text-gray-600",k=c=>{const R=new Date,D=new Date(c),S=Math.floor((R.getTime()-D.getTime())/6e4);return S<1?"Just now":S<60?`${S}m ago`:S<1440?`${Math.floor(S/60)}h ago`:`${Math.floor(S/1440)}d ago`};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(be,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"Activity Logger"}),e.jsx("p",{className:"text-neutral-600",children:"Comprehensive system activity tracking and audit logs"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(v,{variant:"outline",onClick:()=>o.mutate("csv"),disabled:o.isPending,children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Export CSV"]}),e.jsxs(v,{variant:"outline",onClick:()=>o.mutate("json"),disabled:o.isPending,children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Export JSON"]})]})]}),d&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Total Activities"}),e.jsx(be,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.totalActivities.toLocaleString()}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[d.activitiesLast24h," in last 24h"]})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Security Events"}),e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.securityEvents}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[d.failedAttempts," failed attempts"]})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Unique IPs"}),e.jsx(Kt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.uniqueIPs}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Last 7 days"})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Weekly Growth"}),e.jsx(ze,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.activitiesLast7d}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Activities this week"})]})]})]}),e.jsxs(Te,{value:s,onValueChange:t,children:[e.jsxs(Se,{children:[e.jsx(U,{value:"logs",children:"Activity Logs"}),e.jsx(U,{value:"analytics",children:"Analytics"}),e.jsx(U,{value:"filters",children:"Advanced Filters"})]}),e.jsxs($,{value:"logs",className:"space-y-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(mt,{className:"h-5 w-5"}),"Search & Filter"]})}),e.jsx(y,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(C,{htmlFor:"search",children:"Search"}),e.jsx(I,{id:"search",placeholder:"Search activities...",value:i,onChange:c=>l(c.target.value)})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Category"}),e.jsxs(Z,{value:a.category,onValueChange:c=>r({...a,category:c}),children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"all",children:"All Categories"}),e.jsx(E,{value:"auth",children:"Authentication"}),e.jsx(E,{value:"user",children:"User Actions"}),e.jsx(E,{value:"admin",children:"Admin Actions"}),e.jsx(E,{value:"system",children:"System Events"}),e.jsx(E,{value:"payment",children:"Payments"}),e.jsx(E,{value:"ai",children:"AI Operations"}),e.jsx(E,{value:"security",children:"Security"}),e.jsx(E,{value:"data",children:"Data Operations"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Severity"}),e.jsxs(Z,{value:a.severity,onValueChange:c=>r({...a,severity:c}),children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"all",children:"All Severities"}),e.jsx(E,{value:"low",children:"Low"}),e.jsx(E,{value:"medium",children:"Medium"}),e.jsx(E,{value:"high",children:"High"}),e.jsx(E,{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Success"}),e.jsxs(Z,{value:a.success,onValueChange:c=>r({...a,success:c}),children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"all",children:"All"}),e.jsx(E,{value:"true",children:"Success"}),e.jsx(E,{value:"false",children:"Failed"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Time Range"}),e.jsxs(Z,{value:a.timeRange,onValueChange:c=>r({...a,timeRange:c}),children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"1h",children:"Last Hour"}),e.jsx(E,{value:"24h",children:"Last 24 Hours"}),e.jsx(E,{value:"7d",children:"Last 7 Days"}),e.jsx(E,{value:"30d",children:"Last 30 Days"})]})]})]})]})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{children:"Activity Logs"}),e.jsxs(v,{onClick:()=>p(),variant:"outline",size:"sm",children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),e.jsx(y,{children:e.jsx(ys,{className:"h-96",children:e.jsxs("div",{className:"space-y-3",children:[u?.map(c=>e.jsxs("div",{className:"flex items-start space-x-4 p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[h(c.category),c.success?e.jsx(fe,{className:"h-4 w-4 text-green-500"}):e.jsx(xt,{className:"h-4 w-4 text-red-500"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h3",{className:"font-medium truncate",children:c.action}),e.jsx(P,{className:j(c.category),children:c.category}),e.jsx(P,{variant:"outline",className:f(c.severity),children:c.severity})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:c.description}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(Ve,{className:"h-3 w-3 mr-1"}),k(c.timestamp)]}),c.userEmail&&e.jsxs("span",{className:"flex items-center",children:[e.jsx(Ns,{className:"h-3 w-3 mr-1"}),c.userEmail]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(Kt,{className:"h-3 w-3 mr-1"}),c.ipAddress]}),c.location&&e.jsxs("span",{children:[c.location.city,", ",c.location.country]})]}),c.metadata&&Object.keys(c.metadata).length>0&&e.jsxs("details",{className:"mt-2",children:[e.jsx("summary",{className:"text-xs text-muted-foreground cursor-pointer",children:"Show metadata"}),e.jsx("pre",{className:"text-xs bg-gray-100 p-2 rounded mt-1 overflow-auto",children:JSON.stringify(c.metadata,null,2)})]})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(c.timestamp).toLocaleString()})]},c.id)),(!u||u.length===0)&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Zs,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No activity logs found for the current filters."})]})]})})})]})]}),e.jsx($,{value:"analytics",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Top Actions"})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-3",children:d?.topActions.map((c,R)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm font-medium",children:["#",R+1]}),e.jsx("span",{className:"text-sm",children:c.action})]}),e.jsx(P,{variant:"secondary",children:c.count})]},c.action))})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Most Active Users"})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-3",children:d?.topUsers.map((c,R)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm font-medium",children:["#",R+1]}),e.jsx("span",{className:"text-sm truncate",children:c.email})]}),e.jsx(P,{variant:"secondary",children:c.count})]},c.email))})})]})]})}),e.jsx($,{value:"filters",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center gap-2",children:[e.jsx(Ui,{className:"h-5 w-5"}),"Advanced Filters"]})}),e.jsx(y,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"user-id",children:"User ID"}),e.jsx(I,{id:"user-id",placeholder:"Filter by user ID",value:a.userId,onChange:c=>r({...a,userId:c.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"action",children:"Action"}),e.jsx(I,{id:"action",placeholder:"Filter by action",value:a.action,onChange:c=>r({...a,action:c.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"ip-address",children:"IP Address"}),e.jsx(I,{id:"ip-address",placeholder:"Filter by IP address",value:a.ipAddress,onChange:c=>r({...a,ipAddress:c.target.value})})]})]})})]})})]})]})}function Pc(){const[s,t]=x.useState("generator"),[a,r]=x.useState({title:"",description:"",type:"system",timeRange:{start:new Date(Date.now()-720*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]},sections:{userMetrics:!0,financialMetrics:!0,systemMetrics:!0,aiMetrics:!0,securityMetrics:!1,activityLogs:!1,customCharts:!1},format:"pdf",includeCharts:!0,includeRawData:!1,emailRecipients:[]}),[i,l]=x.useState({name:"",description:"",type:"system",sections:[],schedule:{frequency:"weekly",time:"09:00",recipients:[],enabled:!1}}),[n,d]=x.useState(""),{toast:u}=ve(),{data:p}=W({queryKey:["admin-report-templates"],queryFn:async()=>{const m=await fetch("/api/admin/reports/templates");if(!m.ok)throw new Error("Failed to fetch report templates");return m.json()}}),{data:o,refetch:h}=W({queryKey:["admin-generated-reports"],queryFn:async()=>{const m=await fetch("/api/admin/reports/generated");if(!m.ok)throw new Error("Failed to fetch generated reports");return m.json()},refetchInterval:5e3}),j=J({mutationFn:async m=>{const N=await Pt("/api/admin/reports/generate",m);if(!N.ok)throw new Error("Failed to generate report");return N.json()},onSuccess:()=>{u({title:"Report generation started",description:"You'll be notified when it's ready"}),h()},onError:m=>{u({title:"Report generation failed",description:m.message,variant:"destructive"})}}),f=J({mutationFn:async m=>{const N=await Pt("/api/admin/reports/templates",m);if(!N.ok)throw new Error("Failed to create template");return N.json()},onSuccess:()=>{u({title:"Template created successfully"}),l({name:"",description:"",type:"system",sections:[],schedule:{frequency:"weekly",time:"09:00",recipients:[],enabled:!1}})},onError:m=>{u({title:"Failed to create template",description:m.message,variant:"destructive"})}});J({mutationFn:async({templateId:m,schedule:N})=>{const F=await uc(`/api/admin/reports/templates/${m}/schedule`,N);if(!F.ok)throw new Error("Failed to schedule report");return F.json()},onSuccess:()=>{u({title:"Report scheduled successfully"})},onError:m=>{u({title:"Failed to schedule report",description:m.message,variant:"destructive"})}});const k=(m,N)=>{r(F=>({...F,[m]:N}))},c=m=>{r(N=>({...N,sections:{...N.sections,[m]:!N.sections[m]}}))},R=()=>{const m=n.split(",").map(N=>N.trim()).filter(N=>N);r(N=>({...N,emailRecipients:m}))},D=()=>{if(!a.title){u({title:"Please enter a report title",variant:"destructive"});return}const m={...a,emailRecipients:n.split(",").map(N=>N.trim()).filter(N=>N)};j.mutate(m)},S=m=>{const F={system:ls,analytics:It,financial:ws,security:Ee,user:Me,ai:es,custom:Zs}[m]||Zs;return e.jsx(F,{className:"h-4 w-4"})},q=m=>({pending:"bg-yellow-100 text-yellow-800",completed:"bg-green-100 text-green-800",failed:"bg-red-100 text-red-800"})[m]||"bg-gray-100 text-gray-800",T=m=>{const N=["B","KB","MB","GB"];let F=m,A=0;for(;F>=1024&&A<N.length-1;)F/=1024,A++;return`${F.toFixed(1)} ${N[A]}`};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center",children:e.jsx(Zs,{className:"h-6 w-6 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-neutral-900",children:"Report Generator"}),e.jsx("p",{className:"text-neutral-600",children:"Generate comprehensive system and analytics reports"})]})]})}),e.jsxs(Te,{value:s,onValueChange:t,children:[e.jsxs(Se,{children:[e.jsx(U,{value:"generator",children:"Generate Report"}),e.jsx(U,{value:"templates",children:"Templates"}),e.jsx(U,{value:"generated",children:"Generated Reports"}),e.jsx(U,{value:"schedule",children:"Scheduled Reports"})]}),e.jsx($,{value:"generator",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Report Configuration"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"title",children:"Report Title"}),e.jsx(I,{id:"title",value:a.title,onChange:m=>k("title",m.target.value),placeholder:"Enter report title"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"type",children:"Report Type"}),e.jsxs(Z,{value:a.type,onValueChange:m=>k("type",m),children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"system",children:"System Report"}),e.jsx(E,{value:"analytics",children:"Analytics Report"}),e.jsx(E,{value:"financial",children:"Financial Report"}),e.jsx(E,{value:"security",children:"Security Report"}),e.jsx(E,{value:"user",children:"User Report"}),e.jsx(E,{value:"ai",children:"AI Usage Report"}),e.jsx(E,{value:"custom",children:"Custom Report"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"start-date",children:"Start Date"}),e.jsx(I,{id:"start-date",type:"date",value:a.timeRange.start,onChange:m=>k("timeRange",{...a.timeRange,start:m.target.value})})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"end-date",children:"End Date"}),e.jsx(I,{id:"end-date",type:"date",value:a.timeRange.end,onChange:m=>k("timeRange",{...a.timeRange,end:m.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"description",children:"Description"}),e.jsx($e,{id:"description",value:a.description,onChange:m=>k("description",m.target.value),placeholder:"Enter report description",rows:3})]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Report Sections"})}),e.jsx(y,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hs,{checked:a.sections.userMetrics,onCheckedChange:()=>c("userMetrics")}),e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4"}),"User Metrics"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hs,{checked:a.sections.financialMetrics,onCheckedChange:()=>c("financialMetrics")}),e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(ws,{className:"h-4 w-4"}),"Financial Metrics"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hs,{checked:a.sections.systemMetrics,onCheckedChange:()=>c("systemMetrics")}),e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"h-4 w-4"}),"System Metrics"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hs,{checked:a.sections.aiMetrics,onCheckedChange:()=>c("aiMetrics")}),e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(es,{className:"h-4 w-4"}),"AI Metrics"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hs,{checked:a.sections.securityMetrics,onCheckedChange:()=>c("securityMetrics")}),e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4"}),"Security Metrics"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(hs,{checked:a.sections.activityLogs,onCheckedChange:()=>c("activityLogs")}),e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4"}),"Activity Logs"]})]})]})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Export Options"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx(C,{children:"Output Format"}),e.jsxs(Z,{value:a.format,onValueChange:m=>k("format",m),children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"pdf",children:"PDF"}),e.jsx(E,{value:"excel",children:"Excel"}),e.jsx(E,{value:"csv",children:"CSV"}),e.jsx(E,{value:"html",children:"HTML"})]})]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(C,{children:"Include Charts and Graphs"}),e.jsx(G,{checked:a.includeCharts,onCheckedChange:m=>k("includeCharts",m)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(C,{children:"Include Raw Data"}),e.jsx(G,{checked:a.includeRawData,onCheckedChange:m=>k("includeRawData",m)})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"email-recipients",children:"Email Recipients (comma-separated)"}),e.jsx($e,{id:"email-recipients",value:n,onChange:m=>d(m.target.value),onBlur:R,placeholder:"admin@example.com, manager@example.com",rows:2})]})]})]})]}),e.jsx("div",{children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Report Preview"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:a.title||"Untitled Report"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.description})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Type"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[S(a.type),e.jsx("span",{className:"text-sm capitalize",children:a.type})]})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Time Range"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.timeRange.start," to ",a.timeRange.end]})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Sections"}),e.jsx("div",{className:"space-y-1 mt-1",children:Object.entries(a.sections).filter(([,m])=>m).map(([m])=>e.jsx(P,{variant:"secondary",className:"mr-1",children:m.replace(/([A-Z])/g," $1").toLowerCase()},m))})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Format"}),e.jsx("p",{className:"text-sm text-muted-foreground uppercase",children:a.format})]}),a.emailRecipients.length>0&&e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-medium",children:"Recipients"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.emailRecipients.length," recipient(s)"]})]}),e.jsx(v,{onClick:D,disabled:j.isPending,className:"w-full",children:j.isPending?e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ze,{className:"h-4 w-4 mr-2"}),"Generate Report"]})})]})]})})]})}),e.jsx($,{value:"templates",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Create Template"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"template-name",children:"Template Name"}),e.jsx(I,{id:"template-name",value:i.name,onChange:m=>l({...i,name:m.target.value}),placeholder:"Weekly System Report"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"template-description",children:"Description"}),e.jsx($e,{id:"template-description",value:i.description,onChange:m=>l({...i,description:m.target.value}),placeholder:"Comprehensive weekly system performance report",rows:3})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Template Type"}),e.jsxs(Z,{value:i.type,onValueChange:m=>l({...i,type:m}),children:[e.jsx(ee,{children:e.jsx(re,{})}),e.jsxs(se,{children:[e.jsx(E,{value:"system",children:"System"}),e.jsx(E,{value:"analytics",children:"Analytics"}),e.jsx(E,{value:"financial",children:"Financial"}),e.jsx(E,{value:"security",children:"Security"}),e.jsx(E,{value:"user",children:"User"}),e.jsx(E,{value:"ai",children:"AI"}),e.jsx(E,{value:"custom",children:"Custom"})]})]})]}),e.jsxs(v,{onClick:()=>f.mutate(i),disabled:f.isPending,children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Create Template"]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Existing Templates"})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-3",children:p?.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[S(m.type),e.jsx("h3",{className:"font-medium",children:m.name}),e.jsx(P,{variant:"outline",children:m.type})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:m.description}),m.lastGenerated&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Last generated: ",new Date(m.lastGenerated).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{variant:"outline",size:"sm",children:e.jsx(ht,{className:"h-4 w-4"})}),e.jsx(v,{variant:"outline",size:"sm",children:e.jsx(Et,{className:"h-4 w-4"})}),e.jsx(v,{variant:"destructive",size:"sm",children:e.jsx(Ws,{className:"h-4 w-4"})})]})]},m.id))})})]})]})}),e.jsx($,{value:"generated",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{children:"Generated Reports"}),e.jsxs(v,{onClick:()=>h(),variant:"outline",size:"sm",children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-3",children:[o?.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-medium",children:m.name}),e.jsx(P,{className:q(m.status),children:m.status}),e.jsx(P,{variant:"outline",children:m.type})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(Ve,{className:"h-3 w-3 mr-1"}),new Date(m.generatedAt).toLocaleString()]}),e.jsxs("span",{children:["By ",m.generatedBy]}),m.status==="completed"&&e.jsx("span",{children:T(m.fileSize)})]}),m.status==="pending"&&m.progress!==void 0&&e.jsxs("div",{className:"mt-2",children:[e.jsx(we,{value:m.progress,className:"h-2"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[m.progress,"% complete"]})]}),m.status==="failed"&&m.error&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:m.error})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[m.status==="completed"&&e.jsxs(v,{variant:"outline",size:"sm",children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Download"]}),e.jsx(v,{variant:"outline",size:"sm",children:e.jsx(Os,{className:"h-4 w-4"})}),e.jsx(v,{variant:"destructive",size:"sm",children:e.jsx(Ws,{className:"h-4 w-4"})})]})]},m.id)),(!o||o.length===0)&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Zs,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No reports have been generated yet."})]})]})})]})}),e.jsx($,{value:"schedule",className:"space-y-6",children:e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Scheduled Reports"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-3",children:[p?.filter(m=>m.schedule?.enabled).map(m=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[S(m.type),e.jsx("h3",{className:"font-medium",children:m.name}),e.jsx(P,{variant:"outline",children:m.schedule?.frequency})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Runs ",m.schedule?.frequency," at ",m.schedule?.time]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Recipients: ",m.schedule?.recipients.join(", ")]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{defaultChecked:!0}),e.jsx(v,{variant:"outline",size:"sm",children:"Edit"})]})]},m.id)),!p?.some(m=>m.schedule?.enabled)&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ze,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No scheduled reports configured."})]})]})})]})})]})]})}function Ic(){const{user:s}=Le(),[t,a]=gt(),{toast:r}=ve(),[i,l]=x.useState("dashboard"),[n,d]=x.useState(""),[u,p]=x.useState(""),[o,h]=x.useState(""),[j,f]=x.useState(null),[k,c]=x.useState({}),[R,D]=x.useState(!1),[S,q]=x.useState(null),[T,m]=x.useState(!1),[N,F]=x.useState({}),[A,_]=x.useState(!1);x.useEffect(()=>{(!s||s.role!=="admin")&&(r({title:"Access Denied",description:"Admin access required.",variant:"destructive"}),a("/login"))},[s,a,r]);const{data:Q=[],refetch:ie,isLoading:ge}=W({queryKey:["/api/admin/users"]}),{data:ne=[],refetch:z,isLoading:M}=W({queryKey:["/api/admin/data/meal-analyses"]}),{data:xe=[],refetch:Ke,isLoading:O}=W({queryKey:["/api/admin/data/weekly-stats"]}),{data:X=[],refetch:Ae,isLoading:le}=W({queryKey:["/api/admin/config"]});J({mutationFn:async B=>{const ue=await fetch(`/api/admin/users/${B.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)});if(!ue.ok)throw new Error("Failed to update user");return ue.json()},onSuccess:()=>{r({title:"User updated"}),f(null),ie()},onError:B=>{r({title:"Error updating user",description:B.message,variant:"destructive"})}}),J({mutationFn:async B=>{const ue=await fetch(`/api/admin/users/${B}`,{method:"DELETE"});if(!ue.ok)throw new Error("Failed to delete user");return ue.json()},onSuccess:()=>{r({title:"User deleted"}),D(!1),ie()},onError:B=>{r({title:"Error deleting user",description:B.message,variant:"destructive"})}});const ss=J({mutationFn:async B=>{const ue=await fetch("/api/admin/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)});if(!ue.ok){const Qs=await ue.json().catch(()=>({message:"Failed to create config"}));throw new Error(Qs.message||"Failed to create config")}return ue.json()},onSuccess:()=>{r({title:"App config created"}),m(!1),Ae()},onError:B=>{r({title:"Error creating config",description:B.message,variant:"destructive"})}}),ia=J({mutationFn:async B=>{const ue=await fetch(`/api/admin/config/${B.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)});if(!ue.ok){const Qs=await ue.json().catch(()=>({message:"Failed to update config"}));throw new Error(Qs.message||"Failed to update config")}return ue.json()},onSuccess:()=>{r({title:"App config updated"}),m(!1),Ae()},onError:B=>{r({title:"Error updating config",description:B.message,variant:"destructive"})}}),na=J({mutationFn:async B=>{const ue=await fetch(`/api/admin/config/${B}`,{method:"DELETE"});if(!ue.ok){const Qs=await ue.json().catch(()=>({message:"Failed to delete config"}));throw new Error(Qs.message||"Failed to delete config")}return ue.json()},onSuccess:()=>{r({title:"App config deleted"}),Ae()},onError:B=>{r({title:"Error deleting config",description:B.message,variant:"destructive"})}});Q.filter(B=>(B.username||"").toLowerCase().includes(n.toLowerCase())||(B.email||"").toLowerCase().includes(n.toLowerCase())||(B.role||"").toLowerCase().includes(n.toLowerCase()));const Er=ne.filter(B=>(B.foodName||"").toLowerCase().includes(u.toLowerCase())||String(B.userId).includes(u)),Tr=xe.filter(B=>String(B.userId).includes(o)),Ar=()=>{A&&N.id?ia.mutate(N):ss.mutate(N)},Rr=B=>{F(B),_(!0),m(!0)},Pr=()=>{F({key:"",value:"",description:"",type:"string"}),_(!1),m(!0)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-neutral-900 to-neutral-800 p-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsxs(g,{className:"card-gradient glass-effect shadow-xl",children:[e.jsx(b,{children:e.jsx(w,{className:"text-2xl text-primary-200",children:"Admin Panel"})}),e.jsx(y,{children:e.jsxs(Te,{value:i,onValueChange:l,className:"w-full",children:[e.jsxs(Se,{className:"mb-6 flex flex-wrap justify-start w-full overflow-auto",children:[e.jsx(U,{value:"dashboard",children:"Dashboard"}),e.jsx(U,{value:"users",children:"Users"}),e.jsx(U,{value:"analytics",children:"Analytics"}),e.jsx(U,{value:"payments",children:"Payments"}),e.jsx(U,{value:"system",children:"System"}),e.jsx(U,{value:"meals",children:"Meals"}),e.jsx(U,{value:"stats",children:"Stats"}),e.jsx(U,{value:"content",children:"Content"}),e.jsx(U,{value:"config",children:"Config"}),e.jsx(U,{value:"ai-config",children:"AI Config"}),e.jsx(U,{value:"settings",children:"Settings"}),e.jsx(U,{value:"backup",children:"Backup"}),e.jsx(U,{value:"security",children:"Security"}),e.jsx(U,{value:"notifications",children:"Notifications"}),e.jsx(U,{value:"activity",children:"Activity"}),e.jsx(U,{value:"reports",children:"Reports"})]}),e.jsx($,{value:"dashboard",children:e.jsx(Ac,{})}),e.jsx($,{value:"users",children:e.jsx(vc,{})}),e.jsx($,{value:"analytics",children:e.jsx(wc,{})}),e.jsx($,{value:"payments",children:e.jsx(kc,{})}),e.jsx($,{value:"system",children:e.jsx(Nc,{})}),e.jsxs($,{value:"meals",children:[e.jsx("div",{className:"flex items-center mb-4 gap-4",children:e.jsx(I,{placeholder:"Search meals or user ID...",value:u,onChange:B=>p(B.target.value),className:"w-64"})}),M&&e.jsx("div",{className:"text-primary-100",children:"Loading meals..."}),!M&&e.jsxs(fs,{children:[e.jsx(te,{children:e.jsxs(Fe,{children:[e.jsx(H,{children:"ID"}),e.jsx(H,{children:"User ID"}),e.jsx(H,{children:"Food"}),e.jsx(H,{children:"Calories"}),e.jsx(H,{children:"Protein"}),e.jsx(H,{children:"Carbs"}),e.jsx(H,{children:"Fat"})]})}),e.jsx(gs,{children:Er.map(B=>e.jsxs(Fe,{children:[e.jsx(H,{children:B.id}),e.jsx(H,{children:B.userId}),e.jsx(H,{children:B.foodName}),e.jsx(H,{children:B.estimatedCalories}),e.jsx(H,{children:B.estimatedProtein}),e.jsx(H,{children:B.estimatedCarbs}),e.jsx(H,{children:B.estimatedFat})]},B.id))})]})]}),e.jsxs($,{value:"stats",children:[e.jsx("div",{className:"flex items-center mb-4 gap-4",children:e.jsx(I,{placeholder:"Search by user ID...",value:o,onChange:B=>h(B.target.value),className:"w-64"})}),O&&e.jsx("div",{className:"text-primary-100",children:"Loading stats..."}),!O&&e.jsxs(fs,{children:[e.jsx(te,{children:e.jsxs(Fe,{children:[e.jsx(H,{children:"ID"}),e.jsx(H,{children:"User ID"}),e.jsx(H,{children:"Avg Calories"}),e.jsx(H,{children:"Meals Tracked"}),e.jsx(H,{children:"Protein"}),e.jsx(H,{children:"Healthiest Day"})]})}),e.jsx(gs,{children:Tr.map(B=>e.jsxs(Fe,{children:[e.jsx(H,{children:B.id}),e.jsx(H,{children:B.userId}),e.jsx(H,{children:B.averageCalories}),e.jsx(H,{children:B.mealsTracked}),e.jsx(H,{children:B.averageProtein}),e.jsx(H,{children:B.healthiestDay})]},B.id))})]})]}),e.jsxs($,{value:"content",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-primary-100",children:"Edit Site Content"}),e.jsx(Fc,{})]}),e.jsxs($,{value:"config",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-primary-100",children:"Application Configuration"}),e.jsx(v,{variant:"accent",onClick:Pr,children:"Add New Config"})]}),le&&e.jsx("p",{children:"Loading configurations..."}),!le&&X.length===0&&e.jsx("p",{children:"No configurations found."}),!le&&X.length>0&&e.jsxs(fs,{children:[e.jsx(te,{children:e.jsxs(Fe,{children:[e.jsx(H,{children:"ID"}),e.jsx(H,{children:"Key"}),e.jsx(H,{children:"Value"}),e.jsx(H,{children:"Type"}),e.jsx(H,{children:"Description"}),e.jsx(H,{children:"Actions"})]})}),e.jsx(gs,{children:X.map(B=>e.jsxs(Fe,{children:[e.jsx(H,{children:B.id}),e.jsx(H,{children:B.key}),e.jsx(H,{className:"max-w-xs truncate",children:String(B.value)}),e.jsx(H,{children:B.type}),e.jsx(H,{className:"max-w-xs truncate",children:B.description}),e.jsxs(H,{className:"flex gap-2",children:[e.jsx(v,{size:"sm",variant:"outline",onClick:()=>Rr(B),children:"Edit"}),e.jsx(v,{size:"sm",variant:"destructive",onClick:()=>na.mutate(B.id),disabled:na.isPending,children:"Delete"})]})]},B.id))})]}),e.jsx(Bs,{open:T,onOpenChange:B=>{B||m(!1)},children:e.jsxs(Ds,{children:[e.jsx(Ms,{children:e.jsxs(Ls,{children:[A?"Edit":"Add"," App Configuration"]})}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-100 mb-1",children:"Key"}),e.jsx(I,{value:N.key||"",onChange:B=>F(ue=>({...ue,key:B.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-100 mb-1",children:"Value"}),e.jsx(I,{value:N.value||"",onChange:B=>F(ue=>({...ue,value:B.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-100 mb-1",children:"Type (string, boolean, number, json)"}),e.jsx(I,{value:N.type||"string",onChange:B=>F(ue=>({...ue,type:B.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-100 mb-1",children:"Description"}),e.jsx(I,{value:N.description||"",onChange:B=>F(ue=>({...ue,description:B.target.value}))})]})]}),e.jsxs(yt,{children:[e.jsx(v,{variant:"secondary",onClick:()=>m(!1),children:"Cancel"}),e.jsx(v,{variant:"accent",onClick:Ar,disabled:ss.isPending||ia.isPending,children:A?"Save Changes":"Create Config"})]})]})})]}),e.jsx($,{value:"ai-config",children:e.jsx(pc,{})}),e.jsx($,{value:"settings",children:e.jsx(Sc,{})}),e.jsx($,{value:"backup",children:e.jsx(Cc,{})}),e.jsx($,{value:"security",children:e.jsx(Ec,{})}),e.jsx($,{value:"notifications",children:e.jsx(Tc,{})}),e.jsx($,{value:"activity",children:e.jsx(Rc,{})}),e.jsx($,{value:"reports",children:e.jsx(Pc,{})})]})})]})})})}function Fc(){const{toast:s}=ve(),[t,a]=x.useState([{key:"home",value:"",label:"Home Page Main Text"},{key:"try-it",value:"",label:"Try It Page Main Text"},{key:"pricing",value:"",label:"Pricing Page Main Text"}]),[r,i]=x.useState(!0),[l,n]=x.useState(null);x.useEffect(()=>{i(!0),Promise.all(t.map(p=>fetch(`/api/admin/content/${p.key}`).then(o=>o.json()).then(o=>({key:p.key,value:o.value||""})))).then(p=>{a(o=>o.map(h=>{const j=p.find(f=>f.key===h.key);return j?{...h,value:j.value}:h})),i(!1)}).catch(p=>{console.error("Content loading error:",p),n("Failed to load content. Check console for details."),i(!1)})},[]);const d=async(p,o,h,j)=>{try{if(!(await fetch(`/api/admin/content/${p}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:o})})).ok)throw new Error("Failed to update");s({title:`${h} content updated`})}catch(f){console.error(`Failed to update ${h} content:`,f),f instanceof Error&&f.message,s({title:`Failed to update ${h} content`,variant:"destructive"})}};if(r)return e.jsx("div",{className:"text-primary-100",children:"Loading content..."});if(l)return e.jsx("div",{className:"text-red-500",children:l});const u=(p,o)=>{a(h=>h.map((j,f)=>f===p?{...j,value:o}:j))};return e.jsx("div",{className:"space-y-8",children:t.map((p,o)=>e.jsxs("div",{className:"bg-neutral-900/80 rounded-lg p-6 shadow",children:[e.jsx("h3",{className:"text-lg font-bold text-primary-200 mb-2",children:p.label}),e.jsx("textarea",{className:"w-full min-h-[80px] rounded p-2 bg-neutral-800 text-primary-100 border border-neutral-700",value:p.value,onChange:h=>u(o,h.target.value)}),e.jsx(v,{className:"mt-2",variant:"accent",onClick:()=>d(p.key,p.value,p.label),children:"Save"})]},p.key))})}function Dc({userId:s}){const[t,a]=x.useState([{role:"assistant",content:"Hi! I'm your Nutrition Coach. Ask me anything about your meals, nutrition, or healthy eating!"}]),[r,i]=x.useState(""),[l,n]=x.useState(!1),[d,u]=x.useState(null),[p,o]=x.useState(""),h=x.useRef(null),j=x.useRef(null),f=c=>{const R=c.target.files?.[0];if(R){u(R);const D=new FileReader;D.onload=S=>{const q=S.target?.result;o(q.split(",")[1])},D.readAsDataURL(R)}},k=async()=>{if(!r.trim()&&!p)return;const c=r||"What's in this image?";a(R=>[...R,{role:"user",content:c,imageData:p?`data:image/jpeg;base64,${p}`:void 0}]),n(!0),i(""),u(null),o("");try{const R={question:c};p&&(R.imageData=p);const D=await ke("POST","/api/user/nutrition-coach/ask",R);if(!D.ok)throw new Error("Failed to get response");const S=await D.json();a(q=>[...q,{role:"assistant",content:S.reply}])}catch{a(D=>[...D,{role:"assistant",content:"Sorry, I couldn't process your request."}])}finally{n(!1),h.current?.focus()}};return e.jsxs(g,{className:"card-gradient glass-effect rounded-xl border border-neutral-800 max-w-xl mx-auto",children:[e.jsx(b,{children:e.jsx(w,{children:"Nutrition Coach Chatbot"})}),e.jsxs(y,{children:[e.jsxs("div",{className:"flex flex-col gap-3 h-72 overflow-y-auto bg-neutral-900/60 rounded p-3 mb-3",children:[t.map((c,R)=>e.jsx("div",{className:`text-sm ${c.role==="user"?"text-right":"text-left"}`,children:e.jsxs("div",{className:`inline-block px-3 py-2 rounded-lg max-w-xs ${c.role==="user"?"bg-primary-700 text-primary-50":"bg-emerald-800 text-emerald-100"}`,children:[c.imageData&&e.jsx("img",{src:c.imageData,alt:"Uploaded",className:"w-32 h-32 object-cover rounded mb-2"}),c.content]})},R)),l&&e.jsx("div",{className:"text-xs text-emerald-400",children:"Coach is typing..."})]}),d&&e.jsxs("div",{className:"mb-2",children:[e.jsx("img",{src:URL.createObjectURL(d),alt:"Preview",className:"w-20 h-20 object-cover rounded"}),e.jsx("button",{onClick:()=>{u(null),o(""),j.current&&(j.current.value="")},className:"ml-2 text-red-400 hover:text-red-300 text-sm",children:"Remove"})]}),e.jsxs("form",{className:"flex gap-2",onSubmit:c=>{c.preventDefault(),k()},children:[e.jsx("input",{ref:h,className:"flex-1 rounded px-3 py-2 bg-neutral-800 text-neutral-100 border border-neutral-700 focus:outline-none",placeholder:"Ask me about your meals, e.g. 'Was my breakfast healthy?'",value:r,onChange:c=>i(c.target.value),disabled:l,autoFocus:!0}),e.jsx("input",{ref:j,type:"file",accept:"image/*",onChange:f,className:"hidden"}),e.jsx("button",{type:"button",onClick:()=>j.current?.click(),className:"bg-blue-700 hover:bg-blue-600 text-blue-50 font-semibold px-3 py-2 rounded shadow",disabled:l,title:"Upload image",children:"📷"}),e.jsx("button",{type:"submit",className:"bg-emerald-700 hover:bg-emerald-600 text-emerald-50 font-semibold px-4 py-2 rounded shadow",disabled:l||!r.trim()&&!p,children:"Send"})]})]})]})}function Mc(){const{user:s}=Le();return s?e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(He,{}),e.jsx("main",{className:"flex-grow",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-neutral-900 mb-2",children:"Nutrition Coach Chatbot"}),e.jsx("p",{className:"text-neutral-500",children:"Chat with your personal nutrition coach for advice on meals, nutrition, and healthy eating."})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Dc,{userId:s?.id})})]})}),e.jsx(qe,{})]}):e.jsx("div",{children:"Loading..."})}function Lc(){const{user:s}=Le(),[t,a]=x.useState("all"),{data:r}=W({queryKey:["/api/user/stats"],queryFn:cs({on401:"returnNull"})}),i=[{id:1,title:"First Steps",description:"Log your first meal",icon:"🥗",progress:1,maxProgress:1,unlocked:!0,unlockedDate:"2024-01-15",category:"getting-started"},{id:2,title:"Week Warrior",description:"Complete 7 days of meal tracking",icon:"📅",progress:7,maxProgress:7,unlocked:!0,unlockedDate:"2024-01-22",category:"consistency"},{id:3,title:"Calorie Master",description:"Maintain calorie goals for 30 days",icon:"🎯",progress:25,maxProgress:30,unlocked:!1,category:"goals"},{id:4,title:"Protein Champion",description:"Average 150g protein per day for a week",icon:"💪",progress:120,maxProgress:150,unlocked:!1,category:"nutrition"},{id:5,title:"Social Butterfly",description:"Share 10 achievements with friends",icon:"🦋",progress:3,maxProgress:10,unlocked:!1,category:"social"}],l=[{id:"all",label:"All",icon:Vs},{id:"getting-started",label:"Getting Started",icon:Ks},{id:"consistency",label:"Consistency",icon:ze},{id:"goals",label:"Goals",icon:Mt},{id:"nutrition",label:"Nutrition",icon:Is},{id:"social",label:"Social",icon:Me}],n=t==="all"?i:i.filter(h=>h.category===t),d=i.filter(h=>h.unlocked).length,u=i.reduce((h,j)=>h+j.progress/j.maxProgress,0),p=Math.round(u/i.length*100),o=h=>{navigator.share?navigator.share({title:`Achievement Unlocked: ${h.title}`,text:`I just unlocked "${h.title}" in AI Calorie Tracker! ${h.description}`,url:window.location.href}):navigator.clipboard.writeText(`I just unlocked "${h.title}" in AI Calorie Tracker! ${h.description} ${window.location.href}`)};return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(He,{}),e.jsx("main",{className:"flex-grow",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Achievements"}),e.jsx("p",{className:"text-muted-foreground",children:"Track your progress and unlock rewards as you work towards your health goals."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Achievements Unlocked"}),e.jsx(Vs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[d,"/",i.length]}),e.jsx(we,{value:d/i.length*100,className:"mt-2"})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Overall Progress"}),e.jsx(ye,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[p,"%"]}),e.jsx(we,{value:p,className:"mt-2"})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Current Streak"}),e.jsx(ze,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[r?(()=>{const h=r.caloriesByDay??{},j=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];let f=0;for(let k=j.length-1;k>=0;k--){const c=h?.[j[k]]??0;if(c>=1500&&c<=2200)f++;else break}return f})():0," days"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Keep it up!"})]})]})]}),e.jsxs(Te,{value:t,onValueChange:a,children:[e.jsx(Se,{className:"grid w-full grid-cols-3 lg:grid-cols-6 mb-6",children:l.map(h=>e.jsxs(U,{value:h.id,className:"flex items-center gap-2",children:[e.jsx(h.icon,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:h.label})]},h.id))}),e.jsx($,{value:t,className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(h=>e.jsxs(g,{className:`relative ${h.unlocked?"border-green-200 bg-green-50":""}`,children:[h.unlocked&&e.jsx("div",{className:"absolute -top-2 -right-2",children:e.jsx(P,{className:"bg-green-500",children:"Unlocked"})}),e.jsx(b,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-3xl",children:h.icon}),e.jsxs("div",{children:[e.jsx(w,{className:"text-lg",children:h.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:h.description})]})]})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[h.progress,"/",h.maxProgress]})]}),e.jsx(we,{value:h.progress/h.maxProgress*100})]}),h.unlocked&&h.unlockedDate&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Unlocked on ",new Date(h.unlockedDate).toLocaleDateString()]}),h.unlocked&&e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>o(h),className:"w-full",children:[e.jsx(Wt,{className:"h-4 w-4 mr-2"}),"Share Achievement"]})]})})]},h.id))})})]}),e.jsxs(g,{className:"mt-8",children:[e.jsx(b,{children:e.jsx(w,{children:"Achievement History"})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-4",children:i.filter(h=>h.unlocked).sort((h,j)=>new Date(j.unlockedDate).getTime()-new Date(h.unlockedDate).getTime()).map(h=>e.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg",children:[e.jsx("div",{className:"text-2xl",children:h.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium",children:h.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:h.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium",children:new Date(h.unlockedDate).toLocaleDateString()}),e.jsx(P,{variant:"secondary",className:"mt-1",children:"Unlocked"})]})]},h.id))})})]})]})}),e.jsx(qe,{})]})}function Oc(){const[s,t]=x.useState(""),[a,r]=x.useState("all"),[i,l]=x.useState(new Set([1,3,5])),[n,d]=x.useState(new Set([1,2])),{data:u,isLoading:p,error:o}=W({queryKey:["/api/nutrition-tips"],queryFn:cs({on401:"returnNull"})}),h=[{id:1,title:"Understanding Macronutrients",content:"Macronutrients are the nutrients we need in large amounts: carbohydrates, proteins, and fats. Each plays a crucial role in our body's functions and energy production.",category:"basics",difficulty:"beginner",readTime:5,tags:["macronutrients","basics","nutrition"],bookmarked:!0,completed:!0},{id:2,title:"Protein: The Building Block of Life",content:"Protein is essential for muscle repair, immune function, and hormone production. Learn how to calculate your daily protein needs and identify high-quality protein sources.",category:"protein",difficulty:"beginner",readTime:8,tags:["protein","muscle","health"],completed:!0},{id:3,title:"Carbohydrates: Energy for Performance",content:"Carbs are your body's primary energy source. Discover the difference between simple and complex carbohydrates and how to optimize your carb intake for sustained energy.",category:"carbs",difficulty:"intermediate",readTime:10,tags:["carbohydrates","energy","performance"],bookmarked:!0},{id:4,title:"Healthy Fats: Essential for Health",content:"Not all fats are created equal. Learn about omega-3s, omega-6s, and how to incorporate healthy fats into your diet while avoiding trans fats.",category:"fats",difficulty:"intermediate",readTime:7,tags:["fats","omega-3","health"]},{id:5,title:"Micronutrients: Vitamins and Minerals",content:"While needed in smaller amounts, vitamins and minerals are crucial for optimal health. Understand the role of antioxidants, electrolytes, and essential minerals.",category:"micronutrients",difficulty:"advanced",readTime:12,tags:["vitamins","minerals","antioxidants"],bookmarked:!0},{id:6,title:"Hydration: More Than Just Water",content:"Proper hydration affects everything from cognitive function to physical performance. Learn about electrolyte balance and how to stay optimally hydrated.",category:"hydration",difficulty:"beginner",readTime:6,tags:["hydration","electrolytes","performance"]},{id:7,title:"Meal Timing and Frequency",content:"When you eat can be as important as what you eat. Explore intermittent fasting, meal frequency, and timing strategies for optimal health.",category:"meal-timing",difficulty:"advanced",readTime:15,tags:["meal-timing","intermittent-fasting","metabolism"]},{id:8,title:"Reading Nutrition Labels",content:"Navigate food labels like a pro. Learn to identify hidden sugars, understand serving sizes, and make informed decisions at the grocery store.",category:"label-reading",difficulty:"beginner",readTime:9,tags:["labels","shopping","education"]}],j=[{id:"all",label:"All Topics",icon:tt},{id:"basics",label:"Nutrition Basics",icon:Xt},{id:"protein",label:"Protein",icon:$i},{id:"carbs",label:"Carbohydrates",icon:$a},{id:"fats",label:"Healthy Fats",icon:da},{id:"micronutrients",label:"Vitamins & Minerals",icon:Ks},{id:"hydration",label:"Hydration",icon:da},{id:"meal-timing",label:"Meal Timing",icon:Ve},{id:"label-reading",label:"Label Reading",icon:mt}],f=x.useMemo(()=>h.filter(T=>{const m=T.title.toLowerCase().includes(s.toLowerCase())||T.content.toLowerCase().includes(s.toLowerCase())||T.tags.some(F=>F.toLowerCase().includes(s.toLowerCase())),N=a==="all"||T.category===a;return m&&N}),[s,a]),k=T=>{l(m=>{const N=new Set(m);return N.has(T)?N.delete(T):N.add(T),N})},c=T=>{d(m=>new Set([...Array.from(m),T]))},R=n.size,D=h.length,S=Math.round(R/D*100),q=T=>{switch(T){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(He,{}),e.jsx("main",{className:"flex-grow",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Nutrition Education"}),e.jsx("p",{className:"text-muted-foreground",children:"Expand your knowledge with comprehensive nutrition guides, tips, and educational content."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Learning Progress"}),e.jsx(tt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[R,"/",D]}),e.jsx(we,{value:S,className:"mt-2"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[S,"% Complete"]})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Bookmarked"}),e.jsx(oa,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:i.size}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Saved for later"})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"This Week"}),e.jsx(fe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"2"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Articles read"})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(mt,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(I,{placeholder:"Search nutrition topics...",value:s,onChange:T=>t(T.target.value),className:"pl-10"})]})}),e.jsx(Te,{value:a,onValueChange:r,children:e.jsx(Se,{className:"grid w-full grid-cols-3 lg:grid-cols-5 xl:grid-cols-9",children:j.map(T=>e.jsxs(U,{value:T.id,className:"flex items-center gap-2 text-xs",children:[e.jsx(T.icon,{className:"h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:T.label})]},T.id))})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(T=>e.jsxs(g,{className:"relative hover:shadow-lg transition-shadow",children:[i.has(T.id)&&e.jsx("div",{className:"absolute -top-2 -right-2",children:e.jsx(zi,{className:"h-6 w-6 text-yellow-500 fill-current"})}),e.jsx(b,{children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx(w,{className:"text-lg mb-2",children:T.title}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(P,{className:q(T.difficulty),children:T.difficulty}),e.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(Ve,{className:"h-3 w-3"}),T.readTime," min"]})]})]})})}),e.jsxs(y,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4 line-clamp-3",children:T.content}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:T.tags.slice(0,3).map(m=>e.jsx(P,{variant:"secondary",className:"text-xs",children:m},m))}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>k(T.id),className:i.has(T.id)?"text-yellow-600":"",children:[e.jsx(oa,{className:"h-4 w-4 mr-1"}),i.has(T.id)?"Saved":"Save"]}),n.has(T.id)?e.jsxs(P,{className:"bg-green-100 text-green-800",children:[e.jsx(fe,{className:"h-3 w-3 mr-1"}),"Completed"]}):e.jsx(v,{variant:"outline",size:"sm",onClick:()=>c(T.id),children:"Mark Complete"})]})]})]},T.id))}),f.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(tt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No results found"}),e.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search terms or browse all topics."})]}),u?.tips&&e.jsxs(g,{className:"mt-8",children:[e.jsx(b,{children:e.jsx(w,{children:"Daily Nutrition Tips"})}),e.jsx(y,{children:e.jsx("ul",{className:"space-y-2",children:u.tips.map((T,m)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(fe,{className:"h-5 w-5 text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:T})]},m))})})]})]})}),e.jsx(qe,{})]})}const kr=x.forwardRef(({className:s,...t},a)=>e.jsx(Ga,{ref:a,className:L("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...t}));kr.displayName=Ga.displayName;const Uc=x.forwardRef(({className:s,...t},a)=>e.jsx(Ya,{ref:a,className:L("aspect-square h-full w-full",s),...t}));Uc.displayName=Ya.displayName;const Sr=x.forwardRef(({className:s,...t},a)=>e.jsx(Ja,{ref:a,className:L("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...t}));Sr.displayName=Ja.displayName;function $c(){const{user:s}=Le(),[t,a]=x.useState("overview"),{data:r,isLoading:i,refetch:l}=W({queryKey:["/api/user/referrals/commissions"],queryFn:cs({on401:"returnNull"})}),n={totalMeals:1247,totalCalories:89250,streakDays:23,achievements:15,joinDate:"2024-01-15"},d=r?.reduce((o,h)=>o+(h.status==="paid"?h.amount:0),0)||0,u=r?.reduce((o,h)=>o+(h.status==="pending"?h.amount:0),0)||0,p=[{name:"Free",price:"$0",features:["Basic meal tracking","Weekly reports","Community support"],current:!0},{name:"Premium",price:"$9.99/month",features:["AI meal suggestions","Advanced analytics","Priority support","Export data"],popular:!0},{name:"Pro",price:"$19.99/month",features:["All Premium features","Personal coach","Custom meal plans","API access"],popular:!1}];return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(He,{}),e.jsx("main",{className:"flex-grow",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Profile & Account"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your account settings, view your progress, and handle subscriptions."})]}),e.jsxs(Te,{value:t,onValueChange:a,children:[e.jsxs(Se,{className:"grid w-full grid-cols-4",children:[e.jsx(U,{value:"overview",children:"Overview"}),e.jsx(U,{value:"referrals",children:"Referrals"}),e.jsx(U,{value:"settings",children:"Settings"}),e.jsx(U,{value:"subscription",children:"Subscription"})]}),e.jsxs($,{value:"overview",className:"space-y-6",children:[e.jsx(g,{children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx(kr,{className:"h-20 w-20",children:e.jsx(Sr,{className:"text-lg",children:s?.firstName?.charAt(0)?.toUpperCase()||s?.username?.charAt(0)?.toUpperCase()||"U"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-bold",children:s?.firstName&&s?.lastName?`${s.firstName} ${s.lastName}`:s?.username||"User"}),e.jsx("p",{className:"text-muted-foreground",children:s?.email}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs(P,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(ze,{className:"h-3 w-3"}),"Joined ",new Date(n.joinDate).toLocaleDateString()]}),e.jsxs(P,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(qs,{className:"h-3 w-3"}),"Free Plan"]})]})]}),e.jsxs(v,{variant:"outline",children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Total Meals"}),e.jsx(Is,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.totalMeals.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Meals logged"})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Calories Tracked"}),e.jsx(ye,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.totalCalories.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total calories"})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Current Streak"}),e.jsx(ze,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.streakDays}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Days in a row"})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Achievements"}),e.jsx(Is,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.achievements}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Unlocked"})]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Recent Activity"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"Completed daily calorie goal"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"2 hours ago"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:'Unlocked "Protein Master" achievement'}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"1 day ago"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:"Generated new meal plan"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"3 days ago"})]})]})]})})]})]}),e.jsxs($,{value:"referrals",className:"space-y-6",children:[e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Referral Commissions"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>l(),className:"p-1 hover:bg-accent rounded",children:e.jsx(De,{className:"h-4 w-4"})}),e.jsx(ws,{className:"h-4 w-4 text-muted-foreground"})]})]}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Total Earned"}),e.jsxs("span",{className:"font-medium",children:["$",d.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Pending Commissions"}),e.jsxs("span",{className:"font-medium",children:["$",u.toFixed(2)]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Recent Commissions"}),e.jsxs("div",{className:"space-y-2",children:[r?.slice(0,5).map(o=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{children:["$",o.amount.toFixed(2)]}),o.is_recurring&&e.jsx(P,{variant:"secondary",className:"ml-2",children:"Recurring"})]}),e.jsx(P,{variant:o.status==="paid"?"default":o.status==="pending"?"secondary":"destructive",children:o.status})]},o.id)),r?.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"No commissions yet"})]})]})]})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Referral Link"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Share your referral link to earn commissions when friends sign up and subscribe."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{value:`${window.location.origin}/?ref=${s?.id||"user123"}`,readOnly:!0,className:"flex-1"}),e.jsx(v,{variant:"outline",onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/?ref=${s?.id||"user123"}`)},children:"Copy"})]})]})})]})]}),e.jsxs($,{value:"settings",className:"space-y-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Personal Information"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"name",children:"Full Name"}),e.jsx(I,{id:"name",defaultValue:s?.firstName&&s?.lastName?`${s.firstName} ${s.lastName}`:s?.username||""})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"email",children:"Email"}),e.jsx(I,{id:"email",type:"email",defaultValue:s?.email||""})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"phone",children:"Phone"}),e.jsx(I,{id:"phone",type:"tel",placeholder:"+1 (555) 123-4567"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"location",children:"Location"}),e.jsx(I,{id:"location",placeholder:"City, Country"})]})]}),e.jsx(v,{children:"Save Changes"})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Preferences"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive updates about your progress"})]}),e.jsx(G,{defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Weekly Reports"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Get weekly summary emails"})]}),e.jsx(G,{defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Achievement Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Celebrate your milestones"})]}),e.jsx(G,{defaultChecked:!0})]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Privacy & Security"})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs(v,{variant:"outline",className:"w-full justify-start",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Change Password"]}),e.jsxs(v,{variant:"outline",className:"w-full justify-start",children:[e.jsx(bs,{className:"h-4 w-4 mr-2"}),"Privacy Settings"]}),e.jsxs(v,{variant:"outline",className:"w-full justify-start text-red-600",children:[e.jsx(Ns,{className:"h-4 w-4 mr-2"}),"Delete Account"]})]})]})]}),e.jsxs($,{value:"subscription",className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:p.map((o,h)=>e.jsxs(g,{className:`relative ${o.popular?"ring-2 ring-blue-600":""}`,children:[o.popular&&e.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2",children:e.jsx(P,{className:"bg-blue-600 text-white px-4 py-1",children:"Most Popular"})}),e.jsxs(b,{className:"text-center",children:[e.jsx(w,{className:"text-xl",children:o.name}),e.jsx("div",{className:"mt-4",children:e.jsx("span",{className:"text-3xl font-bold",children:o.price})})]}),e.jsxs(y,{children:[e.jsx("ul",{className:"space-y-2 mb-6",children:o.features.map((j,f)=>e.jsxs("li",{className:"flex items-center text-sm",children:[e.jsx(Is,{className:"h-4 w-4 text-green-500 mr-2 flex-shrink-0"}),e.jsx("span",{children:j})]},f))}),e.jsx(v,{className:`w-full ${o.current?"bg-gray-100 text-gray-600":o.popular?"bg-blue-600 hover:bg-blue-700":""}`,disabled:o.current,children:o.current?"Current Plan":"Upgrade"})]})]},h))}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Billing History"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Premium Plan - Monthly"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Dec 1, 2024"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium",children:"$9.99"}),e.jsx(P,{className:"bg-green-100 text-green-800",children:"Paid"})]})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Premium Plan - Monthly"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nov 1, 2024"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium",children:"$9.99"}),e.jsx(P,{className:"bg-green-100 text-green-800",children:"Paid"})]})]})]})})]})]})]})]})}),e.jsx(qe,{})]})}const zc=()=>[{date:"2024-01-01",nutrition:85,fitness:78,recovery:82,consistency:75,overall:80},{date:"2024-01-02",nutrition:88,fitness:82,recovery:85,consistency:78,overall:83},{date:"2024-01-03",nutrition:82,fitness:80,recovery:83,consistency:80,overall:81},{date:"2024-01-04",nutrition:90,fitness:85,recovery:88,consistency:82,overall:86},{date:"2024-01-05",nutrition:87,fitness:83,recovery:86,consistency:85,overall:85},{date:"2024-01-06",nutrition:89,fitness:87,recovery:89,consistency:88,overall:88},{date:"2024-01-07",nutrition:92,fitness:90,recovery:91,consistency:90,overall:91}],_c=()=>[{type:"Weight Projection",current:75,predicted:73,confidence:85,trend:"down"},{type:"Goal Achievement",current:65,predicted:78,confidence:92,trend:"up"},{type:"Health Risk",current:20,predicted:15,confidence:78,trend:"down"},{type:"Performance",current:70,predicted:82,confidence:88,trend:"up"}],qc=()=>[{pattern:"Sleep-Nutrition",correlation:.78,strength:"Strong"},{pattern:"Exercise-Nutrition",correlation:.65,strength:"Moderate"},{pattern:"Stress-Eating",correlation:.45,strength:"Weak"},{pattern:"Metabolic Rate",correlation:.82,strength:"Strong"}],Bc=()=>[{metric:"Heart Rate",value:72,target:-40,status:"normal"},{metric:"Blood Pressure",value:"120/80",target:"<120/80",status:"optimal"},{metric:"Sleep Quality",value:85,target:">80",status:"good"},{metric:"Activity Level",value:78,target:">75",status:"good"},{metric:"Stress Level",value:32,target:"<35",status:"good"},{metric:"Hydration",value:68,target:">80",status:"low"}];function Vc(){const[s,t]=x.useState("overview"),[a,r]=x.useState([]),[i,l]=x.useState([]),[n,d]=x.useState([]),[u,p]=x.useState([]),[o,h]=x.useState(!0);x.useEffect(()=>{(async()=>{h(!0),await new Promise(c=>setTimeout(c,1e3)),r(zc()),l(_c()),d(qc()),p(Bc()),h(!1)})()},[]);const j=k=>{switch(k){case"normal":case"good":case"optimal":return"bg-green-100 text-green-800";case"warning":return"bg-yellow-100 text-yellow-800";case"critical":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},f=k=>{switch(k){case"up":return"📈";case"down":return"📉";default:return"➡️"}};return o?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx(De,{className:"h-8 w-8 animate-spin mx-auto mb-2"}),e.jsx("p",{children:"Loading premium analytics..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Premium Analytics"}),e.jsx("p",{className:"text-gray-600",children:"Comprehensive health insights and predictions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{variant:"outline",size:"sm",children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Export"]}),e.jsxs(v,{variant:"outline",size:"sm",children:[e.jsx(Wt,{className:"h-4 w-4 mr-2"}),"Share"]}),e.jsxs(v,{variant:"outline",size:"sm",children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Settings"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Overall Health"}),e.jsx(Is,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"91"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"text-green-600",children:"+5%"})," from last week"]})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Nutrition"}),e.jsx(ta,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"92"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"text-green-600",children:"+3%"})," from last week"]})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Fitness"}),e.jsx(be,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"90"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"text-green-600",children:"+7%"})," from last week"]})]})]}),e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:"Recovery"}),e.jsx(Ft,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"91"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"text-green-600",children:"+2%"})," from last week"]})]})]})]}),e.jsxs(Te,{value:s,onValueChange:t,className:"space-y-4",children:[e.jsxs(Se,{className:"grid w-full grid-cols-5",children:[e.jsx(U,{value:"overview",children:"Overview"}),e.jsx(U,{value:"predictions",children:"Predictions"}),e.jsx(U,{value:"patterns",children:"Patterns"}),e.jsx(U,{value:"monitoring",children:"Monitoring"}),e.jsx(U,{value:"reports",children:"Reports"})]}),e.jsxs($,{value:"overview",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Health Scores Trend"})}),e.jsx(y,{children:e.jsx(Ce,{width:"100%",height:300,children:e.jsxs(is,{data:a,children:[e.jsx(os,{strokeDasharray:"3 3"}),e.jsx(Pe,{dataKey:"date"}),e.jsx(Ie,{domain:[0,100]}),e.jsx(Re,{}),e.jsx(Fs,{}),e.jsx(je,{type:"monotone",dataKey:"overall",stroke:"#4F46E5",strokeWidth:2}),e.jsx(je,{type:"monotone",dataKey:"nutrition",stroke:"#10B981",strokeWidth:2}),e.jsx(je,{type:"monotone",dataKey:"fitness",stroke:"#F59E0B",strokeWidth:2}),e.jsx(je,{type:"monotone",dataKey:"recovery",stroke:"#EF4444",strokeWidth:2}),e.jsx(je,{type:"monotone",dataKey:"consistency",stroke:"#8B5CF6",strokeWidth:2})]})})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Current Score Distribution"})}),e.jsx(y,{children:e.jsx(Ce,{width:"100%",height:300,children:e.jsxs(wt,{data:a.slice(-1)[0],children:[e.jsx(os,{strokeDasharray:"3 3"}),e.jsx(Pe,{dataKey:"date"}),e.jsx(Ie,{domain:[0,100]}),e.jsx(Re,{}),e.jsx(Es,{dataKey:"nutrition",fill:"#10B981"}),e.jsx(Es,{dataKey:"fitness",fill:"#F59E0B"}),e.jsx(Es,{dataKey:"recovery",fill:"#EF4444"}),e.jsx(Es,{dataKey:"consistency",fill:"#8B5CF6"})]})})})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Recent Achievements"})}),e.jsx(y,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Is,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Nutrition Master"}),e.jsx("p",{className:"text-sm text-gray-600",children:"7-day streak"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Mt,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Goal Achiever"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Weight loss target"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx(ye,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Consistency King"}),e.jsx("p",{className:"text-sm text-gray-600",children:"30-day perfect"})]})]})]})})]})]}),e.jsxs($,{value:"predictions",className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:i.map((k,c)=>e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center justify-between",children:[k.type,e.jsxs(P,{variant:k.trend==="up"?"default":"secondary",children:[f(k.trend)," ",k.trend]})]})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Current"}),e.jsx("span",{className:"font-medium",children:k.current})]}),e.jsx(we,{value:k.current,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Predicted"}),e.jsx("span",{className:"font-medium",children:k.predicted})]}),e.jsx(we,{value:k.predicted,className:"h-2"})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Confidence"}),e.jsxs("span",{className:"font-medium",children:[k.confidence,"%"]})]})]})})]},c))}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"AI-Powered Insights"})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Weight Management"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Based on your current trends, you're likely to reach your target weight in 3-4 weeks. Consider maintaining your current exercise routine and slightly increasing protein intake."})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-900 mb-2",children:"Performance Optimization"}),e.jsx("p",{className:"text-sm text-green-700",children:"Your fitness performance is improving steadily. We predict a 15% increase in your workout efficiency over the next month if you continue your current regimen."})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-yellow-900 mb-2",children:"Health Risk Alert"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Your stress levels show a slight upward trend. Consider incorporating meditation or relaxation techniques into your daily routine."})]})]})})]})]}),e.jsxs($,{value:"patterns",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Health Pattern Analysis"})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-4",children:n.map((k,c)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:k.pattern}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Correlation: ",k.correlation]})]}),e.jsx(P,{variant:k.strength==="Strong"?"default":"secondary",children:k.strength})]},c))})})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Pattern Strength Analysis"})}),e.jsx(y,{children:e.jsx(Ce,{width:"100%",height:300,children:e.jsxs(Zi,{data:n,children:[e.jsx(en,{}),e.jsx(sn,{dataKey:"pattern"}),e.jsx(tn,{angle:90,domain:[0,1]}),e.jsx(an,{name:"Correlation",dataKey:"correlation",stroke:"#4F46E5",fill:"#4F46E5",fillOpacity:.6})]})})})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Detailed Pattern Insights"})}),e.jsx(y,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Sleep-Nutrition Correlation"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Strong correlation (0.78) between sleep quality and nutrition consistency. Better sleep leads to better food choices."}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500",style:{width:`${.78*100}%`}})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Exercise-Nutrition Correlation"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Moderate correlation (0.65) between exercise intensity and nutrition quality. More active days show better dietary choices."}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-yellow-500",style:{width:`${.65*100}%`}})})]})]})})]})]}),e.jsxs($,{value:"monitoring",className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map((k,c)=>e.jsxs(g,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium",children:k.metric}),e.jsx("div",{className:`w-2 h-2 rounded-full ${k.status==="optimal"||k.status==="good"?"bg-green-500":k.status==="warning"?"bg-yellow-500":"bg-red-500"}`})]}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:k.value}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Target: ",k.target]}),e.jsx(P,{className:j(k.status),children:k.status})]})]},c))}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Real-time Health Metrics"})}),e.jsx(y,{children:e.jsx(Ce,{width:"100%",height:400,children:e.jsxs(is,{data:u,children:[e.jsx(os,{strokeDasharray:"3 3"}),e.jsx(Pe,{dataKey:"metric"}),e.jsx(Ie,{}),e.jsx(Re,{}),e.jsx(Es,{dataKey:"value",fill:"#4F46E5"})]})})})]})]}),e.jsxs($,{value:"reports",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center justify-between",children:["Weekly Summary",e.jsx(P,{children:"Ready"})]})}),e.jsxs(y,{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Comprehensive weekly overview of your health metrics and progress."}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Pages"}),e.jsx("span",{children:"12"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Charts"}),e.jsx("span",{children:"8"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Generated"}),e.jsx("span",{children:"2 hours ago"})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(v,{size:"sm",className:"flex-1",children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Download"]}),e.jsxs(v,{size:"sm",variant:"outline",children:[e.jsx(Wt,{className:"h-4 w-4 mr-2"}),"Share"]})]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center justify-between",children:["Monthly Progress",e.jsx(P,{children:"Processing"})]})}),e.jsxs(y,{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Detailed monthly progress tracking with trend analysis."}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Pages"}),e.jsx("span",{children:"24"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Charts"}),e.jsx("span",{children:"15"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Estimated"}),e.jsx("span",{children:"5 min"})]})]}),e.jsx(v,{size:"sm",className:"w-full mt-4",disabled:!0,children:"Generating..."})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(w,{className:"flex items-center justify-between",children:["Health Assessment",e.jsx(P,{children:"New"})]})}),e.jsxs(y,{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Professional health assessment for medical consultation."}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Pages"}),e.jsx("span",{children:"18"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Charts"}),e.jsx("span",{children:"12"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Format"}),e.jsx("span",{children:"PDF"})]})]}),e.jsx(v,{size:"sm",className:"w-full mt-4",children:"Generate Report"})]})]})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsx(w,{children:"Report Templates"})}),e.jsx(y,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{name:"Weekly Summary",icon:ze,desc:"7-day overview"},{name:"Monthly Progress",icon:ye,desc:"30-day analysis"},{name:"Quarterly Review",icon:Is,desc:"90-day assessment"},{name:"Annual Journey",icon:Me,desc:"Year in review"}].map((k,c)=>e.jsxs("div",{className:"p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx(k.icon,{className:"h-8 w-8 text-blue-500 mb-2"}),e.jsx("h4",{className:"font-medium",children:k.name}),e.jsx("p",{className:"text-sm text-gray-600",children:k.desc})]},c))})})]})]})]})]})}function Hc(){const[s,t]=x.useState(!1),{data:a}=W({queryKey:["/api/user/stats"],queryFn:cs({on401:"returnNull"})}),r=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],i=[{icon:ye,title:"AI-Powered Insights",description:"Advanced machine learning algorithms provide personalized health predictions and recommendations",benefits:["Weight projections","Goal achievement forecasts","Health risk assessment"]},{icon:Ze,title:"Real-time Monitoring",description:"Live health tracking with instant alerts and continuous data synchronization",benefits:["24/7 health monitoring","Customizable alerts","Multi-device sync"]},{icon:Ee,title:"Healthcare Integration",description:"Secure data sharing with healthcare providers and professional-grade reports",benefits:["HIPAA compliant","Professional reports","Provider collaboration"]},{icon:Me,title:"Expert Analysis",description:"Access to nutritionists and fitness coaches for personalized guidance",benefits:["Expert consultations","Personalized plans","Progress tracking"]}],l=[{name:"Basic",price:"$9.99",period:"month",features:["Basic analytics","Weekly reports","Email support"],popular:!1},{name:"Premium",price:"$19.99",period:"month",features:["All Basic features","AI insights","Real-time monitoring","Healthcare integration","Priority support"],popular:!0},{name:"Professional",price:"$39.99",period:"month",features:["All Premium features","Expert consultations","Custom reports","API access","Dedicated support"],popular:!1}];return e.jsxs("div",{className:"flex flex-col min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",children:[e.jsx(He,{}),e.jsxs("main",{className:"flex-grow",children:[e.jsx("div",{className:"relative overflow-hidden",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-4 rounded-full",children:e.jsx(qs,{className:"h-12 w-12 text-white"})})}),e.jsxs("h1",{className:"text-4xl md:text-6xl font-bold text-gray-900 mb-6",children:["Premium Analytics",e.jsx("span",{className:"block text-blue-600",children:"Unlock Your Health Potential"})]}),e.jsx("p",{className:"text-xl text-gray-600 mb-8 max-w-3xl mx-auto",children:"Transform your health journey with AI-powered insights, real-time monitoring, and professional-grade analytics. Get the personalized guidance you need to achieve your wellness goals."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsxs(v,{size:"lg",className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 text-lg",onClick:()=>t(!0),children:["Start Free Trial",e.jsx(zs,{className:"ml-2 h-5 w-5"})]}),e.jsx(v,{size:"lg",variant:"outline",className:"px-8 py-3 text-lg",onClick:()=>t(!0),children:"View Demo"})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Why Choose Premium Analytics?"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Experience the future of health tracking with our comprehensive premium features"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:i.map((n,d)=>e.jsxs(g,{className:"text-center hover:shadow-lg transition-shadow",children:[e.jsxs(b,{children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(n.icon,{className:"h-12 w-12 text-blue-600"})}),e.jsx(w,{className:"text-xl",children:n.title})]}),e.jsxs(y,{children:[e.jsx("p",{className:"text-gray-600 mb-4",children:n.description}),e.jsx("ul",{className:"text-left space-y-2",children:n.benefits.map((u,p)=>e.jsxs("li",{className:"flex items-center",children:[e.jsx(fe,{className:"h-4 w-4 text-green-500 mr-2"}),e.jsx("span",{className:"text-sm",children:u})]},p))})]})]},d))})]}),e.jsx("div",{className:"bg-white py-16",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"See It in Action"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Experience the power of premium analytics with our interactive demo"})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-8",children:s?e.jsx(Vc,{}):e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4",children:e.jsx(Ks,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Ready to Transform Your Health Journey?"}),e.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto mb-8",children:"Get started with our premium analytics dashboard and unlock powerful insights to help you achieve your health goals faster than ever before."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsx(v,{size:"lg",className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3",onClick:()=>t(!0),children:"View Live Demo"}),e.jsx(v,{size:"lg",variant:"outline",className:"px-8 py-3",onClick:()=>t(!0),children:"Explore Features"})]})]})})})]})}),a&&e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Advanced Analytics Dashboard"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Comprehensive charts and insights from your meal tracking data"})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs(g,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ps,{className:"w-5 h-5 text-primary-500"}),e.jsx("h3",{className:"font-medium text-neutral-900",children:"Calorie Trend"})]}),e.jsx("div",{className:"h-48 bg-gradient-to-br from-neutral-900 to-neutral-800 rounded-lg flex items-end justify-between p-4 shadow-inner",children:r.map(n=>{const d=a?.caloriesByDay?.[n]||0,u=Math.max(...Object.values(a?.caloriesByDay||{})),p=u>0?d/u*100:0,o=new Date().getDay(),j=r.indexOf(n)<=o,f=j?"bg-primary-400 w-full rounded-t-sm":"bg-primary-900 w-full rounded-t-sm";return e.jsxs("div",{className:"w-1/7 flex flex-col items-center",children:[e.jsx("div",{className:f,style:{height:`${p}%`},"aria-label":`Calories for ${n}: ${d}`}),e.jsx("span",{className:`text-xs mt-2 ${j?"text-neutral-100":"text-neutral-500"}`,children:n.substring(0,3)})]},n)})})]}),e.jsxs(g,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ps,{className:"w-5 h-5 text-primary-200"}),e.jsx("h3",{className:"font-medium text-primary-100",children:"Weekly Nutrition Breakdown"})]}),e.jsx("div",{className:"h-64 bg-gradient-to-br from-neutral-900 to-neutral-800 rounded-lg p-4 shadow-inner",children:e.jsx(Lt,{config:{calories:{label:"Calories",color:"#4CAF50"}},children:e.jsx(Ce,{width:"100%",height:"100%",children:e.jsxs(is,{data:r.map(n=>{a.macrosByDay?.[n];const d=a?.caloriesByDay?.[n]||0;return{day:n.substring(0,3),calories:d}}),margin:{top:10,right:20,left:0,bottom:0},children:[e.jsx(Pe,{dataKey:"day",stroke:"#b5e3b6"}),e.jsx(Ie,{stroke:"#b5e3b6"}),e.jsx(Re,{contentStyle:{background:"#23272b",border:"1px solid #333",color:"#fff"}}),e.jsx(Fs,{}),e.jsx(je,{type:"monotone",dataKey:"calories",stroke:"#4CAF50",strokeWidth:2,dot:!1},"calories")]})})})})]}),e.jsxs(g,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Dt,{className:"w-5 h-5 text-amber-200"}),e.jsx("h3",{className:"font-medium text-amber-500",children:"Macro Distribution"})]}),e.jsx("div",{className:"h-56 bg-gradient-to-br from-neutral-900 to-neutral-800 rounded-lg p-4 flex items-center justify-center shadow-inner",children:e.jsx(Ce,{width:"100%",height:"100%",children:e.jsxs(is,{data:r.map(n=>{const d=a.macrosByDay?.[n]||{protein:0,carbs:0,fat:0};return{name:n.substring(0,3),Protein:d.protein,Carbs:d.carbs,Fat:d.fat}}),children:[e.jsx(Pe,{dataKey:"name"}),e.jsx(Ie,{}),e.jsx(Re,{contentStyle:{background:"#23272b",border:"1px solid #333",color:"#fff"}}),e.jsx(Fs,{}),e.jsx(je,{type:"monotone",dataKey:"Protein",stroke:"#a78bfa",strokeWidth:2,dot:!0},"protein"),e.jsx(je,{type:"monotone",dataKey:"Carbs",stroke:"#2dd4bf",strokeWidth:2,dot:!0},"carbs"),e.jsx(je,{type:"monotone",dataKey:"Fat",stroke:"#fbbf24",strokeWidth:2,dot:!0},"fat")]})})}),e.jsx("div",{className:"mt-4 text-sm text-neutral-600 text-center",children:(()=>{let n=0,d=0,u=0;for(const h of r){const j=a.macrosByDay?.[h]||{protein:0,carbs:0,fat:0};n+=j.protein,d+=j.carbs,u+=j.fat}const p=n+d+u,o=h=>p>0?Math.round(h/p*100):0;return e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"mr-4",children:["Protein: ",e.jsxs("span",{className:"text-amber-600 font-semibold",children:[n,"g"]})," (",o(n),"%)"]}),e.jsxs("span",{className:"mr-4",children:["Carbs: ",e.jsxs("span",{className:"text-teal-600 font-semibold",children:[d,"g"]})," (",o(d),"%)"]}),e.jsxs("span",{children:["Fat: ",e.jsxs("span",{className:"text-yellow-600 font-semibold",children:[u,"g"]})," (",o(u),"%)"]})]})})()})]}),e.jsxs(g,{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"AI-Powered Insights"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Nutrition Optimization"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Your protein intake shows good consistency. Consider increasing healthy fats for better satiety."})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-900 mb-2",children:"Calorie Management"}),e.jsx("p",{className:"text-sm text-green-700",children:"You're maintaining excellent calorie control. Your weekly average is within optimal range."})]}),e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-purple-900 mb-2",children:"Progress Prediction"}),e.jsx("p",{className:"text-sm text-purple-700",children:"Based on current trends, you're on track to achieve your goals within the next 4 weeks."})]})]})]})]})]}),e.jsx("div",{className:"bg-gray-50 py-16",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"Choose Your Plan"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Select the perfect plan for your health journey"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 max-w-5xl mx-auto",children:l.map((n,d)=>e.jsxs(g,{className:`relative ${n.popular?"ring-2 ring-blue-600 scale-105":""}`,children:[n.popular&&e.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2",children:e.jsx(P,{className:"bg-blue-600 text-white px-4 py-1",children:"Most Popular"})}),e.jsxs(b,{className:"text-center",children:[e.jsx(w,{className:"text-2xl",children:n.name}),e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"text-4xl font-bold",children:n.price}),e.jsxs("span",{className:"text-gray-600",children:["/",n.period]})]})]}),e.jsxs(y,{children:[e.jsx("ul",{className:"space-y-3 mb-8",children:n.features.map((u,p)=>e.jsxs("li",{className:"flex items-center",children:[e.jsx(fe,{className:"h-5 w-5 text-green-500 mr-3"}),e.jsx("span",{children:u})]},p))}),e.jsx(v,{className:`w-full ${n.popular?"bg-blue-600 hover:bg-blue-700":"bg-gray-200 hover:bg-gray-300"}`,size:"lg",children:n.popular?"Get Started":"Choose Plan"})]})]},d))}),e.jsxs("div",{className:"text-center mt-12",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Not sure which plan is right for you?"}),e.jsx(v,{variant:"outline",size:"lg",children:"Contact Sales"})]})]})}),e.jsx("div",{className:"bg-white py-16",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"What Our Users Say"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Join thousands of satisfied users who have transformed their health"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[{name:"Sarah Johnson",role:"Fitness Enthusiast",content:"The AI insights have completely changed how I approach my health. My weight loss goals are finally within reach!",rating:5},{name:"Michael Chen",role:"Health Professional",content:"As a doctor, I appreciate the accuracy and depth of the analytics. It helps me provide better care for my patients.",rating:5},{name:"Emily Rodriguez",role:"Wellness Coach",content:"The real-time monitoring and professional reports have elevated my coaching practice to a whole new level.",rating:5}].map((n,d)=>e.jsx(g,{children:e.jsxs(y,{className:"p-6",children:[e.jsx("div",{className:"flex mb-4",children:[...Array(n.rating)].map((u,p)=>e.jsx(Ks,{className:"h-5 w-5 text-yellow-400 fill-current"},p))}),e.jsxs("p",{className:"text-gray-600 mb-4 italic",children:['"',n.content,'"']}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.name}),e.jsx("p",{className:"text-sm text-gray-500",children:n.role})]})]})]})},d))})]})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 py-16",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center px-4 sm:px-6 lg:px-8",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-4",children:"Ready to Transform Your Health Journey?"}),e.jsx("p",{className:"text-xl text-blue-100 mb-8",children:"Join thousands of users who have achieved their health goals with Premium Analytics"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsx(v,{size:"lg",variant:"secondary",className:"bg-white text-blue-600 hover:bg-gray-100 px-8 py-3 text-lg",onClick:()=>t(!0),children:"Start Free Trial"}),e.jsx(v,{size:"lg",variant:"outline",className:"border-white hover:bg-white hover:text-blue-600 px-8 py-3 text-lg",children:"Learn More"})]}),e.jsx("p",{className:"text-blue-100 mt-4 text-sm",children:"14-day free trial • No credit card required • Cancel anytime"})]})})]}),e.jsx(qe,{})]})}function Be({path:s,component:t}){const{user:a,isLoading:r}=Le();return e.jsx(We,{path:s,children:()=>r?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(Ue,{className:"h-8 w-8 animate-spin text-primary"})}):a?e.jsx(t,{}):e.jsx(aa,{to:"/login"})})}class Cr extends x.Component{constructor(t){super(t),this.handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null})},this.handleGoHome=()=>{window.location.href="/"},this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t,errorInfo:null}}componentDidCatch(t,a){console.error("Error caught by boundary:",t,a),this.props.onError&&this.props.onError(t,a),this.setState({error:t,errorInfo:a})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gray-50",children:e.jsxs(g,{className:"w-full max-w-md",children:[e.jsxs(b,{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(rs,{className:"w-6 h-6 text-red-600"})}),e.jsx(w,{className:"text-xl font-semibold text-gray-900",children:"Something went wrong"}),e.jsx(ds,{className:"text-gray-600",children:"We encountered an unexpected error. Please try again or go back to the homepage."})]}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[this.state.error?.message&&e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Error:"})," ",this.state.error.message]}),!1]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{onClick:this.handleRetry,className:"flex-1",variant:"outline",children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),"Try Again"]}),e.jsxs(v,{onClick:this.handleGoHome,className:"flex-1",children:[e.jsx(Ia,{className:"w-4 h-4 mr-2"}),"Go Home"]})]})]})]})}):this.props.children}}function Kc({children:s}){const[t,a]=ma.useState(null);return ma.useEffect(()=>{const r=l=>{a(new Error(l.error?.message||"An unexpected error occurred"))},i=l=>{a(new Error(l.reason?.message||"An unexpected error occurred"))};return window.addEventListener("error",r),window.addEventListener("unhandledrejection",i),()=>{window.removeEventListener("error",r),window.removeEventListener("unhandledrejection",i)}},[]),t?e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Async Error"}),e.jsx("p",{className:"text-red-600",children:t.message}),e.jsx("button",{onClick:()=>a(null),className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Dismiss"})]}):e.jsx(e.Fragment,{children:s})}Cr.AsyncErrorBoundary=Kc;const Wc=()=>{const[,s]=gt();return s("/login"),null};function Gc(){return e.jsxs(Hi,{children:[e.jsx(We,{path:"/",component:jl}),e.jsx(We,{path:"/try-it",component:pl}),e.jsx(We,{path:"/pricing",component:fl}),e.jsx(Be,{path:"/dashboard",component:ll}),e.jsx(Be,{path:"/history",component:ul}),e.jsx(We,{path:"/auth",component:Wc}),e.jsx(We,{path:"/login",component:hl}),e.jsx(We,{path:"/about",component:gl}),e.jsx(We,{path:"/contact",component:Nl}),e.jsx(We,{path:"/terms",component:vl}),e.jsx(We,{path:"/privacy",component:bl}),e.jsx(Be,{path:"/meal-plan",component:_l}),e.jsx(Be,{path:"/meal-calendar",component:ql}),e.jsx(Be,{path:"/recipe-import",component:Bl}),e.jsx(Be,{path:"/onboarding",component:oc}),e.jsx(Be,{path:"/admin",component:Ic}),e.jsx(Be,{path:"/chatbot",component:Mc}),e.jsx(Be,{path:"/achievements",component:Lc}),e.jsx(Be,{path:"/nutrition-education",component:Oc}),e.jsx(Be,{path:"/profile",component:$c}),e.jsx(Be,{path:"/premium-analytics",component:Hc}),e.jsx(We,{component:mn})]})}function Yc(){return e.jsx(Cr,{children:e.jsx(Vi,{attribute:"class",defaultTheme:"light",children:e.jsx(on,{children:e.jsx(Gc,{})})})})}ln.use(cn).use(_i).init({lng:"en",fallbackLng:"en",supportedLngs:["en","ar","es","pt","fr"],backend:{loadPath:"/locales/{{lng}}/{{ns}}.json"},interpolation:{escapeValue:!1}});function Jc(){const{toasts:s}=ve();return e.jsxs(Dn,{children:[s.map(function({id:t,title:a,description:r,action:i,...l}){return e.jsxs(ar,{...l,children:[e.jsxs("div",{className:"grid gap-1",children:[a&&e.jsx(ir,{children:a}),r&&e.jsx(nr,{children:r})]}),i,e.jsx(rr,{})]},t)}),e.jsx(tr,{})]})}qi.createRoot(document.getElementById("root")).render(e.jsx(Bi,{client:sr,children:e.jsx(Vn,{children:e.jsxs(Wn,{children:[e.jsx(Yc,{}),e.jsx(Jc,{})]})})}));
